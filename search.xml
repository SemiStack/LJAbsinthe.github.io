<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[æ·±å…¥äº†è§£ä»£ç å—Blockï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2018%2F09%2F20%2F%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3%E4%BB%A3%E7%A0%81%E5%9D%97Block%EF%BC%88%E4%B8%80%EF%BC%89%2F</url>
    <content type="text"><![CDATA[åŸºç¡€å›žé¡¾Blockå°±æ˜¯ä¸€ä¸ªå‡½æ•°ä½“ï¼ˆåŒ¿åå‡½æ•°ï¼‰ï¼Œå®ƒæ˜¯ObjCå¯¹äºŽé—­åŒ…çš„å®žçŽ°ï¼Œåœ¨å—çŠ¶ä¸­æˆ‘ä»¬å¯ä»¥æŒæœ‰æˆ–å¼•ç”¨å±€éƒ¨å˜é‡ï¼ˆä¸ç¦æƒ³åˆ°äº†lambdaè¡¨è¾¾å¼ï¼‰ï¼ŒåŒæ—¶åˆ©ç”¨Blockä½ å¯ä»¥å°†ä¸€ä¸ªæ“ä½œä½œä¸ºä¸€ä¸ªå‚æ•°è¿›è¡Œä¼ é€’,ç±»ä¼¼äºŽCè¯­è¨€ä¸­çš„å‡½æ•°æŒ‡é’ˆã€‚ Blockç±»åž‹å®šä¹‰ï¼šè¿”å›žå€¼ç±»åž‹(^ å˜é‡å)(å‚æ•°åˆ—è¡¨)ï¼ˆæ³¨æ„Blockä¹Ÿæ˜¯ä¸€ç§ç±»åž‹ï¼‰ï¼› Blockçš„typedefå®šä¹‰ï¼šè¿”å›žå€¼ç±»åž‹(^ç±»åž‹åç§°)(å‚æ•°åˆ—è¡¨)ï¼› Blockçš„å®žçŽ°ï¼š^(å‚æ•°åˆ—è¡¨){æ“ä½œä¸»ä½“}ï¼› Blockåº•å±‚æ•°æ®ç»“æž„é¦–å…ˆä»Žä¸€ä¸ªç®€å•Blockè¯´èµ·ï¼š12345678910int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; int age = 10; void(^block)() = ^&#123; NSLog(@"this is block,age = %d",age); &#125;; block(); &#125; return 0;&#125; ä½¿ç”¨å‘½ä»¤è¡Œå°†ä»£ç è½¬åŒ–ä¸ºc++æŸ¥çœ‹å…¶å†…éƒ¨ç»“æž„ï¼Œä¸ŽOCä»£ç è¿›è¡Œæ¯”è¾ƒ 1xcrun -sdk iphoneos clang -arch arm64 -rewrite-objc main.m 123456789int main(int argc, const char * argv[]) &#123; /* @autoreleasepool */ &#123; __AtAutoreleasePool __autoreleasepool; int age = 10; void(*block)(void) = ((void (*)())&amp;__main_block_impl_0((void *)__main_block_func_0, &amp;__main_block_desc_0_DATA, age)); ((void (*)(__block_impl *))((__block_impl *)block)-&gt;FuncPtr)((__block_impl *)block); &#125; return 0;&#125; ä¸Šè¿°å®šä¹‰ä»£ç ä¸­ï¼Œå¯ä»¥å‘çŽ°ï¼Œblockå®šä¹‰ä¸­è°ƒç”¨äº†main_block_impl_0å‡½æ•°ï¼Œå¹¶ä¸”å°†main_block_impl_0å‡½æ•°çš„åœ°å€èµ‹å€¼ç»™äº†blockã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹__main_block_impl_0å‡½æ•°å†…éƒ¨ç»“æž„ã€‚ __main_block_impl_01234567891011struct __main_block_impl_0 &#123; struct __block_impl impl; struct __main_block_desc_0* Desc; int age; __main_block_impl_0(void *fp, struct __main_block_desc_0 *desc, int _age, int flags=0) : age(_age) &#123; impl.isa = &amp;_NSConcreteStackBlock; impl.Flags = flags; impl.FuncPtr = fp; Desc = desc; &#125;&#125;; main_block_imp_0ç»“æž„ä½“å†…æœ‰ä¸€ä¸ªåŒåæž„é€ å‡½æ•°main_block_imp_0ï¼Œæž„é€ å‡½æ•°ä¸­å¯¹ä¸€äº›å˜é‡è¿›è¡Œäº†èµ‹å€¼æœ€ç»ˆä¼šè¿”å›žä¸€ä¸ªç»“æž„ä½“ã€‚æœ€ç»ˆå°†ä¸€ä¸ª__main_block_imp_0ç»“æž„ä½“çš„åœ°å€èµ‹å€¼ç»™äº†blockå˜é‡ã€‚ main_block_impl_0ç»“æž„ä½“å†…å¯ä»¥å‘çŽ°main_block_impl_0æž„é€ å‡½æ•°ä¸­ä¼ å…¥äº†å››ä¸ªå‚æ•°ã€‚å…¶ä¸­flagsæœ‰é»˜è®¤å€¼ï¼Œä¹Ÿå°±è¯´flagså‚æ•°åœ¨è°ƒç”¨çš„æ—¶å€™å¯ä»¥çœç•¥ä¸ä¼ ã€‚è€Œæœ€åŽçš„ age(_age)åˆ™è¡¨ç¤ºä¼ å…¥çš„_ageå‚æ•°ä¼šè‡ªåŠ¨èµ‹å€¼ç»™ageæˆå‘˜ï¼Œç›¸å½“äºŽage = _ageã€‚ æŽ¥ä¸‹æ¥è·³åˆ°(void *)__main_block_func_0å‡½æ•°çš„å®žçŽ°éƒ¨åˆ† __main_block_func_01234static void __main_block_func_0(struct __main_block_impl_0 *__cself) &#123; int age = __cself-&gt;age; // bound by copy NSLog((NSString *)&amp;__NSConstantStringImpl__var_folders_m7_y_gtxjyx6mdckhrjrhn50plm0000gn_T_main_41049f_mi_1,age); &#125; åœ¨main_block_func_0å‡½æ•°ä¸­é¦–å…ˆå–å‡ºblockä¸­ageçš„å€¼ï¼Œç´§æŽ¥ç€å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªç†Ÿæ‚‰çš„NSLogï¼Œå¯ä»¥å‘çŽ°è¿™ä¸¤æ®µä»£ç æ°æ°æ˜¯æˆ‘ä»¬åœ¨blockå—ä¸­å†™ä¸‹çš„ä»£ç ã€‚ é‚£ä¹ˆmain_block_func_0å‡½æ•°ä¸­å…¶å®žå­˜å‚¨ç€æˆ‘ä»¬blockä¸­å†™ä¸‹çš„ä»£ç ã€‚è€Œmain_block_impl_0å‡½æ•°ä¸­ä¼ å…¥çš„æ˜¯(void *)main_block_func_0ï¼Œä¹Ÿå°±è¯´å°†æˆ‘ä»¬å†™åœ¨blockå—ä¸­çš„ä»£ç å°è£…æˆmain_block_func_0å‡½æ•°ï¼Œå¹¶å°†main_block_func_0å‡½æ•°çš„åœ°å€ä¼ å…¥äº†__main_block_impl_0çš„æž„é€ å‡½æ•°ä¸­ä¿å­˜åœ¨ç»“æž„ä½“å†…ã€‚ ç»§ç»­è·³è½¬å‡½æ•°__main_block_desc_0_DATA,è§‚å¯Ÿå…¶å†…éƒ¨å®žçŽ° __main_block_desc_01234static struct __main_block_desc_0 &#123; size_t reserved; size_t Block_size;&#125; __main_block_desc_0_DATA = &#123; 0, sizeof(struct __main_block_impl_0)&#125;; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°main_block_desc_0ä¸­å­˜å‚¨ç€ä¸¤ä¸ªå‚æ•°ï¼Œreservedå’ŒBlock_sizeï¼Œå¹¶ä¸”reservedèµ‹å€¼ä¸º0è€ŒBlock_sizeåˆ™å­˜å‚¨ç€main_block_impl_0çš„å ç”¨ç©ºé—´å¤§å°ã€‚æœ€ç»ˆå°†main_block_desc_0ç»“æž„ä½“çš„åœ°å€ä¼ å…¥main_block_func_0ä¸­èµ‹å€¼ç»™Descã€‚ __block_implæ­¤æ—¶å›žè¿‡å¤´æ¥æŸ¥çœ‹__main_block_impl_0ç»“æž„ä½“ã€‚ç¬¬ä¸€ä¸ªå˜é‡å°±æ˜¯__block_implç»“æž„ä½“,__block_implå†…éƒ¨ç»“æž„å¦‚ä¸‹ï¼š 123456struct __block_impl &#123; void *isa; int Flags; int Reserved; void *FuncPtr;&#125; æˆ‘ä»¬å¯ä»¥å‘çŽ°__block_implç»“æž„ä½“å†…éƒ¨å°±æœ‰ä¸€ä¸ªisaæŒ‡é’ˆã€‚å› æ­¤å¯ä»¥è¯æ˜Žblockæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªocå¯¹è±¡ã€‚è€Œåœ¨æž„é€ å‡½æ•°ä¸­å‡½æ•°ä¼ å…¥çš„å€¼åˆ†åˆ«å­˜å‚¨åœ¨main_block_impl_0ç»“æž„ä½“å®žä¾‹ä¸­ï¼Œæœ€ç»ˆå°†ç»“æž„ä½“çš„åœ°å€èµ‹å€¼ç»™blockã€‚ é€šè¿‡ä¸Šé¢å¯¹__main_block_impl_0ç»“æž„ä½“æž„é€ å‡½æ•°ä¸‰ä¸ªå‚æ•°çš„åˆ†æžæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š __block_implç»“æž„ä½“ä¸­isaæŒ‡é’ˆå­˜å‚¨ç€&amp;_NSConcreteStackBlockåœ°å€ï¼Œå¯ä»¥æš‚æ—¶ç†è§£ä¸ºå…¶ç±»å¯¹è±¡åœ°å€ï¼Œblockå°±æ˜¯_NSConcreteStackBlockç±»åž‹çš„ã€‚ blockä»£ç å—ä¸­çš„ä»£ç è¢«å°è£…æˆmain_block_func_0å‡½æ•°ï¼ŒFuncPtråˆ™å­˜å‚¨ç€main_block_func_0å‡½æ•°çš„åœ°å€ã€‚ DescæŒ‡å‘main_block_desc_0ç»“æž„ä½“å¯¹è±¡ï¼Œå…¶ä¸­å­˜å‚¨main_block_impl_0ç»“æž„ä½“æ‰€å ç”¨çš„å†…å­˜ã€‚ ä»¥ä¸‹ç®€å•ç”¨ä¸€å¼ å›¾è¡¨ç¤ºå„ä¸ªæˆå‘˜ä¹‹é—´çš„å…³ç³» å˜é‡æ•èŽ·ä¸ºäº†ä¿è¯blockå†…éƒ¨èƒ½å¤Ÿæ­£å¸¸è®¿é—®å¤–éƒ¨çš„å˜é‡ï¼Œblockæœ‰ä¸ªå˜é‡æ•èŽ·æœºåˆ¶ ä¸‹é¢é€šè¿‡ç¤ºä¾‹ç¨‹åºä¸€ä¸€äº†è§£ä¸Šé¢è¿™å¼ è¡¨ã€‚ å±€éƒ¨å˜é‡autoï¼ˆè‡ªåŠ¨ï¼‰å˜é‡è¿˜æ˜¯ä»¥ä¸Šé¢çš„ä»£ç ä¸ºä¾‹ï¼Œé€šè¿‡OCè½¬C++çš„ä»£ç æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨struct __main_block_impl_0ç»“æž„ä½“ä¸­ï¼Œæœ‰ä¸€ä¸ªageå˜é‡ï¼Œæ ¹æ®Cè¯­è¨€åŸºç¡€æˆ‘ä»¬çŸ¥é“ï¼Œå˜é‡å¦‚æžœæ²¡æœ‰åŠ ä¿®é¥°ç¬¦é»˜è®¤ä¸ºautoï¼ˆè‡ªåŠ¨ï¼‰å˜é‡ï¼Œè‡ªåŠ¨å˜é‡çš„ç‰¹ç‚¹æ˜¯ç¦»å¼€ä½œç”¨åŸŸå°±é”€æ¯ã€‚æ‰€ä»¥ä¸ºäº†blockèƒ½åœ¨é€‚å½“çš„æ—¶åˆ»è®¿é—®åˆ°è‡ªåŠ¨å˜é‡è€Œä¸è¢«ç³»ç»Ÿé”€æ¯ï¼Œå¿…é¡»è®©blockä¿å­˜ä¸€ä»½è‡ªåŠ¨å˜é‡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€æ•èŽ·â€ã€‚å½“ç„¶å…¶è®¿é—®æ–¹å¼ä¸ºå€¼ä¼ é€’ã€‚ staticï¼ˆé™æ€ï¼‰å˜é‡static ä¿®é¥°çš„å˜é‡ä¸ºæŒ‡é’ˆä¼ é€’ï¼ŒåŒæ ·ä¼šè¢«blockæ•èŽ·ã€‚ 123456789101112131415int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; auto int a = 10; static int b = 11; void(^block)(void) = ^&#123; NSLog(@"hello, a = %d, b = %d", a,b); &#125;; a = 1; b = 2; block(); &#125; return 0;&#125;// log : blockæœ¬è´¨[57465:18555229] hello, a = 10, b = 2// blockä¸­açš„å€¼æ²¡æœ‰è¢«æ”¹å˜è€Œbçš„å€¼éšå¤–éƒ¨å˜åŒ–è€Œå˜åŒ–ã€‚ ç”Ÿæˆçš„C++ä»£ç ï¼š ä»Žä¸Šè¿°æºç ä¸­å¯ä»¥çœ‹å‡ºï¼Œa,bä¸¤ä¸ªå˜é‡éƒ½æœ‰æ•èŽ·åˆ°blockå†…éƒ¨ã€‚ä½†æ˜¯aä¼ å…¥çš„æ˜¯å€¼ï¼Œè€Œbä¼ å…¥çš„åˆ™æ˜¯åœ°å€ã€‚ ä¸ºä»€ä¹ˆä¸¤ç§å˜é‡ä¼šæœ‰è¿™ç§å·®å¼‚å‘¢ï¼Œå› ä¸ºè‡ªåŠ¨å˜é‡å¯èƒ½ä¼šé”€æ¯ï¼Œblockåœ¨æ‰§è¡Œçš„æ—¶å€™æœ‰å¯èƒ½è‡ªåŠ¨å˜é‡å·²ç»è¢«é”€æ¯äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶å¦‚æžœå†åŽ»è®¿é—®è¢«é”€æ¯çš„åœ°å€è‚¯å®šä¼šå‘ç”Ÿåå†…å­˜è®¿é—®ï¼Œå› æ­¤å¯¹äºŽè‡ªåŠ¨å˜é‡ä¸€å®šæ˜¯å€¼ä¼ é€’è€Œä¸å¯èƒ½æ˜¯æŒ‡é’ˆä¼ é€’äº†ã€‚è€Œé™æ€å˜é‡ä¸ä¼šè¢«é”€æ¯ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ä¼ é€’åœ°å€ã€‚ å…¨å±€å˜é‡1234567891011121314int a = 10;static int b = 11;int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; void(^block)(void) = ^&#123; NSLog(@"hello, a = %d, b = %d", a,b); &#125;; a = 1; b = 2; block(); &#125; return 0;&#125;// log hello, a = 1, b = 2 ä¸Šé¢çš„ä»£ç ä¿®æ”¹äº†å…¨å±€å˜é‡aã€bçš„å€¼ï¼Œå‘çŽ°æ€»ä¼šä½œç”¨äºŽBlockå†…éƒ¨ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šæ•èŽ·å…¨å±€å˜é‡ã€‚ è¿™ä¸ªä¸éš¾ç†è§£ï¼Œå› ä¸ºå…¨å±€å˜é‡åœ¨æ•´ä¸ªç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­éšå¤„éƒ½å¯ä»¥è¿›è¡Œè®¿é—®ï¼Œå› æ­¤Blockå†…éƒ¨æ— éœ€å†åŽ»ä¿å­˜ä¸€ä»½ã€‚ åŒæ ·çš„æ–¹å¼æˆ‘ä»¬å¯ä»¥è½¬æˆC++ä»£ç ï¼Œå‘çŽ°å®žçŽ°å†…éƒ¨ç¡®å®žæ²¡æœ‰aå’Œbå˜é‡ã€‚å¾ˆç®€å•è¿™é‡Œä¸å†è´´ä»£ç ã€‚ Blockç±»åž‹é€šè¿‡å‰å‡ èŠ‚çš„ç ”ç©¶æˆ‘ä»¬å‘çŽ°ï¼ŒBlockçš„æœ¬è´¨å…¶å®žæ˜¯ä¸€ä¸ªå°è£…äº†å‡½æ•°è°ƒç”¨ä»¥åŠå‡½æ•°è°ƒç”¨çŽ¯å¢ƒçš„OCå¯¹è±¡ã€‚é‚£ä¹ˆï¼Œblockå¯¹è±¡å…·ä½“æ˜¯ä»€ä¹ˆç±»åž‹çš„å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬å°±é€šè¿‡ä»£ç æ¥çª¥æŽ¢ä¸€ä¸‹ã€‚ 12345678910111213141516171819int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; // __NSGlobalBlock__ : __NSGlobalBlock : NSBlock : NSObject void (^block)(void) = ^&#123; NSLog(@"Hello"); &#125;; NSLog(@"%@", [block class]); NSLog(@"%@", [[block class] superclass]); NSLog(@"%@", [[[block class] superclass] superclass]); NSLog(@"%@", [[[[block class] superclass] superclass] superclass]); &#125; return 0;&#125;logï¼š__NSGlobalBlock__ __NSGlobalBlock NSBlock NSObject ä»Žä¸Šè¿°æ‰“å°å†…å®¹å¯ä»¥çœ‹å‡ºblockæœ€ç»ˆéƒ½æ˜¯ç»§æ‰¿è‡ªNSBlockç±»åž‹ï¼Œè€ŒNSBlockç»§æ‰¿äºŽNSObjcetã€‚é‚£ä¹ˆblockå…¶ä¸­çš„isaæŒ‡é’ˆå…¶å®žæ˜¯æ¥è‡ªNSObjectä¸­çš„ã€‚è¿™ä¹Ÿæ›´åŠ å°è¯äº†blockçš„æœ¬è´¨å…¶å®žå°±æ˜¯OCå¯¹è±¡ã€‚ Blockçš„ä¸‰ç§ç±»åž‹123__NSGlobalBlock__ ï¼ˆ _NSConcreteGlobalBlock ï¼‰__NSStackBlock__ ï¼ˆ _NSConcreteStackBlock ï¼‰__NSMallocBlock__ ï¼ˆ _NSConcreteMallocBlock ï¼‰ é‚£ä¹ˆï¼Œä»€ä¹ˆæƒ…å†µä¸‹å¯¹åº”ä»¥ä¸Šå„ç§ä¸åŒç±»åž‹çš„blockå‘¢ï¼Ÿ 12345678910111213141516171819int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; // 1. å†…éƒ¨æ²¡æœ‰è®¿é—®autoå˜é‡çš„block void (^block1)(void) = ^&#123; NSLog(@"Hello"); &#125;; // 2. å†…éƒ¨è®¿é—®autoå˜é‡çš„block int a = 10; void (^block2)(void) = ^&#123; NSLog(@"Hello - %d",a); &#125;; // 3. ç›´æŽ¥è°ƒç”¨çš„blockçš„class NSLog(@"%@ %@ %@", [block1 class], [block2 class], [^&#123; NSLog(@"%d",a); &#125; class]); &#125; return 0;&#125;logï¼š__NSGlobalBlock__ï¼Œ__NSMalocBlock__ï¼Œ__NSStackBlock__ ä½†æ˜¯æˆ‘ä»¬ä¸Šé¢æåˆ°è¿‡ï¼Œä¸Šè¿°ä»£ç è½¬åŒ–ä¸ºc++ä»£ç æŸ¥çœ‹æºç æ—¶å´å‘çŽ°blockçš„ç±»åž‹ä¸Žæ‰“å°å‡ºæ¥çš„ç±»åž‹ä¸ä¸€æ ·ï¼Œc++æºç ä¸­ä¸‰ä¸ªblockçš„isaæŒ‡é’ˆå…¨éƒ¨éƒ½æŒ‡å‘_NSConcreteStackBlockç±»åž‹åœ°å€ã€‚ æˆ‘ä»¬å¯ä»¥çŒœæµ‹runtimeè¿è¡Œæ—¶è¿‡ç¨‹ä¸­ä¹Ÿè®¸å¯¹ç±»åž‹è¿›è¡Œäº†è½¬å˜ã€‚æœ€ç»ˆç±»åž‹å½“ç„¶ä»¥runtimeè¿è¡Œæ—¶ç±»åž‹ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰“å°å‡ºçš„ç±»åž‹ä¸ºå‡†ã€‚ å­˜å‚¨åŒºåŸŸ ä¸Šå›¾ä¸­å¯ä»¥å‘çŽ°ï¼Œæ ¹æ®blockçš„ç±»åž‹ä¸åŒï¼Œblockå­˜æ”¾åœ¨ä¸åŒçš„åŒºåŸŸä¸­ã€‚ æ•°æ®æ®µä¸­çš„__NSGlobalBlock__ç›´åˆ°ç¨‹åºç»“æŸæ‰ä¼šè¢«å›žæ”¶ï¼Œä¸è¿‡æˆ‘ä»¬å¾ˆå°‘ä½¿ç”¨åˆ°__NSGlobalBlock__ç±»åž‹çš„blockï¼Œå› ä¸ºè¿™æ ·ä½¿ç”¨blockå¹¶æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚ __NSStackBlock__ç±»åž‹çš„blockå­˜æ”¾åœ¨æ ˆä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æ ˆä¸­çš„å†…å­˜ç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ï¼Œä½œç”¨åŸŸæ‰§è¡Œå®Œæ¯•ä¹‹åŽå°±ä¼šè¢«ç«‹å³é‡Šæ”¾ï¼Œè€Œåœ¨ç›¸åŒçš„ä½œç”¨åŸŸä¸­å®šä¹‰blockå¹¶ä¸”è°ƒç”¨blockä¼¼ä¹Žä¹Ÿå¤šæ­¤ä¸€ä¸¾ã€‚ __NSMallocBlock__æ˜¯åœ¨å¹³æ—¶ç¼–ç è¿‡ç¨‹ä¸­æœ€å¸¸ä½¿ç”¨åˆ°çš„ã€‚å­˜æ”¾åœ¨å †ä¸­éœ€è¦æˆ‘ä»¬è‡ªå·±è¿›è¡Œå†…å­˜ç®¡ç†ã€‚ ä¸‹é¢è¿™å¼ è¡¨ç¤ºä¸åŒçŠ¶æ€ä¸‹blockå¯¹åº”çš„ç±»åž‹ï¼š blockç±»åž‹ çŽ¯å¢ƒ NSGlobalBlock æ²¡æœ‰è®¿é—®autoå˜é‡ NSStackBlock è®¿é—®äº†autoå˜é‡ NSMallocBlock NSStackBlockè°ƒç”¨äº†copy æ¯ä¸€ç§ç±»åž‹çš„blockè°ƒç”¨copyåŽçš„ç»“æžœå¦‚ä¸‹æ‰€ç¤º MRCçŽ¯å¢ƒä¸‹ç»å¸¸éœ€è¦ä½¿ç”¨copyæ¥ä¿å­˜blockï¼Œå°†æ ˆä¸Šçš„blockæ‹·è´åˆ°å †ä¸­ï¼Œå³ä½¿æ ˆä¸Šçš„blockè¢«é”€æ¯ï¼Œå †ä¸Šçš„blockä¹Ÿä¸ä¼šè¢«é”€æ¯ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±è°ƒç”¨releaseæ“ä½œæ¥é”€æ¯ã€‚ åœ¨ARCçŽ¯å¢ƒä¸‹ï¼Œåªè¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼Œæ ˆä¸Šçš„blockå°±ä¼šè°ƒç”¨copyå‡½æ•°åˆ°å †ä¸Šå˜æˆNSMallocBlock: blockä½œä¸ºå‡½æ•°è¿”å›žå€¼æ—¶ å°†blockèµ‹å€¼ç»™__strongæŒ‡é’ˆæ—¶ blockä½œä¸ºCocoa APIä¸­æ–¹æ³•åå«æœ‰usingBlockçš„æ–¹æ³•å‚æ•°æ—¶ blockä½œä¸ºGCD APIçš„æ–¹æ³•å‚æ•°æ—¶]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>Block</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ·±å…¥äº†è§£ä»£ç å—ï¼ˆäºŒï¼‰]]></title>
    <url>%2F2018%2F09%2F20%2F%E6%B7%B1%E5%85%A5%E4%BA%86%E8%A7%A3%E4%BB%A3%E7%A0%81%E5%9D%97Block%EF%BC%88%E4%BA%8C%EF%BC%89%2F</url>
    <content type="text"><![CDATA[å¯¹è±¡ç±»åž‹çš„autoå˜é‡blockä¸€èˆ¬ä½¿ç”¨è¿‡ç¨‹ä¸­éƒ½æ˜¯å¯¹å¯¹è±¡å˜é‡çš„æ•èŽ·ï¼Œé‚£ä¹ˆå¯¹è±¡å˜é‡çš„æ•èŽ·åŒåŸºæœ¬æ•°æ®ç±»åž‹æ˜¯å¦ä¸€æ ·å‘¢ï¼Ÿ 123456789101112131415typedef void (^Block)(void);int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; Block block; &#123; Person *person = [[Person alloc] init]; person.age = 10; block = ^&#123; NSLog(@"------blockå†…éƒ¨%d",person.age); &#125;; &#125; // æ‰§è¡Œå®Œæ¯•ï¼Œpersonæ²¡æœ‰è¢«é‡Šæ”¾ NSLog(@"--------"); &#125; // person é‡Šæ”¾ return 0; &#125; å¤§æ‹¬å·æ‰§è¡Œå®Œæ¯•ä¹‹åŽï¼Œpersonä¾ç„¶ä¸ä¼šè¢«é‡Šæ”¾ã€‚blockæœ‰ä¸€ä¸ªå¼ºå¼•ç”¨å¼•ç”¨ç€personï¼Œæ‰€ä»¥blockä¸è¢«é”€æ¯çš„è¯ï¼Œperosonä¹Ÿä¸ä¼šé”€æ¯ã€‚C++æºç : å°†ä¸Šè¿°ä»£ç è½¬ç§»åˆ°MRCçŽ¯å¢ƒä¸‹ï¼Œåœ¨MRCçŽ¯å¢ƒä¸‹å³ä½¿blockè¿˜åœ¨ï¼Œpersonå´è¢«é‡Šæ”¾æŽ‰äº†ã€‚å› ä¸ºMRCçŽ¯å¢ƒä¸‹blockåœ¨æ ˆç©ºé—´ï¼Œæ ˆç©ºé—´å¯¹å¤–é¢çš„personä¸ä¼šè¿›è¡Œå¼ºå¼•ç”¨ã€‚ __weakå¯¹ä¸Šè¿°ä»£ç ä¸­personå¯¹è±¡æ·»åŠ ä¿®é¥°ç¬¦__weak: 123456789101112131415161718typedef void (^Block)(void);int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; Block block; &#123; Person *person = [[Person alloc] init]; person.age = 10; __weak Person *waekPerson = person; block = ^&#123; NSLog(@"------blockå†…éƒ¨%d",waekPerson.age); &#125;; &#125; NSLog(@"--------"); &#125; return 0;&#125; ä¸Šé¢çš„è¿™æ®µä»£ç personå¯¹è±¡å‡ºäº†å¤§æ‹¬å·å°±è¢«é‡Šæ”¾ã€‚è¯´æ˜Žæ²¡æœ‰å¼ºå¼•ç”¨æŒ‡å‘personå¯¹è±¡ã€‚ å°†ä»£ç è½¬åŒ–ä¸ºc++æ¥çœ‹ä¸€ä¸‹ä¸Šè¿°ä»£ç ä¹‹é—´çš„å·®åˆ«ã€‚ __weakä¿®é¥°å˜é‡ï¼Œéœ€è¦å‘ŠçŸ¥ç¼–è¯‘å™¨ä½¿ç”¨ARCçŽ¯å¢ƒåŠç‰ˆæœ¬å·å¦åˆ™ä¼šæŠ¥é”™ï¼Œæ·»åŠ è¯´æ˜Ž-fobjc-arc -fobjc-runtime=ios-8.0.0 1xcrun -sdk iphoneos clang -arch arm64 -rewrite-objc -fobjc-arc -fobjc-runtime=ios-8.0.0 main.m weakä¿®é¥°çš„å˜é‡ï¼Œåœ¨ç”Ÿæˆçš„main_block_impl_0ä¸­ä¹Ÿæ˜¯ä½¿ç”¨weakä¿®é¥°ã€‚ main_block_copy_0 å’Œ main_block_dispose_0å½“blockä¸­æ•èŽ·å¯¹è±¡ç±»åž‹çš„å˜é‡æ—¶ï¼Œæˆ‘ä»¬å‘çŽ°blockç»“æž„ä½“__main_block_impl_0çš„æè¿°ç»“æž„ä½“__main_block_desc_0ä¸­å¤šäº†ä¸¤ä¸ªå‚æ•°copyå’Œdisposeå‡½æ•°ï¼ŒæŸ¥çœ‹æºç ï¼š copyå’Œdisposeå‡½æ•°ä¸­ä¼ å…¥çš„éƒ½æ˜¯__main_block_impl_0ç»“æž„ä½“æœ¬èº«ã€‚ copyæœ¬è´¨å°±æ˜¯__main_block_copy_0å‡½æ•°ï¼Œ__main_block_copy_0å‡½æ•°å†…éƒ¨è°ƒç”¨_Block_object_assignå‡½æ•°ï¼Œ_Block_object_assignä¸­ä¼ å…¥çš„æ˜¯personå¯¹è±¡çš„åœ°å€ï¼Œpersonå¯¹è±¡ï¼Œä»¥åŠ8ã€‚ disposeæœ¬è´¨å°±æ˜¯__main_block_dispose_0å‡½æ•°ï¼Œ__main_block_dispose_0å‡½æ•°å†…éƒ¨è°ƒç”¨_Block_object_disposeå‡½æ•°ï¼Œ_Block_object_disposeå‡½æ•°ä¼ å…¥çš„å‚æ•°æ˜¯personå¯¹è±¡ï¼Œä»¥åŠ8ã€‚ _Block_object_assignå’Œ _Block_object_disposeå½“blockè¿›è¡Œcopyæ“ä½œçš„æ—¶å€™å°±ä¼šè‡ªåŠ¨è°ƒç”¨__main_block_desc_0å†…éƒ¨çš„__main_block_copy_0å‡½æ•°ï¼Œ__main_block_copy_0å‡½æ•°å†…éƒ¨ä¼šè°ƒç”¨_Block_object_assignå‡½æ•°ã€‚ _Block_object_assignå‡½æ•°ä¼šè‡ªåŠ¨æ ¹æ®__main_block_impl_0ç»“æž„ä½“å†…éƒ¨çš„personæ˜¯ä»€ä¹ˆç±»åž‹çš„æŒ‡é’ˆï¼Œå¯¹personå¯¹è±¡äº§ç”Ÿå¼ºå¼•ç”¨æˆ–è€…å¼±å¼•ç”¨ã€‚å¯ä»¥ç†è§£ä¸º_Block_object_assignå‡½æ•°å†…éƒ¨ä¼šå¯¹personè¿›è¡Œå¼•ç”¨è®¡æ•°å™¨çš„æ“ä½œï¼Œå¦‚æžœ__main_block_impl_0ç»“æž„ä½“å†…personæŒ‡é’ˆæ˜¯__strongç±»åž‹ï¼Œåˆ™ä¸ºå¼ºå¼•ç”¨ï¼Œå¼•ç”¨è®¡æ•°+1ï¼Œå¦‚æžœ__main_block_impl_0ç»“æž„ä½“å†…personæŒ‡é’ˆæ˜¯__weakç±»åž‹ï¼Œåˆ™ä¸ºå¼±å¼•ç”¨ï¼Œå¼•ç”¨è®¡æ•°ä¸å˜ã€‚ å½“blockä»Žå †ä¸­ç§»é™¤æ—¶å°±ä¼šè‡ªåŠ¨è°ƒç”¨__main_block_desc_0ä¸­çš„__main_block_dispose_0å‡½æ•°ï¼Œ__main_block_dispose_0å‡½æ•°å†…éƒ¨ä¼šè°ƒç”¨_Block_object_disposeå‡½æ•°ã€‚ _Block_object_disposeä¼šå¯¹personå¯¹è±¡åšé‡Šæ”¾æ“ä½œï¼Œç±»ä¼¼äºŽreleaseï¼Œä¹Ÿå°±æ˜¯æ–­å¼€å¯¹personå¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œpersonç©¶ç«Ÿæ˜¯å¦è¢«é‡Šæ”¾è¿˜æ˜¯å–å†³äºŽpersonå¯¹è±¡è‡ªå·±çš„å¼•ç”¨è®¡æ•°ã€‚ å°ç»“ ä¸€æ—¦blockä¸­æ•èŽ·çš„å˜é‡ä¸ºå¯¹è±¡ç±»åž‹ï¼Œblockç»“æž„ä½“ä¸­çš„__main_block_desc_0ä¼šå¤šå‡ºä¸¤ä¸ªå‚æ•°copyå’Œdisposeã€‚å› ä¸ºè®¿é—®çš„æ˜¯ä¸ªå¯¹è±¡ï¼Œblockå¸Œæœ›æ‹¥æœ‰è¿™ä¸ªå¯¹è±¡ï¼Œå°±éœ€è¦å¯¹å¯¹è±¡è¿›è¡Œå¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œå†…å­˜ç®¡ç†çš„æ“ä½œã€‚æ¯”å¦‚è¯´å¯¹å¯¹è±¡è¿›è¡Œretainæ“ä½œï¼Œå› æ­¤ä¸€æ—¦blockæ•èŽ·çš„å˜é‡æ˜¯å¯¹è±¡ç±»åž‹å°±ä¼šè‡ªåŠ¨ç”Ÿæˆcopyå’Œdisposeæ¥å¯¹å†…éƒ¨å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå†…å­˜ç®¡ç†ã€‚ å½“blockå†…éƒ¨è®¿é—®äº†å¯¹è±¡ç±»åž‹çš„autoå˜é‡æ—¶ï¼Œå¦‚æžœblockæ˜¯åœ¨æ ˆä¸Šï¼Œblockå†…éƒ¨ä¸ä¼šå¯¹personäº§ç”Ÿå¼ºå¼•ç”¨ã€‚ä¸è®ºblockç»“æž„ä½“å†…éƒ¨çš„å˜é‡æ˜¯__strongä¿®é¥°è¿˜æ˜¯__weakä¿®é¥°ï¼Œéƒ½ä¸ä¼šå¯¹å˜é‡äº§ç”Ÿå¼ºå¼•ç”¨ã€‚ å¦‚æžœblockè¢«æ‹·è´åˆ°å †ä¸Šã€‚copyå‡½æ•°ä¼šè°ƒç”¨_Block_object_assignå‡½æ•°ï¼Œæ ¹æ®autoå˜é‡çš„ä¿®é¥°ç¬¦ï¼ˆ__strongï¼Œ__weakï¼Œunsafe_unretainedï¼‰åšå‡ºç›¸åº”çš„æ“ä½œï¼Œå½¢æˆå¼ºå¼•ç”¨æˆ–è€…å¼±å¼•ç”¨ å¦‚æžœblockä»Žå †ä¸­ç§»é™¤ï¼Œdisposeå‡½æ•°ä¼šè°ƒç”¨_Block_object_disposeå‡½æ•°ï¼Œè‡ªåŠ¨é‡Šæ”¾å¼•ç”¨çš„autoå˜é‡ã€‚ å…³é”®å­—__blockå…ˆæ¥åˆ†æžä¸‹é¢è¿™éƒ¨åˆ†ä»£ç  1234567891011int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; int age = 10; Block block = ^ &#123; // age = 20; // æ— æ³•ä¿®æ”¹ NSLog(@"%d",age); &#125;; block(); &#125; return 0;&#125; å·²çŸ¥autoå˜é‡ageï¼Œå› ä¸ºblockçš„æ•èŽ·æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ageçš„å€¼ï¼Œä½†æ˜¯å¦‚æžœæˆ‘ä»¬åœ¨blockå†…éƒ¨ä¿®æ”¹ageåˆ™ç³»ç»Ÿä¼šæŠ¥é”™ã€‚ ageæ˜¯åœ¨mainå‡½æ•°å†…éƒ¨å£°æ˜Žçš„ï¼Œè¯´æ˜Žageçš„å†…å­˜å­˜åœ¨äºŽmainå‡½æ•°çš„æ ˆç©ºé—´å†…éƒ¨ï¼Œä½†æ˜¯blockå†…éƒ¨çš„ä»£ç åœ¨__main_block_func_0å‡½æ•°å†…éƒ¨ã€‚__main_block_func_0å‡½æ•°å†…éƒ¨æ— æ³•è®¿é—®ageå˜é‡çš„å†…å­˜ç©ºé—´ï¼Œä¸¤ä¸ªå‡½æ•°çš„æ ˆç©ºé—´ä¸ä¸€æ ·ï¼Œ__main_block_func_0å†…éƒ¨æ‹¿åˆ°çš„ageæ˜¯blockç»“æž„ä½“å†…éƒ¨çš„ageï¼Œå› æ­¤æ— æ³•åœ¨__main_block_func_0å‡½æ•°å†…éƒ¨åŽ»ä¿®æ”¹mainå‡½æ•°å†…éƒ¨çš„å˜é‡ã€‚ __blockblockç”¨äºŽè§£å†³blockå†…éƒ¨ä¸èƒ½ä¿®æ”¹autoå˜é‡å€¼çš„é—®é¢˜ï¼Œä½†æ˜¯blockä¸èƒ½ä¿®é¥°é™æ€å˜é‡ï¼ˆstaticï¼‰ å’Œå…¨å±€å˜é‡ 1__block int age = 10; ç¼–è¯‘å™¨ä¼šå°†__blockä¿®é¥°çš„å˜é‡åŒ…è£…æˆä¸€ä¸ªå¯¹è±¡ï¼ŒæŸ¥çœ‹å…¶åº•å±‚c++æºç : ä¸Šè¿°æºç ä¸­å¯ä»¥å‘çŽ°:è¢«blockä¿®é¥°çš„ageå˜é‡å£°æ˜Žå˜ä¸ºåä¸ºageçš„Block_byref_age_0ç»“æž„ä½“ Block_byref_age_0çš„å†…éƒ¨ç»„æˆéƒ¨åˆ†å¦‚ä¸‹ï¼š __isaæŒ‡é’ˆ ï¼š__Block_byref_age_0ä¸­ä¹Ÿæœ‰isaæŒ‡é’ˆä¹Ÿå°±æ˜¯è¯´__Block_byref_age_0æœ¬è´¨ä¹Ÿä¸€ä¸ªå¯¹è±¡ã€‚ __forwarding ï¼š__forwardingæ˜¯__Block_byref_age_0ç»“æž„ä½“ç±»åž‹çš„æŒ‡é’ˆï¼Œå¹¶ä¸”__forwardingå­˜å‚¨çš„å€¼ä¸º(__Block_byref_age_0 *)&amp;ageï¼Œå³ç»“æž„ä½“è‡ªå·±çš„å†…å­˜åœ°å€ã€‚ __flags ï¼š0 __size ï¼šsizeof(__Block_byref_age_0)å³__Block_byref_age_0æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚ age ï¼šçœŸæ­£å­˜å‚¨å˜é‡çš„åœ°æ–¹ï¼Œè¿™é‡Œå­˜å‚¨å±€éƒ¨å˜é‡10ã€‚ æŽ¥ç€å°†Block_byref_age_0ç»“æž„ä½“ageå­˜å…¥main_block_impl_0ç»“æž„ä½“ä¸­ï¼Œå¹¶èµ‹å€¼ç»™__Block_byref_age_0 \*age; ä¹‹åŽè°ƒç”¨blockï¼Œé¦–å…ˆå–å‡ºmain_block_impl_0ä¸­çš„ageï¼Œé€šè¿‡ageç»“æž„ä½“æ‹¿åˆ°forwardingæŒ‡é’ˆï¼Œforwardingä¸­ä¿å­˜çš„å°±æ˜¯Block_byref_age_0ç»“æž„ä½“æœ¬èº«ï¼Œåœ¨é€šè¿‡forwardingæ‹¿åˆ°ç»“æž„ä½“ä¸­çš„age(10)å˜é‡å¹¶ä¿®æ”¹å…¶å€¼ã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œblockä¸ºä»€ä¹ˆèƒ½ä¿®æ”¹å˜é‡çš„å€¼å·²ç»å¾ˆæ¸…æ™°äº†ã€‚blockå°†å˜é‡åŒ…è£…æˆå¯¹è±¡ï¼Œç„¶åŽå†æŠŠageå°è£…åœ¨ç»“æž„ä½“é‡Œé¢ï¼Œblockå†…éƒ¨å­˜å‚¨çš„å˜é‡ä¸ºç»“æž„ä½“æŒ‡é’ˆï¼Œä¹Ÿå°±å¯ä»¥é€šè¿‡æŒ‡é’ˆæ‰¾åˆ°å†…å­˜åœ°å€è¿›è€Œä¿®æ”¹å˜é‡çš„å€¼ã€‚ __blockä¿®é¥°å¯¹è±¡ç±»åž‹å¦‚æžœå˜é‡æœ¬èº«å°±æ˜¯å¯¹è±¡ç±»åž‹å‘¢ï¼Ÿ 123456789101112int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; __block Person *person = [[Person alloc] init]; NSLog(@"%@",person); Block block = ^&#123; person = [[Person alloc] init]; NSLog(@"%@",person); &#125;; block(); &#125; return 0;&#125; é€šè¿‡æºç æŸ¥çœ‹ï¼Œå°†å¯¹è±¡åŒ…è£…åœ¨ä¸€ä¸ªæ–°çš„ç»“æž„ä½“ä¸­ã€‚ç»“æž„ä½“å†…éƒ¨ä¼šæœ‰ä¸€ä¸ªpersonå¯¹è±¡ï¼Œä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯ç»“æž„ä½“å†…éƒ¨æ·»åŠ äº†å†…å­˜ç®¡ç†çš„ä¸¤ä¸ªå‡½æ•°__Block_byref_id_object_copyå’Œ__Block_byref_id_object_dispose Block_byref_id_object_copyå’ŒBlock_byref_id_object_disposeå‡½æ•°çš„è°ƒç”¨æ—¶æœºåŠä½œç”¨åœ¨__blockå†…å­˜ç®¡ç†éƒ¨åˆ†è¯¦ç»†åˆ†æžã€‚ é—®é¢˜æ‹“å±• Blockå†…ä¿®æ”¹å¯å˜æ•°ç»„é—®é¢˜ è¯·çœ‹ä»¥ä¸‹è¿™æ®µä»£ç ï¼Œæ€è€ƒæ˜¯å¦èƒ½å¦æ­£ç¡®æ‰§è¡ŒðŸ¤” 123456789101112int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; NSMutableArray *array = [NSMutableArray array]; Block block = ^&#123; [array addObject: @"5"]; [array addObject: @"5"]; NSLog(@"%@",array); &#125;; block(); &#125; return 0;&#125; å› ä¸ºåœ¨blockå—ä¸­ä»…ä»…æ˜¯ä½¿ç”¨äº†arrayçš„å†…å­˜åœ°å€ï¼Œå¾€æ•°ç»„ä¸­æ·»åŠ å†…å®¹ï¼Œå¹¶æ²¡æœ‰ä¿®æ”¹arryçš„å†…å­˜æŒ‡å‘ï¼Œå› æ­¤arrayä¸éœ€è¦ä½¿ç”¨__blockä¿®é¥°ä¹Ÿå¯ä»¥æ­£ç¡®ç¼–è¯‘ã€‚ å› æ­¤ï¼Œå½“ä¸æ˜¯ä¿®æ”¹æŒ‡é’ˆæŒ‡å‘çš„æ—¶å€™ï¼Œå°½é‡ä¸è¦æ·»åŠ `__block`ï¼Œé€šè¿‡ä¸Šè¿°åˆ†æžæˆ‘ä»¬çŸ¥é“ä¸€æ—¦æ·»åŠ äº†`__block`ä¿®é¥°ç¬¦ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºç›¸åº”çš„ç»“æž„ä½“ï¼Œå ç”¨ä¸å¿…è¦çš„å†…å­˜ç©ºé—´ã€‚ ä¸Šé¢æåˆ°è¿‡blockä¿®é¥°çš„ageå˜é‡åœ¨ç¼–è¯‘æ—¶ä¼šè¢«å°è£…ä¸ºç»“æž„ä½“ï¼Œé‚£ä¹ˆå½“åœ¨å¤–éƒ¨ä½¿ç”¨ageå˜é‡çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯Block_byref_age_0ç»“æž„ä½“å‘¢ï¼Ÿè¿˜æ˜¯__Block_byref_age_0ç»“æž„ä½“å†…çš„ageå˜é‡å‘¢ï¼Ÿ ä¸ºäº†éªŒè¯ä¸Šè¿°é—®é¢˜ï¼ŒåŒæ ·ä½¿ç”¨è‡ªå®šä¹‰ç»“æž„ä½“çš„æ–¹å¼æ¥æŸ¥çœ‹å…¶å†…éƒ¨ç»“æž„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142typedef void (^Block)(void);struct __block_impl &#123; void *isa; int Flags; int Reserved; void *FuncPtr;&#125;;struct __main_block_desc_0 &#123; size_t reserved; size_t Block_size; void (*copy)(void); void (*dispose)(void);&#125;;struct __Block_byref_age_0 &#123; void *__isa; struct __Block_byref_age_0 *__forwarding; int __flags; int __size; int age;&#125;;struct __main_block_impl_0 &#123; struct __block_impl impl; struct __main_block_desc_0* Desc; struct __Block_byref_age_0 *age; // by ref&#125;;int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; __block int age = 10; Block block = ^&#123; age = 20; NSLog(@"age is %d",age); &#125;; block(); struct __main_block_impl_0 *blockImpl = (__bridge struct __main_block_impl_0 *)block; NSLog(@"%p",&amp;age); &#125; return 0;&#125; é€šè¿‡æŸ¥çœ‹blockImplç»“æž„ä½“å…¶ä¸­çš„å†…å®¹ï¼Œæ‰¾åˆ°ageç»“æž„ä½“ï¼Œå…¶ä¸­é‡ç‚¹è§‚å¯Ÿä¸¤ä¸ªå…ƒç´ ï¼š __forwarding å…¶ä¸­å­˜å‚¨çš„åœ°å€ç¡®å®žæ˜¯ageç»“æž„ä½“å˜é‡è‡ªå·±çš„åœ°å€ ageä¸­å­˜å‚¨è¿™ä¿®æ”¹åŽçš„å˜é‡20ã€‚ ä¸Šé¢ä¹Ÿæåˆ°è¿‡ï¼Œåœ¨blockä¸­ä½¿ç”¨æˆ–ä¿®æ”¹ageçš„æ—¶å€™éƒ½æ˜¯é€šè¿‡ç»“æž„ä½“__Block_byref_age_0æ‰¾åˆ°__forwardingåœ¨æ‰¾åˆ°å˜é‡ageçš„ã€‚ å¦å¤–appleä¸ºäº†éšè—__Block_byref_age_0ç»“æž„ä½“çš„å®žçŽ°ï¼Œæ‰“å°ageå˜é‡çš„åœ°å€å‘çŽ°å…¶å®žæ˜¯__Block_byref_age_0ç»“æž„ä½“å†…ageå˜é‡çš„åœ°å€ã€‚ é€šè¿‡ä¸Šå›¾çš„è®¡ç®—å¯ä»¥å‘çŽ°æ‰“å°ageçš„åœ°å€åŒ__Block_byref_age_0ç»“æž„ä½“å†…ageå€¼çš„åœ°å€ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´å¤–é¢ä½¿ç”¨çš„ageï¼Œä»£è¡¨çš„å°±æ˜¯ç»“æž„ä½“å†…çš„ageå€¼ã€‚æ‰€ä»¥ç›´æŽ¥æ‹¿æ¥ç”¨çš„ageå°±æ˜¯ä¹‹å‰å£°æ˜Žçš„int ageã€‚ __blockå†…å­˜ç®¡ç†ä¸Šæ–‡æåˆ°å½“blockä¸­æ•èŽ·å¯¹è±¡ç±»åž‹çš„å˜é‡æ—¶ï¼Œblockä¸­çš„__main_block_desc_0ç»“æž„ä½“å†…éƒ¨ä¼šè‡ªåŠ¨æ·»åŠ copyå’Œdisposeå‡½æ•°å¯¹æ•èŽ·çš„å˜é‡è¿›è¡Œå†…å­˜ç®¡ç†ã€‚ é‚£ä¹ˆåŒæ ·çš„å½“blockå†…éƒ¨æ•èŽ·__blockä¿®é¥°çš„å¯¹è±¡ç±»åž‹çš„å˜é‡æ—¶ï¼Œ__Block_byref_person_0ç»“æž„ä½“å†…éƒ¨ä¹Ÿä¼šè‡ªåŠ¨æ·»åŠ __Block_byref_id_object_copyå’Œ__Block_byref_id_object_disposeå¯¹è¢«__blockåŒ…è£…æˆç»“æž„ä½“çš„å¯¹è±¡è¿›è¡Œå†…å­˜ç®¡ç†ã€‚ å½“blockå†…å­˜åœ¨æ ˆä¸Šæ—¶ï¼Œå¹¶ä¸ä¼šå¯¹__blockå˜é‡äº§ç”Ÿå¼•ç”¨ã€‚å½“blcokè¢«copyåˆ°å †ä¸Šæ—¶ ä¼šè°ƒç”¨blockå†…éƒ¨çš„copyå‡½æ•°ï¼Œcopyå‡½æ•°å†…éƒ¨ä¼šè°ƒç”¨_Block_object_assignå‡½æ•°ï¼Œ_Block_object_assignå‡½æ•°ä¼šå¯¹__blockå˜é‡å½¢æˆå¼ºå¼•ç”¨ï¼ˆç›¸å½“äºŽretainï¼‰ å½“blockè¢«copyåˆ°å †ä¸Šæ—¶ï¼Œblockå†…éƒ¨å¼•ç”¨çš„__blockå˜é‡ä¹Ÿä¼šè¢«å¤åˆ¶åˆ°å †ä¸Šï¼Œå¹¶ä¸”æŒæœ‰å˜é‡ï¼Œå¦‚æžœblockå¤åˆ¶åˆ°å †ä¸Šçš„åŒæ—¶ï¼Œ__blockå˜é‡å·²ç»å­˜åœ¨å †ä¸Šäº†ï¼Œåˆ™ä¸ä¼šå¤åˆ¶ã€‚ å½“blockä»Žå †ä¸­ç§»é™¤çš„è¯ï¼Œå°±ä¼šè°ƒç”¨disposeå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯__main_block_dispose_0å‡½æ•°ï¼Œ__main_block_dispose_0å‡½æ•°å†…éƒ¨ä¼šè°ƒç”¨_Block_object_disposeå‡½æ•°ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾å¼•ç”¨çš„__blockå˜é‡ã€‚ blockå†…éƒ¨å†³å®šä»€ä¹ˆæ—¶å€™å°†å˜é‡å¤åˆ¶åˆ°å †ä¸­ï¼Œä»€ä¹ˆæ—¶å€™å¯¹å˜é‡åšå¼•ç”¨è®¡æ•°çš„æ“ä½œã€‚ __blockä¿®é¥°çš„å˜é‡åœ¨blockç»“æž„ä½“ä¸­ä¸€ç›´éƒ½æ˜¯å¼ºå¼•ç”¨ï¼Œè€Œå…¶ä»–ç±»åž‹çš„æ˜¯ç”±ä¼ å…¥çš„å¯¹è±¡æŒ‡é’ˆç±»åž‹å†³å®šã€‚ 12345678910111213141516171819202122232425typedef void (^Block)(void);int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; int number = 20; __block int age = 10; NSObject *object = [[NSObject alloc] init]; __weak NSObject *weakObj = object; Person *p = [[Person alloc] init]; __block Person *person = p; __block __weak Person *weakPerson = p; Block block = ^ &#123; NSLog(@"%d",number); // å±€éƒ¨å˜é‡ NSLog(@"%d",age); // __blockä¿®é¥°çš„å±€éƒ¨å˜é‡ NSLog(@"%p",object); // å¯¹è±¡ç±»åž‹çš„å±€éƒ¨å˜é‡ NSLog(@"%p",weakObj); // __weakä¿®é¥°çš„å¯¹è±¡ç±»åž‹çš„å±€éƒ¨å˜é‡ NSLog(@"%p",person); // __blockä¿®é¥°çš„å¯¹è±¡ç±»åž‹çš„å±€éƒ¨å˜é‡ NSLog(@"%p",weakPerson); // __blockï¼Œ__weakä¿®é¥°çš„å¯¹è±¡ç±»åž‹çš„å±€éƒ¨å˜é‡ &#125;; block(); &#125; return 0;&#125; å°†ä¸Šè¿°ä»£ç è½¬åŒ–ä¸ºc++ä»£ç æŸ¥çœ‹ä¸åŒå˜é‡ä¹‹é—´çš„åŒºåˆ« 123456789101112131415161718struct __main_block_impl_0 &#123; struct __block_impl impl; struct __main_block_desc_0* Desc; int number; NSObject *__strong object; NSObject *__weak weakObj; __Block_byref_age_0 *age; // by ref __Block_byref_person_1 *person; // by ref __Block_byref_weakPerson_2 *weakPerson; // by ref __main_block_impl_0(void *fp, struct __main_block_desc_0 *desc, int _number, NSObject *__strong _object, NSObject *__weak _weakObj, __Block_byref_age_0 *_age, __Block_byref_person_1 *_person, __Block_byref_weakPerson_2 *_weakPerson, int flags=0) : number(_number), object(_object), weakObj(_weakObj), age(_age-&gt;__forwarding), person(_person-&gt;__forwarding), weakPerson(_weakPerson-&gt;__forwarding) &#123; impl.isa = &amp;_NSConcreteStackBlock; impl.Flags = flags; impl.FuncPtr = fp; Desc = desc; &#125;&#125;; ä¸Šè¿°__main_block_impl_0ç»“æž„ä½“ä¸­çœ‹å‡ºï¼Œæ²¡æœ‰ä½¿ç”¨__blockä¿®é¥°çš„å˜é‡ï¼ˆobject å’Œ weadObjï¼‰åˆ™æ ¹æ®ä»–ä»¬æœ¬èº«è¢«blockæ•èŽ·çš„æŒ‡é’ˆç±»åž‹å¯¹ä»–ä»¬è¿›è¡Œå¼ºå¼•ç”¨æˆ–å¼±å¼•ç”¨ï¼Œè€Œä¸€æ—¦ä½¿ç”¨__blockä¿®é¥°çš„å˜é‡ï¼Œ__main_block_impl_0ç»“æž„ä½“å†…ä¸€å¾‹ä½¿ç”¨å¼ºæŒ‡é’ˆå¼•ç”¨ç”Ÿæˆçš„ç»“æž„ä½“ã€‚ æŽ¥ç€æˆ‘ä»¬æ¥çœ‹__blockä¿®é¥°çš„å˜é‡ç”Ÿæˆçš„ç»“æž„ä½“æœ‰ä»€ä¹ˆä¸åŒ 123456789101112131415161718192021222324252627struct __Block_byref_age_0 &#123; void *__isa;__Block_byref_age_0 *__forwarding; int __flags; int __size; int age;&#125;;struct __Block_byref_person_1 &#123; void *__isa;__Block_byref_person_1 *__forwarding; int __flags; int __size; void (*__Block_byref_id_object_copy)(void*, void*); void (*__Block_byref_id_object_dispose)(void*); Person *__strong person;&#125;;struct __Block_byref_weakPerson_2 &#123; void *__isa;__Block_byref_weakPerson_2 *__forwarding; int __flags; int __size; void (*__Block_byref_id_object_copy)(void*, void*); void (*__Block_byref_id_object_dispose)(void*); Person *__weak weakPerson;&#125;; å¦‚ä¸Šé¢åˆ†æžçš„é‚£æ ·ï¼Œ__blockä¿®é¥°å¯¹è±¡ç±»åž‹çš„å˜é‡ç”Ÿæˆçš„ç»“æž„ä½“å†…éƒ¨å¤šäº†__Block_byref_id_object_copyå’Œ__Block_byref_id_object_disposeä¸¤ä¸ªå‡½æ•°ï¼Œç”¨æ¥å¯¹å¯¹è±¡ç±»åž‹çš„å˜é‡è¿›è¡Œå†…å­˜ç®¡ç†çš„æ“ä½œã€‚è€Œç»“æž„ä½“å¯¹å¯¹è±¡çš„å¼•ç”¨ç±»åž‹ï¼Œåˆ™å–å†³äºŽblockæ•èŽ·çš„å¯¹è±¡ç±»åž‹çš„å˜é‡ã€‚weakPersonæ˜¯å¼±æŒ‡é’ˆï¼Œæ‰€ä»¥__Block_byref_weakPerson_2å¯¹weakPersonå°±æ˜¯å¼±å¼•ç”¨ï¼Œpersonæ˜¯å¼ºæŒ‡é’ˆï¼Œæ‰€ä»¥__Block_byref_person_1å¯¹personå°±æ˜¯å¼ºå¼•ç”¨ã€‚ 1234567static void __main_block_copy_0(struct __main_block_impl_0*dst, struct __main_block_impl_0*src) &#123; _Block_object_assign((void*)&amp;dst-&gt;age, (void*)src-&gt;age, 8/*BLOCK_FIELD_IS_BYREF*/); _Block_object_assign((void*)&amp;dst-&gt;object, (void*)src-&gt;object, 3/*BLOCK_FIELD_IS_OBJECT*/); _Block_object_assign((void*)&amp;dst-&gt;weakObj, (void*)src-&gt;weakObj, 3/*BLOCK_FIELD_IS_OBJECT*/); _Block_object_assign((void*)&amp;dst-&gt;person, (void*)src-&gt;person, 8/*BLOCK_FIELD_IS_BYREF*/); _Block_object_assign((void*)&amp;dst-&gt;weakPerson, (void*)src-&gt;weakPerson, 8/*BLOCK_FIELD_IS_BYREF*/);&#125; __main_block_copy_0å‡½æ•°ä¸­ä¼šæ ¹æ®å˜é‡æ˜¯å¼ºå¼±æŒ‡é’ˆåŠæœ‰æ²¡æœ‰è¢«__blockä¿®é¥°åšå‡ºä¸åŒçš„å¤„ç†ï¼Œå¼ºæŒ‡é’ˆåœ¨blockå†…éƒ¨äº§ç”Ÿå¼ºå¼•ç”¨ï¼Œå¼±æŒ‡é’ˆåœ¨blockå†…éƒ¨äº§ç”Ÿå¼±å¼•ç”¨ã€‚è¢«__blockä¿®é¥°çš„å˜é‡æœ€åŽçš„å‚æ•°ä¼ å…¥çš„æ˜¯8ï¼Œæ²¡æœ‰è¢«__blockä¿®é¥°çš„å˜é‡æœ€åŽçš„å‚æ•°ä¼ å…¥çš„æ˜¯3ã€‚ å½“blockä»Žå †ä¸­ç§»é™¤æ—¶é€šè¿‡disposeå‡½æ•°æ¥é‡Šæ”¾ä»–ä»¬ã€‚ 1234567static void __main_block_dispose_0(struct __main_block_impl_0*src) &#123; _Block_object_dispose((void*)src-&gt;age, 8/*BLOCK_FIELD_IS_BYREF*/); _Block_object_dispose((void*)src-&gt;object, 3/*BLOCK_FIELD_IS_OBJECT*/); _Block_object_dispose((void*)src-&gt;weakObj, 3/*BLOCK_FIELD_IS_OBJECT*/); _Block_object_dispose((void*)src-&gt;person, 8/*BLOCK_FIELD_IS_BYREF*/); _Block_object_dispose((void*)src-&gt;weakPerson, 8/*BLOCK_FIELD_IS_BYREF*/);&#125; __forwardingæŒ‡é’ˆä¸Šé¢æåˆ°è¿‡__forwardingæŒ‡é’ˆæŒ‡å‘çš„æ˜¯ç»“æž„ä½“è‡ªå·±ã€‚å½“ä½¿ç”¨å˜é‡çš„æ—¶å€™ï¼Œé€šè¿‡ç»“æž„ä½“æ‰¾åˆ°__forwardingæŒ‡é’ˆï¼Œåœ¨é€šè¿‡__forwardingæŒ‡é’ˆæ‰¾åˆ°ç›¸åº”çš„å˜é‡ã€‚è¿™æ ·è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿å†…å­˜ç®¡ç†ã€‚é€šè¿‡ä¸Šé¢å¯¹__blockå˜é‡çš„å†…å­˜ç®¡ç†åˆ†æžæˆ‘ä»¬çŸ¥é“ï¼Œblockè¢«å¤åˆ¶åˆ°å †ä¸Šæ—¶ï¼Œä¼šå°†blockä¸­å¼•ç”¨çš„å˜é‡ä¹Ÿå¤åˆ¶åˆ°å †ä¸­ã€‚ æˆ‘ä»¬é‡å›žåˆ°æºç ä¸­ã€‚å½“åœ¨blockä¸­ä¿®æ”¹__blockä¿®é¥°çš„å˜é‡æ—¶ã€‚ 12345static void __main_block_func_0(struct __main_block_impl_0 *__cself) &#123; __Block_byref_age_0 *age = __cself-&gt;age; // bound by ref (age-&gt;__forwarding-&gt;age) = 20; NSLog((NSString *)&amp;__NSConstantStringImpl__var_folders_jm_dztwxsdn7bvbz__xj2vlp8980000gn_T_main_b05610_mi_0,(age-&gt;__forwarding-&gt;age)); &#125; é€šè¿‡æºç å¯ä»¥çŸ¥é“ï¼Œå½“ä¿®æ”¹__blockä¿®é¥°çš„å˜é‡æ—¶ï¼Œæ˜¯æ ¹æ®å˜é‡ç”Ÿæˆçš„ç»“æž„ä½“__Block_byref_age_0æ‰¾åˆ°å…¶ä¸­__forwardingæŒ‡é’ˆï¼Œ__forwardingæŒ‡é’ˆæŒ‡å‘çš„æ˜¯ç»“æž„ä½“è‡ªå·±ã€‚å› æ­¤å¯ä»¥æ‰¾åˆ°ageå˜é‡è¿›è¡Œä¿®æ”¹ã€‚ å½“blockåœ¨æ ˆä¸­æ—¶ï¼Œ__Block_byref_age_0ç»“æž„ä½“å†…çš„__forwardingæŒ‡é’ˆæŒ‡å‘ç»“æž„ä½“è‡ªå·±ã€‚ è€Œå½“blockè¢«å¤åˆ¶åˆ°å †ä¸­æ—¶ï¼Œæ ˆä¸­çš„__Block_byref_age_0ç»“æž„ä½“ä¹Ÿä¼šè¢«å¤åˆ¶åˆ°å †ä¸­ä¸€ä»½ï¼Œè€Œæ­¤æ—¶æ ˆä¸­çš„__Block_byref_age_0ç»“æž„ä½“ä¸­çš„__forwardingæŒ‡é’ˆæŒ‡å‘çš„å°±æ˜¯å †ä¸­çš„__Block_byref_age_0ç»“æž„ä½“ï¼Œå †ä¸­__Block_byref_age_0ç»“æž„ä½“å†…çš„__forwardingæŒ‡é’ˆä¾ç„¶æŒ‡å‘è‡ªå·±ã€‚ å¾ªçŽ¯å¼•ç”¨ARCç¤ºä¾‹ä»£ç ï¼š 1234567891011int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; Person *person = [[Person alloc] init]; person.age = 10; person.block = ^&#123; NSLog(@"%d",person.age); &#125;; &#125; NSLog(@"å¤§æ‹¬å·ç»“æŸå•¦"); return 0;&#125; ä¸Šè¿°ä»£ç ä¸­ç¨‹åºè¿è¡Œåˆ°å¤§æ‹¬å·ç»“æŸä¹‹åŽï¼Œpersonå¯¹è±¡ä¾ç„¶æ²¡æœ‰è°ƒç”¨deallocï¼Œæ­¤æ—¶äº§ç”Ÿäº†å¾ªçŽ¯å¼•ç”¨é—®é¢˜ã€‚ é€šè¿‡ä¸€å¼ å›¾çœ‹ä¸€ä¸‹ä»–ä»¬ä¹‹é—´çš„å†…å­˜ç»“æž„ ä¸Šå›¾ä¸­å¯ä»¥å‘çŽ°ï¼ŒPersonå¯¹è±¡å’Œblockå¯¹è±¡ç›¸äº’ä¹‹é—´äº§ç”Ÿäº†å¼ºå¼•ç”¨ï¼Œå¯¼è‡´åŒæ–¹éƒ½ä¸ä¼šè¢«é‡Šæ”¾ï¼Œè¿›è€Œé€ æˆå†…å­˜æ³„æ¼ã€‚ é¦–å…ˆä¸ºäº†èƒ½éšæ—¶æ‰§è¡Œblockï¼Œæˆ‘ä»¬è‚¯å®šå¸Œæœ›personå¯¹blockå¯¹å¼ºå¼•ç”¨ï¼Œè€Œblockå†…éƒ¨å¯¹personçš„å¼•ç”¨ä¸ºå¼±å¼•ç”¨æœ€å¥½ã€‚ ä½¿ç”¨__weak å’Œ __unsafe_unretainedä¿®é¥°ç¬¦å¯ä»¥è§£å†³å¾ªçŽ¯å¼•ç”¨çš„é—®é¢˜ æˆ‘ä»¬ä¸Šé¢ä¹Ÿæåˆ°è¿‡__weakä¼šä½¿ç”¨blockå†…éƒ¨æŒ‡é’ˆå˜ä¸ºå¼±æŒ‡é’ˆã€‚blockå¯¹personå¯¹è±¡ä¸ºå¼±æŒ‡é’ˆçš„è¯ï¼Œä¹Ÿå°±ä¸ä¼šå‡ºçŽ°ç›¸äº’å¼•ç”¨è€Œå¯¼è‡´ä¸ä¼šè¢«é‡Šæ”¾äº†ã€‚ __weak å’Œ __unsafe_unretainedçš„åŒºåˆ«: __weakä¸ä¼šäº§ç”Ÿå¼ºå¼•ç”¨ï¼ŒæŒ‡å‘çš„å¯¹è±¡é”€æ¯æ—¶ï¼Œä¼šè‡ªåŠ¨å°†æŒ‡é’ˆç½®ä¸ºnilã€‚å› æ­¤ä¸€èˆ¬é€šè¿‡__weakæ¥è§£å†³é—®é¢˜ã€‚ __unsafe_unretainedä¸ä¼šäº§ç”Ÿå‰å¼•ç”¨ï¼Œä¸å®‰å…¨ï¼ŒæŒ‡å‘çš„å¯¹è±¡é”€æ¯æ—¶ï¼ŒæŒ‡é’ˆå­˜å‚¨çš„åœ°å€å€¼ä¸å˜ã€‚ ä½¿ç”¨__blockä¹Ÿå¯ä»¥è§£å†³å¾ªçŽ¯å¼•ç”¨çš„é—®é¢˜ã€‚ 12345678910111213int main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; __block Person *person = [[Person alloc] init]; person.age = 10; person.block = ^&#123; NSLog(@"%d",person.age); person = nil; &#125;; person.block(); &#125; NSLog(@"å¤§æ‹¬å·ç»“æŸå•¦"); return 0;&#125; ä¸Šè¿°ä»£ç ä¹‹é—´çš„ç›¸äº’å¼•ç”¨å¯ä»¥ä½¿ç”¨ä¸‹å›¾è¡¨ç¤º ä¸Šé¢æˆ‘ä»¬æåˆ°è¿‡ï¼Œåœ¨blockå†…éƒ¨ä½¿ç”¨å˜é‡ä½¿ç”¨çš„å…¶å®žæ˜¯__blockä¿®é¥°çš„å˜é‡ç”Ÿæˆçš„ç»“æž„ä½“__Block_byref_person_0å†…éƒ¨çš„personå¯¹è±¡ï¼Œé‚£ä¹ˆå½“personå¯¹è±¡ç½®ä¸ºnilä¹Ÿå°±æ–­å¼€äº†ç»“æž„ä½“å¯¹personçš„å¼ºå¼•ç”¨ï¼Œé‚£ä¹ˆä¸‰è§’çš„å¾ªçŽ¯å¼•ç”¨å°±è‡ªåŠ¨æ–­å¼€ã€‚è¯¥é‡Šæ”¾çš„æ—¶å€™å°±ä¼šé‡Šæ”¾äº†ã€‚ä½†æ˜¯æœ‰å¼Šç«¯ï¼Œå¿…é¡»æ‰§è¡Œblockï¼Œå¹¶ä¸”åœ¨blockå†…éƒ¨å°†personå¯¹è±¡ç½®ä¸ºnilã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨blockæ‰§è¡Œä¹‹å‰ä»£ç æ˜¯å› ä¸ºå¾ªçŽ¯å¼•ç”¨å¯¼è‡´å†…å­˜æ³„æ¼çš„ã€‚ MRCä½¿ç”¨__unsafe_unretainedè§£å†³ã€‚åœ¨MRCçŽ¯å¢ƒä¸‹ä¸æ”¯æŒä½¿ç”¨__weakï¼Œä½¿ç”¨åŽŸç†åŒARCçŽ¯å¢ƒä¸‹ç›¸åŒï¼Œè¿™é‡Œä¸åœ¨èµ˜è¿°ã€‚ __blockä¹Ÿèƒ½è§£å†³å¾ªçŽ¯å¼•ç”¨çš„é—®é¢˜ã€‚å› ä¸ºä¸Šæ–‡__blockå†…å­˜ç®¡ç†ä¸­æåˆ°è¿‡ï¼ŒMRCçŽ¯å¢ƒä¸‹ï¼Œå°½ç®¡è°ƒç”¨äº†copyæ“ä½œï¼Œ__blockç»“æž„ä½“ä¸ä¼šå¯¹personäº§ç”Ÿå¼ºå¼•ç”¨ï¼Œä¾ç„¶æ˜¯å¼±å¼•ç”¨ã€‚å› æ­¤åŒæ ·å¯ä»¥è§£å†³å¾ªçŽ¯å¼•ç”¨çš„é—®é¢˜ã€‚]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>Block</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç¼–è¾‘å™¨å’ŒæœåŠ¡å™¨]]></title>
    <url>%2F2018%2F08%2F18%2F%E7%BC%96%E8%BE%91%E5%99%A8%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%2F</url>
    <content type="text"><![CDATA[geditç¼–è¾‘å™¨geditæ˜¯ä¸€ä¸ªLinuxçŽ¯å¢ƒä¸‹çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œç±»ä¼¼windowsä¸‹çš„å†™å­—æ¿ç¨‹åºï¼Œåœ¨ä¸éœ€è¦ç‰¹åˆ«å¤æ‚çš„ç¼–ç¨‹çŽ¯å¢ƒä¸‹ï¼Œä½œä¸ºåŸºæœ¬çš„æ–‡æœ¬ç¼–è¾‘å™¨æ¯”è¾ƒåˆé€‚ã€‚ sublimeç¼–è¾‘å™¨Sublime Text æ˜¯ä¸€ä¸ªä»£ç ç¼–è¾‘å™¨ï¼ˆSublime Text 2æ˜¯æ”¶è´¹è½¯ä»¶ï¼Œä½†å¯ä»¥æ— é™æœŸè¯•ç”¨ï¼‰ ã€‚Sublime Textæ˜¯ç”±ç¨‹åºå‘˜Jon SkinneräºŽ2008å¹´1æœˆä»½æ‰€å¼€å‘å‡ºæ¥ï¼Œå®ƒæœ€åˆè¢«è®¾è®¡ä¸ºä¸€ä¸ªå…·æœ‰ä¸°å¯Œæ‰©å±•åŠŸèƒ½çš„Vimã€‚ å…·æœ‰æ¼‚äº®çš„ç”¨æˆ·ç•Œé¢å’Œå¼ºå¤§çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ä»£ç ç¼©ç•¥å›¾ï¼ŒPythonçš„æ’ä»¶ï¼Œä»£ç æ®µç­‰ã€‚è¿˜å¯è‡ªå®šä¹‰é”®ç»‘å®šï¼Œèœå•å’Œå·¥å…·æ ã€‚Sublime Text çš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼šæ‹¼å†™æ£€æŸ¥ï¼Œä¹¦ç­¾ï¼Œå®Œæ•´çš„ Python API ï¼Œ Goto åŠŸèƒ½ï¼Œå³æ—¶é¡¹ç›®åˆ‡æ¢ï¼Œå¤šé€‰æ‹©ï¼Œå¤šçª—å£ç­‰ç­‰ã€‚Sublime Text æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ç¼–è¾‘å™¨ï¼ŒåŒæ—¶æ”¯æŒWindowsã€Linuxã€Mac OS Xç­‰æ“ä½œç³»ç»Ÿã€‚ å¸¸ç”¨å‘½ä»¤ä»‹ç» ä¿å­˜åŽä»Žåœ†ç‚¹ç¼–ç¨‹å‰ï¼Œè¿™æ ·æ‰æ˜¯ä¿å­˜æˆåŠŸï¼Œä¿å­˜å‘½ä»¤ï¼šCtrl + s ç¼©è¿›æŒ‰tabé”®ï¼Œå›žé€€å›žæ¥shift + tab æ›¿æ¢å†…å®¹ï¼šé€‰ä¸­è¦æ›¿æ¢çš„å†…å®¹ctrl+dè¾“å…¥ä½ è¦ä¿®æ”¹çš„å†…å®¹ Ctrl + enter å…‰æ ‡æ‰€åœ¨è¡Œçš„ä¸‹ä¸€è¡Œæ’å…¥æ–°è¡Œ Ctrl + shift + enter å…‰æ ‡æ‰€åœ¨è¡Œçš„ä¸Šä¸€è¡Œæ’å…¥æ–°è¡Œ Ctrl + left/right å‘å·¦å³å•ä½æ€§ç§»åŠ¨å…‰æ ‡ shift + up/down é€‰ä¸­å¤šè¡Œ Ctrl + / å°†å…‰æ ‡æ‰€åœ¨è¡Œæ³¨é‡Š Ctrl + shift + / å¤šè¡Œæ³¨é‡Š Ctrl + ku å°†é€‰ä¸­å¤„æ¢ä¸ºå¤§å†™ Ctrl + kl å°†é€‰ä¸­å¤„æ¢ä¸ºå°å†™ Ctrl + Z æ’¤é”€ Ctrl + F æŸ¥æ‰¾å…³é”®å­— Ctrl + G æŸ¥æ‰¾æŸè¡Œ Ctrl + M å…‰æ ‡ç§»åˆ°æ‹¬å·å†…å®¹çš„å¤´æˆ–å°¾å¤„ Ctrl+Shift+K åˆ é™¤æ•´è¡Œã€‚ ç¼–è¾‘å™¨ä¹‹ç¥ž -vimviç®€ä»‹viæ˜¯â€œVisual interfaceâ€çš„ç®€ç§°ï¼Œå®ƒåœ¨Linuxä¸Šçš„åœ°ä½å°±ä»¿ä½›Editç¨‹åºåœ¨DOSä¸Šä¸€æ ·ã€‚å®ƒå¯ä»¥æ‰§è¡Œè¾“å‡ºã€åˆ é™¤ã€æŸ¥æ‰¾ã€æ›¿æ¢ã€å—æ“ä½œç­‰ä¼—å¤šæ–‡æœ¬æ“ä½œï¼Œè€Œä¸”ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦å¯¹å…¶è¿›è¡Œå®šåˆ¶ã€‚Viä¸æ˜¯ä¸€ä¸ªæŽ’ç‰ˆç¨‹åºï¼Œå®ƒä¸è±¡Wordæˆ–WPSé‚£æ ·å¯ä»¥å¯¹å­—ä½“ã€æ ¼å¼ã€æ®µè½ç­‰å…¶ä»–å±žæ€§è¿›è¡Œç¼–æŽ’ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘ç¨‹åºã€‚ viæ²¡æœ‰èœå•ï¼Œåªæœ‰å‘½ä»¤ï¼Œä¸”å‘½ä»¤ç¹å¤šã€‚ ä¸‰ç§å·¥ä½œæ¨¡å¼ï¼š å‘½ä»¤æ¨¡å¼ æ–‡æœ¬è¾“å…¥æ¨¡å¼ æœ«è¡Œæ¨¡å¼ å‘½ä»¤è¡Œæ¨¡å¼ä»»ä½•æ—¶å€™ï¼Œä¸ç®¡ç”¨æˆ·å¤„äºŽä½•ç§æ¨¡å¼ï¼Œåªè¦æŒ‰ä¸€ä¸‹ESCé”®ï¼Œå³å¯ä½¿Viè¿›å…¥å‘½ä»¤æ¨¡å¼ï¼›æˆ‘ä»¬åœ¨shellçŽ¯å¢ƒ(æç¤ºç¬¦ä¸º$)ä¸‹è¾“å…¥å¯åŠ¨Viå‘½ä»¤ï¼Œè¿›å…¥ç¼–è¾‘å™¨æ—¶ï¼Œä¹Ÿæ˜¯å¤„äºŽè¯¥æ¨¡å¼ä¸‹ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·å¯ä»¥è¾“å…¥å„ç§åˆæ³•çš„Viå‘½ä»¤ï¼Œç”¨äºŽç®¡ç†è‡ªå·±çš„æ–‡æ¡£ã€‚æ­¤æ—¶ä»Žé”®ç›˜ä¸Šè¾“å…¥çš„ä»»ä½•å­—ç¬¦éƒ½è¢«å½“åšç¼–è¾‘å‘½ä»¤æ¥è§£é‡Šï¼Œè‹¥è¾“å…¥çš„å­—ç¬¦æ˜¯åˆæ³•çš„Viå‘½ä»¤ï¼Œåˆ™Viåœ¨æŽ¥å—ç”¨æˆ·å‘½ä»¤ä¹‹åŽå®Œæˆç›¸åº”çš„åŠ¨ä½œã€‚ä½†éœ€æ³¨æ„çš„æ˜¯ï¼Œæ‰€è¾“å…¥çš„å‘½ä»¤å¹¶ä¸åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå‡ºæ¥ã€‚è‹¥è¾“å…¥çš„å­—ç¬¦ä¸æ˜¯Viçš„åˆæ³•å‘½ä»¤ï¼ŒViä¼šå“é“ƒæŠ¥è­¦ã€‚ æ–‡æœ¬è¾“å…¥æ¨¡å¼åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥æ’å…¥å‘½ä»¤iã€é™„åŠ å‘½ä»¤a ã€æ‰“å¼€å‘½ä»¤oã€ä¿®æ”¹å‘½ä»¤cã€å–ä»£å‘½ä»¤ræˆ–æ›¿æ¢å‘½ä»¤séƒ½å¯ä»¥è¿›å…¥æ–‡æœ¬è¾“å…¥æ¨¡å¼ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·è¾“å…¥çš„ä»»ä½•å­—ç¬¦éƒ½è¢«Viå½“åšæ–‡ä»¶å†…å®¹ä¿å­˜èµ·æ¥ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚åœ¨æ–‡æœ¬è¾“å…¥è¿‡ç¨‹ä¸­ï¼Œè‹¥æƒ³å›žåˆ°å‘½ä»¤æ¨¡å¼ä¸‹ï¼ŒæŒ‰é”®ESCå³å¯ã€‚ æœ«è¡Œæ¨¡å¼æœ«è¡Œæ¨¡å¼ä¹Ÿç§°exè½¬ä¹‰æ¨¡å¼ã€‚åœ¨å‘½ä»¤æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·æŒ‰â€œ:â€é”®å³å¯è¿›å…¥æœ«è¡Œæ¨¡å¼ä¸‹ï¼Œæ­¤æ—¶Viä¼šåœ¨æ˜¾ç¤ºçª—å£çš„æœ€åŽä¸€è¡Œ(é€šå¸¸ä¹Ÿæ˜¯å±å¹•çš„æœ€åŽä¸€è¡Œ)æ˜¾ç¤ºä¸€ä¸ªâ€œ:â€ä½œä¸ºæœ«è¡Œæ¨¡å¼çš„æç¤ºç¬¦ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥å‘½ä»¤ã€‚å¤šæ•°æ–‡ä»¶ç®¡ç†å‘½ä»¤éƒ½æ˜¯åœ¨æ­¤æ¨¡å¼ä¸‹æ‰§è¡Œçš„(å¦‚æŠŠç¼–è¾‘ç¼“å†²åŒºçš„å†…å®¹å†™åˆ°æ–‡ä»¶ä¸­ç­‰)ã€‚æœ«è¡Œå‘½ä»¤æ‰§è¡Œå®ŒåŽï¼ŒViè‡ªåŠ¨å›žåˆ°å‘½ä»¤æ¨¡å¼ã€‚ä¾‹å¦‚ï¼š 1:sp newfile åˆ™åˆ†å‡ºä¸€ä¸ªçª—å£ç¼–è¾‘newfileæ–‡ä»¶ã€‚å¦‚æžœè¦ä»Žå‘½ä»¤æ¨¡å¼è½¬æ¢åˆ°ç¼–è¾‘æ¨¡å¼ï¼Œå¯ä»¥é”®å…¥å‘½ä»¤aæˆ–è€…iï¼›å¦‚æžœéœ€è¦ä»Žæ–‡æœ¬æ¨¡å¼è¿”å›žï¼Œåˆ™æŒ‰Escé”®å³å¯ã€‚åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥â€œ:â€å³å¯åˆ‡æ¢åˆ°æœ«è¡Œæ¨¡å¼ï¼Œç„¶åŽè¾“å…¥å‘½ä»¤ã€‚æ–‡ä»¶å¦å­˜ä¸ºï¼š 1:w newfile æ–‡ä»¶å¦å­˜ä¸ºnewfileï¼Œå½“ç„¶å½“å‰æ–‡ä»¶ä¹Ÿåœ¨ï¼Œç¼–è¾‘çš„æ—¶å€™å°±æ˜¯ç¼–è¾‘çš„å½“å‰æ–‡ä»¶ã€‚ vimåŸºç¡€æ“ä½œvimæ˜¯ä»Ž vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ ã€‚ä»£ç è¡¥å®Œã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œã€‚Viä¸Žvimçš„å…³ç³»ï¼Œå®ƒä»¬éƒ½æ˜¯å¤šæ¨¡å¼ç¼–è¾‘å™¨ï¼Œä¸åŒçš„æ˜¯vim æ˜¯viçš„å‡çº§ç‰ˆæœ¬ï¼Œå®ƒä¸ä»…å…¼å®¹viçš„æ‰€æœ‰æŒ‡ä»¤ï¼Œè€Œä¸”è¿˜æœ‰ä¸€äº›æ–°çš„ç‰¹æ€§åœ¨é‡Œé¢ è¿›å…¥æ’å…¥æ¨¡å¼ï¼šESCESCï¼šä»Žæ’å…¥æ¨¡å¼æˆ–è€…æœ«è¡Œæ¨¡å¼è¿›å…¥å‘½ä»¤æ¨¡å¼ ç§»åŠ¨å…‰æ ‡ï¼š 123456789101112h: å·¦ç§» j: ä¸‹ç§» k: ä¸Šç§» l: å³ç§»Mï¼šå…‰æ ‡ç§»åŠ¨åˆ°ä¸­é—´è¡Œï¼Œå±å¹•çš„ä¸­é—´è¡ŒL: å…‰æ ‡ç§»åŠ¨åˆ°å±å¹•æœ€åŽä¸€è¡Œè¡Œé¦– G: ç§»åŠ¨åˆ°æŒ‡å®šè¡Œ,è¡Œå·shift+g,ä¾‹å¦‚ï¼šå®šä½åˆ°ç¬¬10è¡Œï¼šç¬¬ä¸€æ­¥10ï¼Œç¬¬äºŒæ­¥shift+gå¦‚æžœshift+g:ç›´æŽ¥åˆ°æ–‡ä»¶æœ€åŽä¸€è¡Œè¡Œé¦–w: å‘åŽä¸€æ¬¡ç§»åŠ¨ä¸€ä¸ªå­— b: å‘å‰ä¸€æ¬¡ç§»åŠ¨ä¸€ä¸ªå­—gg: å…‰æ ‡ç§»åŠ¨æ–‡ä»¶å¼€å¤´ G: å…‰æ ‡ç§»åŠ¨åˆ°æ–‡ä»¶æœ«å°¾ ç¿»å±ï¼š 1234Ctr-d: å‘ä¸‹ç¿»åŠå± Ctr-u: å‘ä¸Šç¿»åŠå±Ctr-f: å‘ä¸‹ç¿»ä¸€å± Ctr-b: å‘ä¸Šç¿»ä¸€å± åˆ é™¤å‰ªåˆ‡å‘½ä»¤1234567x: åˆ é™¤å…‰æ ‡åŽä¸€ä¸ªå­—ç¬¦,ç›¸å½“äºŽ Del X: åˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªå­—ç¬¦,ç›¸å½“äºŽ Backspacedd: åˆ é™¤å…‰æ ‡æ‰€åœ¨è¡Œ,n dd åˆ é™¤æŒ‡å®šçš„è¡Œæ•° ï¼Œå¦‚æžœåŠ ä¸Špå°±æ˜¯å‰ªåˆ‡äº†D: åˆ é™¤å…‰æ ‡åŽæœ¬è¡Œæ‰€æœ‰å†…å®¹,åŒ…å«å…‰æ ‡æ‰€åœ¨å­—ç¬¦ d0: åˆ é™¤å…‰æ ‡å‰æœ¬è¡Œæ‰€æœ‰å†…å®¹,ä¸åŒ…å«å…‰æ ‡æ‰€åœ¨å­—ç¬¦dw: åˆ é™¤å…‰æ ‡å¼€å§‹ä½ç½®çš„å­—,åŒ…å«å…‰æ ‡æ‰€åœ¨å­—ç¬¦ æ’¤é”€å‘½ä»¤12u: ä¸€æ­¥ä¸€æ­¥æ’¤é”€ Ctr-r: åæ’¤é”€ æ–‡æœ¬è¡Œç§»åŠ¨123&gt;&gt;: æ–‡æœ¬è¡Œå³ç§» &lt;&lt;: æ–‡æœ¬è¡Œå·¦ç§».ï¼šé‡å¤ä¸Šä¸€æ¬¡æ“ä½œçš„å‘½ä»¤ å¤åˆ¶ç²˜è´´12yyï¼šå¤åˆ¶å½“å‰è¡Œï¼Œn yyï¼šå¤åˆ¶nè¡Œpï¼šåœ¨å…‰æ ‡æ‰€åœ¨çš„ä½ç½®å‘ä¸‹å¼€è¾Ÿæ–°çš„ä¸€è¡Œï¼Œç²˜è´´ å¯è§†æ¨¡å¼12v: æŒ‰å­—ç¬¦ç§»åŠ¨,é€‰ä¸­æ–‡æœ¬ V: æŒ‰è¡Œç§»åŠ¨,é€‰ä¸­æ–‡æœ¬å¯è§†æ¨¡å¼å¯ä»¥é…åˆ d, y, &gt;&gt;, &lt;&lt; å®žçŽ°å¯¹æ–‡æœ¬å—çš„åˆ é™¤,å¤åˆ¶,å·¦å³ç§»åŠ¨ æ›¿æ¢æ“ä½œ12rï¼šæ›¿æ¢å½“å‰å­—ç¬¦Rï¼šæ›¿æ¢å½“å‰å­—ç¬¦ï¼Œç„¶åŽå…‰æ ‡å¾€åŽä¸€ä¸ªå­—ç¬¦åœç•™ æŸ¥æ‰¾å‘½ä»¤123/ï¼šstræŸ¥æ‰¾nï¼šä¸‹ä¸€ä¸ªNï¼šä¸Šä¸€ä¸ª æ›¿æ¢å‘½ä»¤1234æŠŠabcå…¨éƒ¨æ›¿æ¢æˆ123ï¼š1ã€è¿›å…¥æœ«è¡Œæ¨¡å¼ï¼šshift+ï¼š2ã€æœ«è¡Œæ¨¡å¼ä¸‹ï¼Œå°†å…‰æ ‡æ‰€åœ¨è¡Œçš„abcæ›¿æ¢æˆ123ï¼š%s/abc/123/g3ã€æœ«è¡Œæ¨¡å¼ä¸‹ï¼Œå°†ç¬¬1è¡Œè‡³ç¬¬10è¡Œä¹‹é—´çš„abcæ›¿æ¢æˆ123ï¼š1,10s/abc/123/g ä¿å­˜å¹¶é€€å‡ºçš„ä¸‰ç§æ–¹å¼ æœ«è¡Œæ¨¡å¼ä¸‹ï¼š:x æœ«è¡Œæ¨¡å¼ä¸‹ï¼š:wqä¿å­˜å¹¶ä¸”é€€å‡º å‘½ä»¤æ¨¡å¼ä¸‹ï¼šShift+zz,ï¼ˆè¯´æ˜Žï¼Œè¿™ä¸ªé”®å®¹æ˜“å˜æˆä¸­è‹±æ–‡è¾“å…¥æ³•åˆ‡æ¢ï¼Œè¦æ³¨æ„ï¼‰ ubuntuè½¯ä»¶å®‰è£…ä¸Žå¸è½½æ›´æ–°Ubuntuè½¯ä»¶ä¸‹è½½åœ°å€ å¯»æ‰¾å›½å†…é•œåƒæºï¼šhttps://mirrors.tuna.tsinghua.edu.cn/ ã€‚æ‰€è°“çš„é•œåƒæºï¼šå¯ä»¥ç†è§£ä¸ºæä¾›ä¸‹è½½è½¯ä»¶çš„åœ°æ–¹ï¼Œæ¯”å¦‚Androidæ‰‹æœºä¸Šå¯ä»¥ä¸‹è½½è½¯ä»¶çš„å®‰å“å¸‚åœºï¼›iOSæ‰‹æœºä¸Šå¯ä»¥ä¸‹è½½è½¯ä»¶çš„AppStore å¤‡ä»½Ubuntué»˜è®¤çš„æºåœ°å€ 1sudo cp /etc/apt/sources.list /etc/apt/sources.list.backup æ›´æ–°æºæœåŠ¡å™¨åˆ—è¡¨ æ›´æ–°æº åšå®Œæ­¤æ­¥éª¤ä¹‹åŽï¼Œå°±å¯ä»¥è¿›è¡Œapt-get install ä¸‹è½½äº† Ubuntuè½¯ä»¶æ“ä½œçš„ç›¸å…³å‘½ä»¤12345678910111213141516171819202122232425262728293031sudo apt-get update æ›´æ–°æºsudo apt-get install package å®‰è£…åŒ…sudo apt-get remove package åˆ é™¤åŒ…sudo apt-cache search package æœç´¢è½¯ä»¶åŒ…sudo apt-cache show package èŽ·å–åŒ…çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚è¯´æ˜Žã€å¤§å°ã€ç‰ˆæœ¬ç­‰sudo apt-get install package --reinstall é‡æ–°å®‰è£…åŒ…sudo apt-get -f install ä¿®å¤å®‰è£…sudo apt-get remove package --purge åˆ é™¤åŒ…ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ç­‰sudo apt-get build-dep package å®‰è£…ç›¸å…³çš„ç¼–è¯‘çŽ¯å¢ƒsudo apt-get upgrade æ›´æ–°å·²å®‰è£…çš„åŒ…sudo apt-get dist-upgrade å‡çº§ç³»ç»Ÿsudo apt-cache depends package äº†è§£ä½¿ç”¨è¯¥åŒ…ä¾èµ–é‚£äº›åŒ…sudo apt-cache rdepends package æŸ¥çœ‹è¯¥åŒ…è¢«å“ªäº›åŒ…ä¾èµ–sudo apt-get source package ä¸‹è½½è¯¥åŒ…çš„æºä»£ç sudo apt-get clean &amp;&amp; sudo apt-get autoclean æ¸…ç†æ— ç”¨çš„åŒ…sudo apt-get check æ£€æŸ¥æ˜¯å¦æœ‰æŸåçš„ä¾èµ– Linuxå¸¸ç”¨æœåŠ¡å™¨æž„å»º-sambaSambaæ˜¯åœ¨Linuxå’ŒUNIXç³»ç»Ÿä¸Šå®žçŽ°SMBåè®®çš„ä¸€ä¸ªå…è´¹è½¯ä»¶ï¼Œèƒ½å¤Ÿå®Œæˆåœ¨windowsã€macæ“ä½œç³»ç»Ÿä¸‹è®¿é—®linuxç³»ç»Ÿä¸‹çš„å…±äº«æ–‡ä»¶ ã€‚ å®‰è£…ä½¿ç”¨aptå‘½ä»¤å®‰è£…samba ï¼šsudo apt-get install samba samba-common é…ç½® åˆ›å»ºå­˜æ”¾å…±äº«æ–‡ä»¶çš„è·¯å¾„ : åœ¨homeè·¯å¾„ä¸‹è¾“å…¥å‘½ä»¤ touch share ä¿®æ”¹å…¶æƒé™ï¼šchmod 777 share ä¿®æ”¹sambaçš„é…ç½®æ–‡ä»¶ï¼švi /etc/samba/smb.conf åˆ›å»ºsambaè´¦æˆ·â€“å¦‚æžœè¦è®¾ç½®å¯†ç çš„è¯è®¾ç½®è¿™æ­¥ å¯åŠ¨sambaå¯åŠ¨ï¼šsudo system-config-sambaã€‚å½“å¯¹é…ç½®è¿›è¡Œäº†æ›´æ–°ï¼Œéœ€è¦é‡å¯sambaè½¯ä»¶åŽæ‰èƒ½ç”Ÿæ•ˆã€‚é‡å¯å‘½ä»¤ï¼š/etc/init.d/smbd restart è®¿é—®å…±äº«æ–‡ä»¶windowsä¸‹è®¿é—®æ–¹å¼ å¿«æ·é”®ï¼šWin + r ï¼Œç„¶åŽè¾“å…¥ä½ çš„Linuxç³»ç»Ÿçš„IPåœ°å€ ä¾‹å¦‚ï¼š\\192.168.31.28 ä¹‹åŽä¼šè¾“å…¥æ¡†ï¼Œè¾“å…¥Linuxç³»ç»Ÿè´¦å·å’Œå¯†ç  å³å¯é“¾æŽ¥ã€‚é“¾æŽ¥ä¹‹åŽå¯ä»¥å¯¹linuxç›®å½•è¿›è¡Œè¯»å†™ macOSä¸‹è®¿é—®æ–¹å¼ cmd + k è¾“å…¥smb:// + IP ç‚¹å‡»æ³¨å†Œç”¨æˆ·ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç å³å¯ Linuxå¸¸ç”¨æœåŠ¡å™¨æž„å»º-sshsshä»‹ç»SSHä¸ºSecure Shellçš„ç¼©å†™ï¼Œç”± IETF çš„ç½‘ç»œå·¥ä½œå°ç»„ï¼ˆNetwork Working Groupï¼‰æ‰€åˆ¶å®šï¼›SSH ä¸ºå»ºç«‹åœ¨åº”ç”¨å±‚å’Œä¼ è¾“å±‚åŸºç¡€ä¸Šçš„å®‰å…¨åè®®ã€‚ SSHæ˜¯ç›®å‰è¾ƒå¯é ï¼Œä¸“ä¸ºè¿œç¨‹ç™»å½•ä¼šè¯å’Œå…¶ä»–ç½‘ç»œæœåŠ¡æä¾›å®‰å…¨æ€§çš„åè®®ã€‚å¸¸ç”¨äºŽè¿œç¨‹ç™»å½•ï¼Œä»¥åŠç”¨æˆ·ä¹‹é—´è¿›è¡Œèµ„æ–™æ‹·è´ã€‚ åˆ©ç”¨SSHåè®®å¯ä»¥æœ‰æ•ˆé˜²æ­¢è¿œç¨‹ç®¡ç†è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æ³„éœ²é—®é¢˜ã€‚SSHæœ€åˆæ˜¯ UNIX ç³»ç»Ÿä¸Šçš„ä¸€ä¸ªç¨‹åºï¼ŒåŽæ¥åˆè¿…é€Ÿæ‰©å±•åˆ°å…¶ä»–æ“ä½œå¹³å°ã€‚SSH åœ¨æ­£ç¡®ä½¿ç”¨æ—¶å¯å¼¥è¡¥ç½‘ç»œä¸­çš„æ¼æ´žã€‚SSH å®¢æˆ·ç«¯é€‚ç”¨äºŽå¤šç§å¹³å°ã€‚å‡ ä¹Žæ‰€æœ‰ UNIX å¹³å°â€”åŒ…æ‹¬ HP-UXã€Linuxã€AIXã€Solarisã€Digital UNIXã€Irixï¼Œä»¥åŠå…¶ä»–å¹³å°ï¼Œéƒ½å¯è¿è¡ŒSSHã€‚ ä½¿ç”¨SSHæœåŠ¡ï¼Œéœ€è¦å®‰è£…ç›¸åº”çš„æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„å…³ç³»ï¼šå¦‚æžœï¼ŒAæœºå™¨æƒ³è¢«Bæœºå™¨è¿œç¨‹æŽ§åˆ¶ï¼Œé‚£ä¹ˆï¼ŒAæœºå™¨éœ€è¦å®‰è£…SSHæœåŠ¡å™¨ï¼ŒBæœºå™¨éœ€è¦å®‰è£…SSHå®¢æˆ·ç«¯ã€‚ åœ¨linuxæœåŠ¡å™¨å®‰è£…sshå®‰è£…å‘½ä»¤ï¼šsudo apt-get install openssh-server windowsä¸‹sshè¿žæŽ¥æœåŠ¡å™¨å®‰è£…è½¯ä»¶Xshell 5 macOSä¸‹sshè¿žæŽ¥æœåŠ¡å™¨ä»ŽmacOSæˆ–è€…linuxç³»ç»Ÿå®¢æˆ·æœºè¿œç¨‹ç™»é™†linuxç³»ç»ŸæœåŠ¡å™¨ 12ssh ç”¨æˆ·å@IPä¾‹å¦‚ï¼šssh simplecoder@192.168.28.31 ä½¿ç”¨sshè®¿é—®ï¼Œå¦‚è®¿é—®å‡ºçŽ°é”™è¯¯ã€‚å¯æŸ¥çœ‹æ˜¯å¦æœ‰è¯¥æ–‡ä»¶ ï½ž/.ssh/known_ssh å°è¯•åˆ é™¤è¯¥æ–‡ä»¶è§£å†³ ã€‚SSH å‘ŠçŸ¥ç”¨æˆ·ï¼Œè¿™ä¸ªä¸»æœºä¸èƒ½è¯†åˆ«ï¼Œè¿™æ—¶é”®å…¥â€yesâ€ï¼ŒSSH å°±ä¼šå°†ç›¸å…³ä¿¡æ¯ï¼Œå†™å…¥â€ ~/.ssh/know_hostsâ€ ä¸­ï¼Œå†æ¬¡è®¿é—®ï¼Œå°±ä¸ä¼šæœ‰è¿™äº›ä¿¡æ¯äº†ã€‚ç„¶åŽè¾“å…¥å®Œå£ä»¤,å°±å¯ä»¥ç™»å½•åˆ°ä¸»æœºäº†ã€‚ Linuxå¸¸ç”¨æœåŠ¡å™¨æž„å»º-ftpFTP æ˜¯File Transfer Protocolï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰çš„è‹±æ–‡ç®€ç§°ï¼Œè€Œä¸­æ–‡ç®€ç§°ä¸ºâ€œæ–‡ä¼ åè®®â€ã€‚ç”¨äºŽInternetä¸Šçš„æŽ§åˆ¶æ–‡ä»¶çš„åŒå‘ä¼ è¾“ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ˆApplicationï¼‰ã€‚åŸºäºŽä¸åŒçš„æ“ä½œç³»ç»Ÿæœ‰ä¸åŒçš„FTPåº”ç”¨ç¨‹åºï¼Œè€Œæ‰€æœ‰è¿™äº›åº”ç”¨ç¨‹åºéƒ½éµå®ˆåŒä¸€ç§åè®®ä»¥ä¼ è¾“æ–‡ä»¶ã€‚ åœ¨FTPçš„ä½¿ç”¨å½“ä¸­ï¼Œç”¨æˆ·ç»å¸¸é‡åˆ°ä¸¤ä¸ªæ¦‚å¿µï¼šâ€ä¸‹è½½â€ï¼ˆDownloadï¼‰å’Œâ€ä¸Šä¼ â€ï¼ˆUploadï¼‰ã€‚â€ä¸‹è½½â€æ–‡ä»¶å°±æ˜¯ä»Žè¿œç¨‹ä¸»æœºæ‹·è´æ–‡ä»¶è‡³è‡ªå·±çš„è®¡ç®—æœºä¸Šï¼›â€ä¸Šä¼ â€æ–‡ä»¶å°±æ˜¯å°†æ–‡ä»¶ä»Žè‡ªå·±çš„è®¡ç®—æœºä¸­æ‹·è´è‡³è¿œç¨‹ä¸»æœºä¸Šã€‚ç”¨Internetè¯­è¨€æ¥è¯´ï¼Œç”¨æˆ·å¯é€šè¿‡å®¢æˆ·æœºç¨‹åºå‘ï¼ˆä»Žï¼‰è¿œç¨‹ä¸»æœºä¸Šä¼ ï¼ˆä¸‹è½½ï¼‰æ–‡ä»¶ã€‚ å®‰è£…vsftpdæœåŠ¡å™¨ å‘½ä»¤ï¼šsudo apt-get install vsftpd é…ç½®vsftpd.confæ–‡ä»¶ : sudo vi /etc/vsftpd.confã€‚ ä¸è®¸åŒ¿åç”¨æˆ·ç™»å½•ï¼šanonyous_enable=NOæ³¨æ„NOæ˜¯å¤§å†™ ç„¶åŽæŒ‡å®šftpä¸Šä¼ ä¸‹è½½ç›®å½• è®¾ç½®å…è®¸æœ¬æœºç™»å½•ï¼šlocal_enable = YES å…è®¸vsftpd.chroot_listæ–‡ä»¶ä¸­ç”¨æˆ·è¿›ç¨‹ç™»å½•FTPæœåŠ¡å™¨ 12chroot_list_enable=YESchroot_list_file=/etc/vsftpd.chroot_list å…è®¸ä¸Šä¼ æ–‡ä»¶åˆ°FTPæœåŠ¡å™¨:write_enable=YES é…ç½®ç”¨æˆ·ä¿¡æ¯ :sudo vi /etc/vsftpd.chroot_list ä¿®æ”¹æ–‡ä»¶æ‹¥æœ‰è€…æƒé™åªæœ‰xr åˆ›å»ºshareç›®å½• é‡æ–°å¯åŠ¨FTPæœåŠ¡å™¨:sudo /etc/init.d/vsftpd restart åœ¨windowä¸Šä½¿ç”¨ftpå®¢æˆ·ç«¯(FileZilla)å®‰è£…&amp;é…ç½®FileZilla ä¹‹åŽåœ¨é…ç½®ç•Œé¢è¾“å…¥ä¸»æœºIPã€ç”¨æˆ·åã€å¯†ç ã€ç«¯å£å·ï¼ˆftpé»˜è®¤ç«¯å£21ï¼‰å³å¯è¿žæŽ¥ åœ¨macOSä¸Šä½¿ç”¨å‘½ä»¤åˆ é™¤å’Œä¸‹è½½æ–‡ä»¶123ftp IP ç™»å½•ftpæœåŠ¡å™¨put somefile ä¸Šä¼ æ–‡ä»¶get somefile ä¸‹è½½æ–‡ä»¶]]></content>
      <categories>
        <category>Linuxå­¦ä¹ æ€»ç»“</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…³è”å¯¹è±¡]]></title>
    <url>%2F2018%2F08%2F10%2F%E5%85%B3%E8%81%94%E5%AF%B9%E8%B1%A1%2F</url>
    <content type="text"><![CDATA[å…³è”å¯¹è±¡å…ˆæ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•å®žçŽ°ç»™åˆ†ç±»â€œæ·»åŠ æˆå‘˜å˜é‡â€ï¼Ÿ é»˜è®¤æƒ…å†µä¸‹ï¼Œå› ä¸ºåˆ†ç±»åº•å±‚ç»“æž„çš„é™åˆ¶ï¼Œä¸èƒ½æ·»åŠ æˆå‘˜å˜é‡åˆ°åˆ†ç±»ä¸­ã€‚ 1234567891011121314151617struct category_t &#123; const char *name; classref_t cls; struct method_list_t *instanceMethods; // å¯¹è±¡æ–¹æ³• struct method_list_t *classMethods; // ç±»æ–¹æ³• struct protocol_list_t *protocols; // åè®® struct property_list_t *instanceProperties; // å±žæ€§ // Fields below this point are not always present on disk. struct property_list_t *_classProperties; method_list_t *methodsForMeta(bool isMeta) &#123; if (isMeta) return classMethods; else return instanceMethods; &#125; property_list_t *propertiesForMeta(bool isMeta, struct header_info *hi);&#125;; åˆ†ç±»çš„ç»“æž„ä½“å†…éƒ¨æœ‰ä¸€ä¸ªstruct property_list_t *instancePropertiesç»“æž„ä½“æˆå‘˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‘åˆ†ç±»é‡Œé¢æ·»åŠ å±žæ€§ã€‚ä½†æ­¤æ—¶ç³»ç»Ÿå¹¶ä¸ä¼šä¸ºæˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„æˆå‘˜å˜é‡ä»¥åŠsetã€getæ–¹æ³•ã€‚ ä½ å¯èƒ½æƒ³åˆ°çš„æ–¹æ¡ˆå…¨å±€å˜é‡æ—¢ç„¶ç³»ç»Ÿä¸ä¼šå¸®æˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„setã€getæ–¹æ³•ï¼Œæˆ‘ä»¬ä¸å¦¨è‡ªå·±æ¥å®žçŽ°ã€‚ 123456789static NSString *_name;-(void)setName:(NSString *)name&#123; _name = name;&#125;-(NSString *)name&#123; return _name;&#125; ä¸Šé¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé™æ€çš„å…¨å±€å˜é‡static NSString *_nameæ¥ä¿å­˜åˆ†ç±»çš„â€œæˆå‘˜å˜é‡â€ï¼Œå½“è°ƒç”¨ç±»çš„setæˆ–è€…getæ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å†…éƒ¨æŠŠå€¼èµ‹ç»™è‡ªå·±åˆ›å»ºçš„å…¨å±€å˜é‡ï¼Œè¿™æ ·å°±èƒ½å®žçŽ°å¤–è§‚ä¸Šçœ‹èµ·æ¥å’Œæˆå‘˜å˜é‡æ²¡ä»€ä¹ˆå·®å¼‚ã€‚ ä½†å­˜åœ¨çš„é—®é¢˜ä¹Ÿæ˜¾è€Œæ˜“è§ã€‚ é¦–å…ˆè¿™ä¸ªå…¨å±€å˜é‡æˆ‘ä»¬ä¸å¥½ç®¡ç†å®ƒçš„å†…å­˜ï¼Œå…¶æ¬¡æ˜¯å¤šä¸ªå¯¹è±¡å…±ç”¨ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä¼šå¯¼è‡´å‰é¢è®¾ç½®çš„å€¼è¢«åŽé¢çš„è¦†ç›–ã€‚ å…¨å±€å­—å…¸æˆ–è®¸ä½ è¿˜ä¼šæƒ³åˆ°ç”¨å…¨å±€å­—å…¸æ¥è§£å†³ã€‚ æ¯”å¦‚ï¼Œåˆ†ç±»é‡Œæœ‰ä¸¤ä¸ªå±žæ€§name,weight: 12345678910111213141516171819202122232425262728293031#define SPKey [NSString stringWithFormat:@"%p", self]@implementation Person (Test)NSMutableDictionary *names_;NSMutableDictionary *weights_;+ (void)load&#123; weights_ = [NSMutableDictionary dictionary]; names_ = [NSMutableDictionary dictionary];&#125;- (void)setName:(NSString *)name&#123; names_[SPKey] = name;&#125;- (NSString *)name&#123; return names_[SPKey];&#125;- (void)setWeight:(int)weight&#123; weights_[SPKey] = @(weight);&#125;- (int)weight&#123; return [weights_[SPKey] intValue];&#125; è¿™ç§æ–¹å¼èƒ½å¤Ÿè§£å†³ä¸Šä¸ªæ–¹æ³•å†…å­˜å…±ç”¨çš„é—®é¢˜ï¼Œä½†æ— æ³•è§£å†³å†…å­˜ç®¡ç†çš„é—®é¢˜ã€‚å½“ç„¶è¿˜æœ‰å…¶ä»–é£Žé™©ï¼šæ¯”å¦‚çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ ä½¿ç”¨RunTimeåŠ¨æ€æ·»åŠ å±žæ€§RunTimeæä¾›äº†åŠ¨æ€æ·»åŠ å±žæ€§å’ŒèŽ·å¾—å±žæ€§çš„APIã€‚ æ·»åŠ å…³è”å¯¹è±¡ void objc_setAssociatedObject(id object, const void * key, id value, objc_AssociationPolicy policy) ç¬¬ä¸€ä¸ªå‚æ•°objectï¼šç»™å“ªä¸ªå¯¹è±¡æ·»åŠ å±žæ€§ ç¬¬äºŒä¸ªå‚æ•°const void * key:å±žæ€§åï¼Œæ ¹æ®keyèŽ·å–å…³è”å¯¹è±¡çš„å±žæ€§çš„å€¼ï¼Œåœ¨objc_getAssociatedObjectä¸­é€šè¿‡æ¬¡keyèŽ·å¾—å±žæ€§çš„å€¼å¹¶è¿”å›žã€‚ ç¬¬ä¸‰ä¸ªå‚æ•°id value: å…³è”çš„å€¼ï¼Œä¹Ÿå°±æ˜¯setæ–¹æ³•ä¼ å…¥çš„å€¼ç»™å±žæ€§åŽ»ä¿å­˜ã€‚ ç¬¬å››ä¸ªå‚æ•°objc_AssociationPolicy policy:ç­–ç•¥ï¼Œå±žæ€§ä»¥ä»€ä¹ˆå½¢å¼ä¿å­˜ã€‚ èŽ·å¾—å…³è”å¯¹è±¡ id objc_getAssociatedObject(id object, const void * key) ç¬¬ä¸€ä¸ªå‚æ•°id object:èŽ·å–å“ªä¸ªå¯¹è±¡é‡Œé¢çš„å…³è”çš„å±žæ€§.ã€‚ ç¬¬äºŒä¸ªå‚æ•°const void * key:ä»€ä¹ˆå±žæ€§ï¼Œä¸Žobjc_setAssociatedObjectä¸­çš„keyç›¸å¯¹åº”ï¼Œå³é€šè¿‡keyå€¼å–å‡ºvalueã€‚ ç§»é™¤æ‰€æœ‰çš„å…³è”å¯¹è±¡ void objc_removeAssociatedObjects( id object) å…³äºŽobjc_AssociationPolicy,å’Œæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„å±žæ€§å­˜å‚¨ç­–ç•¥ç±»ä¼¼ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829#import "Person+Test.h"#import &lt;objc/runtime.h&gt;@implementation Person (Test)- (void)setName:(NSString *)name&#123; objc_setAssociatedObject(self, @selector(name), name, OBJC_ASSOCIATION_COPY_NONATOMIC);&#125;- (NSString *)name&#123; // éšå¼å‚æ•° // _cmd == @selector(name) return objc_getAssociatedObject(self, _cmd);&#125;- (void)setWeight:(int)weight&#123; objc_setAssociatedObject(self, @selector(weight), @(weight), OBJC_ASSOCIATION_RETAIN_NONATOMIC);&#125;- (int)weight&#123; // _cmd == @selector(weight) return [objc_getAssociatedObject(self, _cmd) intValue];&#125;@end è¿™æ ·æˆ‘ä»¬å°±èƒ½æˆåŠŸçš„å°†nameã€weightå…³è”åˆ°Personç±»æ‰€åˆ›å»ºçš„å¯¹è±¡ä¸­ã€‚ ä»¥ä¸Šå°±æ˜¯å…³è”å¯¹è±¡çš„ä½¿ç”¨æ–¹å¼ï¼Œè¿‡ç¨‹å¹¶ä¸å¤æ‚ã€‚ä½†æ˜¯æˆ‘ä»¬ä¹Ÿè®¸ä¸ç”˜æ­¢æ­¥äºŽæ­¤ï¼Œä½ å¯èƒ½è¿˜ä¼šæƒ³ï¼ŒRuntimeåº•å±‚åˆ°åº•åšäº†äº›ä»€ä¹ˆï¼Ÿå…¶æœ¬è´¨æ˜¯ä¸æ˜¯å’Œåˆ†ç±»å…¶ä»–å…ƒç´ ä¸€æ ·ï¼Œè¢«æ·»åŠ åˆ°äº†ç±»å±žæ€§åˆ—è¡¨é‡Œé¢ï¼Ÿ å…³è”å¯¹è±¡çš„å†…éƒ¨å®žçŽ°æˆ‘ä»¬æ¥åˆ°runtimeæºç å®žçŽ°éƒ¨åˆ†ã€‚é¦–å…ˆæ‰¾åˆ°objc_setAssociatedObjectå‡½æ•°ï¼Œå…¶å†…éƒ¨è°ƒç”¨çš„æ˜¯_object_set_associative_referenceå‡½æ•°ã€‚æˆ‘ä»¬ç‚¹å‡»æŸ¥çœ‹_object_set_associative_referenceå®žçŽ°çš„è¯¦æƒ…éƒ¨åˆ†ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344void _object_set_associative_reference(id object, void *key, id value, uintptr_t policy) &#123; // retain the new value (if any) outside the lock. ObjcAssociation old_association(0, nil); id new_value = value ? acquireValue(value, policy) : nil; &#123; AssociationsManager manager; AssociationsHashMap &amp;associations(manager.associations()); disguised_ptr_t disguised_object = DISGUISE(object); if (new_value) &#123; // break any existing association. AssociationsHashMap::iterator i = associations.find(disguised_object); if (i != associations.end()) &#123; // secondary table exists ObjectAssociationMap *refs = i-&gt;second; ObjectAssociationMap::iterator j = refs-&gt;find(key); if (j != refs-&gt;end()) &#123; old_association = j-&gt;second; j-&gt;second = ObjcAssociation(policy, new_value); &#125; else &#123; (*refs)[key] = ObjcAssociation(policy, new_value); &#125; &#125; else &#123; // create the new association (first time). ObjectAssociationMap *refs = new ObjectAssociationMap; associations[disguised_object] = refs; (*refs)[key] = ObjcAssociation(policy, new_value); object-&gt;setHasAssociatedObjects(); &#125; &#125; else &#123; // setting the association to nil breaks the association. AssociationsHashMap::iterator i = associations.find(disguised_object); if (i != associations.end()) &#123; ObjectAssociationMap *refs = i-&gt;second; ObjectAssociationMap::iterator j = refs-&gt;find(key); if (j != refs-&gt;end()) &#123; old_association = j-&gt;second; refs-&gt;erase(j); &#125; &#125; &#125; &#125; // release the old value (outside of the lock). if (old_association.hasValue()) ReleaseValue()(old_association);&#125; AssociationsManagerè¿™æ˜¯ä¸€ä¸ªå…¨å±€çš„ç®¡ç†è€…å¯¹è±¡ï¼Œå…¶å†…éƒ¨ç®¡ç†ç€ä¸€ç»„AssociationsHashMap 12345678910111213class AssociationsManager &#123; // associative references: object pointer -&gt; PtrPtrHashMap. static AssociationsHashMap *_map;public: AssociationsManager() &#123; AssociationsManagerLock.lock(); &#125; ~AssociationsManager() &#123; AssociationsManagerLock.unlock(); &#125; AssociationsHashMap &amp;associations() &#123; if (_map == NULL) _map = new AssociationsHashMap(); return *_map; &#125;&#125;; AssociationsHashMapæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹AssociationsHashMapå†…éƒ¨çš„æºç ã€‚ 12345class AssociationsHashMap : public unordered_map&lt;disguised_ptr_t, ObjectAssociationMap *, DisguisedPointerHash, DisguisedPointerEqual, AssociationsHashMapAllocator&gt; &#123; public: void *operator new(size_t n) &#123; return ::malloc(n); &#125; void operator delete(void *ptr) &#123; ::free(ptr); &#125;&#125;; å…¶å†…éƒ¨ç»´æŠ¤ç€ä¸€ç»„ObjectAssociationMap ObjectAssociationMap12345class ObjectAssociationMap : public std::map&lt;void *, ObjcAssociation, ObjectPointerLess, ObjectAssociationMapAllocator&gt; &#123; public: void *operator new(size_t n) &#123; return ::malloc(n); &#125; void operator delete(void *ptr) &#123; ::free(ptr); &#125;&#125;; å¯ä»¥çœ‹å‡ºObjectAssociationMapä¸­ç»´æŠ¤äº†ä¸€ç»„ObjcAssociation,ç»§ç»­æ·±å…¥æºç ã€‚ ObjcAssociation123456789101112class ObjcAssociation &#123; uintptr_t _policy; id _value;public: ObjcAssociation(uintptr_t policy, id value) : _policy(policy), _value(value) &#123;&#125; ObjcAssociation() : _policy(0), _value(nil) &#123;&#125; uintptr_t policy() const &#123; return _policy; &#125; id value() const &#123; return _value; &#125; bool hasValue() &#123; return _value != nil; &#125;&#125;; æˆ‘ä»¬å‘çŽ°ObjcAssociationå­˜å‚¨ç€_policyã€valueï¼Œè€Œè¿™ä¸¤ä¸ªå€¼æˆ‘ä»¬å¯ä»¥å‘çŽ°æ­£æ˜¯æˆ‘ä»¬è°ƒç”¨objc_setAssociatedObjectå‡½æ•°ä¼ å…¥çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨è°ƒç”¨objc_setAssociatedObjectå‡½æ•°ä¸­ä¼ å…¥çš„valueå’Œpolicyè¿™ä¸¤ä¸ªå€¼æœ€ç»ˆæ˜¯å­˜å‚¨åœ¨ObjcAssociationä¸­çš„ã€‚ ä»¥ä¸Šå››è€…çš„å…³ç³»å¯ä»¥ç”¨ä»¥ä¸‹è¿™å¹…å›¾æ¥æ¦‚æ‹¬ï¼š æ‰€ä»¥ï¼Œå…³è”å¯¹è±¡å¹¶ä¸æ˜¯å­˜å‚¨åœ¨è¢«å…³è”å¯¹è±¡æœ¬èº«å†…å­˜ä¸­ï¼Œè€Œæ˜¯å­˜å‚¨åœ¨å…¨å±€çš„ç»Ÿä¸€çš„ä¸€ä¸ªAssociationsManagerä¸­ï¼Œå¦‚æžœè®¾ç½®å…³è”å¯¹è±¡ä¸ºnilï¼Œå°±ç›¸å½“äºŽæ˜¯ç§»é™¤å…³è”å¯¹è±¡ã€‚]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>å…³è”å¯¹è±¡</tag>
        <tag>RunTime</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[KVOå’ŒKVCåº•å±‚åŽŸç†]]></title>
    <url>%2F2018%2F07%2F23%2FKVC%26KVO%2F</url>
    <content type="text"><![CDATA[KVOå’ŒKVCåº•å±‚åŽŸç†æˆ‘ä»¬çŸ¥é“ï¼ŒObjCæœ‰å¾ˆå¤šç±»ä¼¼äºŽPythonçš„åŠ¨æ€ç‰¹æ€§ã€‚ä¾‹å¦‚åŠ¨æ€ç±»åž‹ã€åŠ¨æ€åŠ è½½ã€åŠ¨æ€ç»‘å®šç­‰ã€‚ä¾èµ–äºŽè¿™ç§åŠ¨æ€ç‰¹æ€§ï¼Œæˆ‘ä»¬å¾—ä»¥å®žçŽ°Objcä¸­è®¸å¤šæˆ‘ä»¬ç†ŸçŸ¥çš„å®žç”¨åŠŸèƒ½ï¼Œæ¯”å¦‚é”®å€¼ç›‘å¬ï¼ˆKVOï¼‰ä¸Žé”®å€¼ç¼–ç ï¼ˆKVCï¼‰ã€‚ é”®å€¼ç›‘å¬KVOåŸºç¡€å›žé¡¾KVOçš„å…¨ç§°æ˜¯Key-Value Observingï¼Œä¿—ç§°â€œé”®å€¼ç›‘å¬â€ï¼Œå¯ä»¥ç”¨äºŽç›‘å¬æŸä¸ªå¯¹è±¡å±žæ€§å€¼çš„æ”¹å˜ã€‚ åœ¨ObjCä¸­ä½¿ç”¨KVOæ“ä½œå¸¸ç”¨çš„æ–¹æ³•å¦‚ä¸‹ï¼š æ³¨å†ŒæŒ‡å®šKeyè·¯å¾„çš„ç›‘å¬å™¨ï¼š addObserver: forKeyPath: options: context: åˆ é™¤æŒ‡å®šKeyè·¯å¾„çš„ç›‘å¬å™¨ï¼š removeObserver: forKeyPathã€removeObserver: forKeyPath: context: å›žè°ƒç›‘å¬ï¼š observeValueForKeyPath: ofObject: change: context: KVOçš„ä½¿ç”¨æ­¥éª¤ä¹Ÿæ¯”è¾ƒç®€å•ï¼š é€šè¿‡addObserver: forKeyPath: options: context:ä¸ºè¢«ç›‘å¬å¯¹è±¡ï¼ˆå®ƒé€šå¸¸æ˜¯æ•°æ®æ¨¡åž‹ï¼‰æ³¨å†Œç›‘å¬å™¨ é‡å†™ç›‘å¬å™¨çš„observeValueForKeyPath: ofObject: change: context:æ–¹æ³• ç¤ºä¾‹ä»£ç ï¼š 1234567891011121314151617181920212223242526- (void)viewDidLoad &#123; [super viewDidLoad]; Person *p1 = [[Person alloc] init]; Person *p2 = [[Person alloc] init]; p1.age = 1; p1.age = 2; p2.age = 2; // self ç›‘å¬ p1çš„ ageå±žæ€§ NSKeyValueObservingOptions options = NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld; [p1 addObserver:self forKeyPath:@"age" options:options context:nil]; p1.age = 10; [p1 removeObserver:self forKeyPath:@"age"];&#125;- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context&#123; NSLog(@"ç›‘å¬åˆ°%@çš„%@æ”¹å˜äº†%@", object, keyPath,change);&#125;// æ‰“å°å†…å®¹ç›‘å¬åˆ°&lt;Person: 0x604000205460&gt;çš„ageæ”¹å˜äº†&#123; kind = 1; new = 10; old = 2;&#125; å†…éƒ¨å®žçŽ°åˆ†æžä¸Šè¿°ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨æ·»åŠ ç›‘å¬ä¹‹åŽï¼Œageå±žæ€§çš„å€¼åœ¨å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå°±ä¼šé€šçŸ¥åˆ°ç›‘å¬è€…ï¼Œæ‰§è¡Œç›‘å¬è€…çš„observeValueForKeyPathæ–¹æ³•ã€‚ é‚£ä¹ˆï¼Œè¢«ç›‘å¬è€…å†…éƒ¨åšäº†ä»€ä¹ˆæ“ä½œæ¥å®žçŽ°è¿™æ ·ç¥žå¥‡çš„åŠŸèƒ½ï¼Ÿ é¦–å…ˆæˆ‘ä»¬æƒ³åˆ°çš„å¯èƒ½å°±æ˜¯é‡å†™äº†Observerå†…éƒ¨å±žæ€§çš„setæ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥æ¥åˆ°ä¸Šè¿°Personç±»ä¸­é‡å†™ageçš„setæ–¹æ³•ï¼Œè§‚å¯Ÿæ˜¯å¦æ˜¯KVOåœ¨setæ–¹æ³•å†…éƒ¨åšäº†ä¸€äº›æ“ä½œæ¥é€šçŸ¥ç›‘å¬è€…ã€‚é€šè¿‡ä¸Šä¸€èŠ‚çš„OCå¯¹è±¡æœ¬è´¨çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹è±¡åœ¨è°ƒç”¨å®žä¾‹æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šé€šè¿‡isaæŒ‡é’ˆæ‰¾åˆ°å…¶ç±»å¯¹è±¡ï¼Œåœ¨ç±»å¯¹è±¡å†…éƒ¨è°ƒç”¨æ–¹æ³•çš„å®žçŽ°ã€‚ æŒ‰ç…§ä¸Šé¢çš„åˆ†æžï¼Œp1å’Œp2å¯¹è±¡åº”è¯¥éƒ½æ˜¯ç»Ÿä¸€è°ƒç”¨äº†å­˜æ”¾åœ¨Personç±»å¯¹è±¡å†…éƒ¨çš„setæ–¹æ³•æ‰åˆç†ã€‚ ä½†æ˜¯æˆ‘ä»¬å‘çŽ°å³ä½¿é‡å†™äº†setæ–¹æ³•ï¼Œp1å¯¹è±¡å’Œp2å¯¹è±¡è°ƒç”¨åŒæ ·çš„setæ–¹æ³•ï¼Œç»“æžœæ˜¯p1é™¤äº†è°ƒç”¨setæ–¹æ³•ä¹‹å¤–è¿˜ä¼šå¦å¤–æ‰§è¡Œç›‘å¬å™¨çš„observeValueForKeyPathæ–¹æ³•ã€‚ KVOçš„æœ¬è´¨è¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ã€‚KVOåœ¨è¿è¡Œæ—¶èŽ·å–å¯¹p1å¯¹è±¡åšäº†ä¸€äº›æ”¹å˜ã€‚ç›¸å½“äºŽåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹p1å¯¹è±¡åšäº†ä¸€äº›å˜åŒ–ï¼Œä½¿å¾—p1å¯¹è±¡åœ¨è°ƒç”¨setAge:æ–¹æ³•çš„æ—¶å€™å¯èƒ½åšäº†ä¸€äº›é¢å¤–çš„æ“ä½œï¼Œæ‰€ä»¥é—®é¢˜å‡ºåœ¨å¯¹è±¡èº«ä¸Šï¼Œä¸¤ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­è‚¯å®šä¸ä¸€æ ·ï¼Œä¸¤ä¸ªå¯¹è±¡å¯èƒ½æœ¬è´¨ä¸Šå¹¶ä¸ä¸€æ ·ã€‚æŽ¥ä¸‹æ¥æ¥æŽ¢ç´¢KVOå†…éƒ¨æ˜¯æ€Žä¹ˆå®žçŽ°çš„ã€‚ é¦–å…ˆæˆ‘ä»¬å¯¹ä¸Šè¿°ä»£ç ä¸­æ·»åŠ ç›‘å¬çš„åœ°æ–¹æ‰“æ–­ç‚¹ï¼Œçœ‹è§‚å¯Ÿä¸€ä¸‹ï¼ŒaddObserveræ–¹æ³•å¯¹p1å¯¹è±¡åšäº†ä»€ä¹ˆå¤„ç†ï¼Ÿä¹Ÿå°±æ˜¯è¯´p1å¯¹è±¡åœ¨ç»è¿‡addObserveræ–¹æ³•ä¹‹åŽå‘ç”Ÿäº†ä»€ä¹ˆæ”¹å˜ï¼Œæˆ‘ä»¬é€šè¿‡æ‰“å°isaæŒ‡é’ˆå¦‚ä¸‹å›¾æ‰€ç¤º é€šè¿‡ä¸Šå›¾æˆ‘ä»¬å‘çŽ°ï¼Œp1å¯¹è±¡æ‰§è¡Œè¿‡addObserveræ“ä½œä¹‹åŽï¼Œp1å¯¹è±¡çš„isaæŒ‡é’ˆç”±ä¹‹å‰çš„æŒ‡å‘ç±»å¯¹è±¡Personå˜ä¸ºæŒ‡å‘NSKVONotifyin_Personç±»å¯¹è±¡ï¼Œè€Œp2å¯¹è±¡æ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸€æ—¦p1å¯¹è±¡æ·»åŠ äº†KVOç›‘å¬ä»¥åŽï¼Œå…¶isaæŒ‡é’ˆå°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› æ­¤setæ–¹æ³•çš„æ‰§è¡Œæ•ˆæžœå°±ä¸ä¸€æ ·äº†ã€‚ é‚£ä¹ˆæˆ‘ä»¬å…ˆæ¥è§‚å¯Ÿp2å¯¹è±¡åœ¨å†…å®¹ä¸­æ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œç„¶åŽå¯¹æ¯”p2æ¥è§‚å¯Ÿp1ã€‚é¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œp2åœ¨è°ƒç”¨setageæ–¹æ³•çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šé€šè¿‡p2å¯¹è±¡ä¸­çš„isaæŒ‡é’ˆæ‰¾åˆ°Personç±»å¯¹è±¡ï¼Œç„¶åŽåœ¨ç±»å¯¹è±¡ä¸­æ‰¾åˆ°setageæ–¹æ³•ã€‚ç„¶åŽæ‰¾åˆ°æ–¹æ³•å¯¹åº”çš„å®žçŽ°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º ä½†æ˜¯åˆšæ‰æˆ‘ä»¬å‘çŽ°p1å¯¹è±¡çš„isaæŒ‡é’ˆåœ¨ç»è¿‡KVOç›‘å¬ä¹‹åŽå·²ç»æŒ‡å‘äº†NSKVONotifyin_Personç±»å¯¹è±¡ï¼ŒNSKVONotifyin_Personå…¶å®žæ˜¯Personçš„å­ç±»ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´å…¶superclassæŒ‡é’ˆæ˜¯æŒ‡å‘Personç±»å¯¹è±¡çš„ï¼ŒNSKVONotifyin_Personæ˜¯runtimeåœ¨è¿è¡Œæ—¶ç”Ÿæˆçš„ã€‚é‚£ä¹ˆp1å¯¹è±¡åœ¨è°ƒç”¨setageæ–¹æ³•çš„æ—¶å€™ï¼Œè‚¯å®šä¼šæ ¹æ®p1çš„isaæ‰¾åˆ°NSKVONotifyin_Personï¼Œåœ¨NSKVONotifyin_Personä¸­æ‰¾setAge:çš„æ–¹æ³•åŠå®žçŽ°ã€‚ NSKVONotifyin_Personä¸­çš„setAge:æ–¹æ³•ä¸­å…¶å®žè°ƒç”¨äº† Fundationæ¡†æž¶ä¸­Cè¯­è¨€å‡½æ•° _NSsetIntValueAndNotifyï¼Œ_NSsetIntValueAndNotifyå†…éƒ¨é¦–å…ˆè°ƒç”¨willChangeValueForKeyå°†è¦æ”¹å˜æ–¹æ³•ï¼Œä¹‹åŽè°ƒç”¨çˆ¶ç±»çš„setAgeæ–¹æ³•å¯¹æˆå‘˜å˜é‡èµ‹å€¼ï¼Œæœ€åŽè°ƒç”¨didChangeValueForKeyå·²ç»æ”¹å˜æ–¹æ³•ã€‚didChangeValueForKeyä¸­ä¼šè°ƒç”¨ç›‘å¬å™¨çš„ç›‘å¬æ–¹æ³•ï¼Œæœ€ç»ˆæ¥åˆ°ç›‘å¬è€…çš„observeValueForKeyPathæ–¹æ³•ä¸­ã€‚ å¦ä¸€ç§éªŒè¯æ€è·¯å…¶å®žï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰“å°p1å’Œp2æ‰€è°ƒç”¨çš„setAgeï¼šæ–¹æ³•åœ°å€æ¥ä¾§é¢éªŒè¯æˆ‘ä»¬çš„ä¸Šè¿°ç»“è®ºã€‚ 1234567// é€šè¿‡methodForSelectoræ‰¾åˆ°æ–¹æ³•å®žçŽ°çš„åœ°å€NSLog(@"æ·»åŠ KVOç›‘å¬ä¹‹å‰ - p1 = %p, p2 = %p", [p1 methodForSelector: @selector(setAge:)],[p2 methodForSelector: @selector(setAge:)]); NSKeyValueObservingOptions options = NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld;[p1 addObserver:self forKeyPath:@"age" options:options context:nil];NSLog(@"æ·»åŠ KVOç›‘å¬ä¹‹åŽ - p1 = %p, p2 = %p", [p1 methodForSelector: @selector(setAge:)],[p2 methodForSelector: @selector(setAge:)]); æ‰“å°ç»“æžœå¦‚ä¸‹ æˆ‘ä»¬å‘çŽ°åœ¨æ·»åŠ KVOç›‘å¬ä¹‹å‰ï¼Œp1å’Œp2çš„setAgeæ–¹æ³•å®žçŽ°çš„åœ°å€ç›¸åŒï¼Œè€Œç»è¿‡KVOç›‘å¬ä¹‹åŽï¼Œp1çš„setAgeæ–¹æ³•å®žçŽ°çš„åœ°å€å‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ‘ä»¬é€šè¿‡æ‰“å°æ–¹æ³•å®žçŽ°æ¥çœ‹ä¸€ä¸‹å‰åŽçš„å˜åŒ–å‘çŽ°ï¼Œç¡®å®žå¦‚æˆ‘ä»¬ä¸Šé¢æ‰€è®²çš„ä¸€æ ·ï¼Œp1çš„setAgeæ–¹æ³•çš„å®žçŽ°ç”±Personç±»æ–¹æ³•ä¸­çš„setAgeæ–¹æ³•è½¬æ¢ä¸ºäº†Cè¯­è¨€çš„Foundationæ¡†æž¶çš„_NSsetIntValueAndNotifyå‡½æ•°ã€‚ Foundationæ¡†æž¶ä¸­ä¼šæ ¹æ®å±žæ€§çš„ç±»åž‹ï¼Œè°ƒç”¨ä¸åŒçš„æ–¹æ³•ã€‚ä¾‹å¦‚æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„intç±»åž‹çš„ageå±žæ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹åˆ°Foundationæ¡†æž¶ä¸­è°ƒç”¨çš„_NSsetIntValueAndNotifyå‡½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬æŠŠageçš„å±žæ€§ç±»åž‹å˜ä¸ºdoubleé‡æ–°æ‰“å°ä¸€é æˆ‘ä»¬å‘çŽ°è°ƒç”¨çš„å‡½æ•°å˜ä¸ºäº†_NSSetDoubleValueAndNotifyï¼Œé‚£ä¹ˆè¿™è¯´æ˜ŽFoundationæ¡†æž¶ä¸­æœ‰è®¸å¤šæ­¤ç±»åž‹çš„å‡½æ•°ï¼Œé€šè¿‡å±žæ€§çš„ä¸åŒç±»åž‹è°ƒç”¨ä¸åŒçš„å‡½æ•°ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŽ¨æµ‹Foundationæ¡†æž¶ä¸­è¿˜æœ‰å¾ˆå¤šä¾‹å¦‚ 1_NSSetBoolValueAndNotifyã€_NSSetCharValueAndNotifyã€_NSSetFloatValueAndNotifyã€_NSSetLongValueAndNotify ç­‰ç­‰å‡½æ•°ã€‚ æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°Foundationæ¡†æž¶æ–‡ä»¶ï¼Œé€šè¿‡å‘½ä»¤è¡ŒæŸ¥è¯¢å…³é”®å­—æ‰¾åˆ°ç›¸å…³å‡½æ•° åŠ¨æ€ç”Ÿæˆç±»NSKVONotifyin_Personçš„å†…éƒ¨ç»„æˆé¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼ŒNSKVONotifyin_Personä½œä¸ºPersonçš„å­ç±»ï¼Œå…¶superclassæŒ‡é’ˆæŒ‡å‘Personç±»ï¼Œå¹¶ä¸”NSKVONotifyin_Personå†…éƒ¨ä¸€å®šå¯¹setAgeæ–¹æ³•åšäº†å•ç‹¬çš„å®žçŽ°ï¼Œé‚£ä¹ˆNSKVONotifyin_PersonåŒPersonç±»çš„å·®åˆ«å¯èƒ½å°±åœ¨äºŽå…¶å†…å­˜å‚¨çš„å¯¹è±¡æ–¹æ³•åŠå®žçŽ°ä¸åŒã€‚ æˆ‘ä»¬é€šè¿‡runtimeåˆ†åˆ«æ‰“å°Personç±»å¯¹è±¡å’ŒNSKVONotifyin_Personç±»å¯¹è±¡å†…å­˜å‚¨çš„å¯¹è±¡æ–¹æ³• 123456789101112131415161718192021222324252627282930313233343536- (void)viewDidLoad &#123; [super viewDidLoad]; Person *p1 = [[Person alloc] init]; p1.age = 1.0; Person *p2 = [[Person alloc] init]; p1.age = 2.0; // self ç›‘å¬ p1çš„ ageå±žæ€§ NSKeyValueObservingOptions options = NSKeyValueObservingOptionNew | NSKeyValueObservingOptionOld; [p1 addObserver:self forKeyPath:@"age" options:options context:nil]; [self printMethods: object_getClass(p2)]; [self printMethods: object_getClass(p1)]; [p1 removeObserver:self forKeyPath:@"age"];&#125;- (void) printMethods:(Class)cls&#123; unsigned int count ; Method *methods = class_copyMethodList(cls, &amp;count); NSMutableString *methodNames = [NSMutableString string]; [methodNames appendFormat:@"%@ - ", cls]; for (int i = 0 ; i &lt; count; i++) &#123; Method method = methods[i]; NSString *methodName = NSStringFromSelector(method_getName(method)); [methodNames appendString: methodName]; [methodNames appendString:@" "]; &#125; NSLog(@"%@",methodNames); free(methods);&#125; æ‰“å°ç»“æžœä¸ºï¼š é€šè¿‡ä¸Šè¿°ä»£ç æˆ‘ä»¬å‘çŽ°NSKVONotifyin_Personä¸­æœ‰4ä¸ªå¯¹è±¡æ–¹æ³•ã€‚åˆ†åˆ«ä¸ºsetAge: class dealloc _isKVOAï¼Œé‚£ä¹ˆè‡³æ­¤æˆ‘ä»¬å¯ä»¥ç”»å‡ºNSKVONotifyin_Personçš„å†…å­˜ç»“æž„ä»¥åŠæ–¹æ³•è°ƒç”¨é¡ºåºã€‚ è¿™é‡ŒNSKVONotifyin_Personé‡å†™classæ–¹æ³•æ˜¯ä¸ºäº†éšè—NSKVONotifyin_Personã€‚ä¸è¢«å¤–ç•Œæ‰€çœ‹åˆ°ã€‚æˆ‘ä»¬åœ¨p1æ·»åŠ è¿‡KVOç›‘å¬ä¹‹åŽï¼Œåˆ†åˆ«æ‰“å°p1å’Œp2å¯¹è±¡çš„classå¯ä»¥å‘çŽ°ä»–ä»¬éƒ½è¿”å›žPersonã€‚ 12NSLog(@"%@,%@",[p1 class],[p2 class]);// æ‰“å°ç»“æžœ Person,Person å¦‚æžœNSKVONotifyin_Personä¸é‡å†™classæ–¹æ³•ï¼Œé‚£ä¹ˆå½“å¯¹è±¡è¦è°ƒç”¨classå¯¹è±¡æ–¹æ³•çš„æ—¶å€™å°±ä¼šä¸€ç›´å‘ä¸Šæ‰¾æ¥åˆ°NSObjectï¼Œè€ŒNSObjectçš„Classçš„å®žçŽ°å¤§è‡´ä¸ºè¿”å›žè‡ªå·±isaæŒ‡å‘çš„ç±»ï¼Œè¿”å›žp1çš„isaæŒ‡å‘çš„ç±»ã€‚é‚£ä¹ˆæ‰“å°å‡ºæ¥çš„ç±»å°±æ˜¯NSKVONotifyin_Personï¼Œä½†æ˜¯appleä¸å¸Œæœ›å°†NSKVONotifyin_Personç±»æš´éœ²å‡ºæ¥ï¼Œå¹¶ä¸”ä¸å¸Œæœ›æˆ‘ä»¬çŸ¥é“NSKVONotifyin_Personå†…éƒ¨å®žçŽ°ï¼Œæ‰€ä»¥åœ¨å†…éƒ¨é‡å†™äº†classç±»ï¼Œç›´æŽ¥è¿”å›žPersonç±»ï¼Œæ‰€ä»¥å¤–ç•Œåœ¨è°ƒç”¨p1çš„classå¯¹è±¡æ–¹æ³•æ—¶ï¼Œæ˜¯Personç±»ã€‚è¿™æ ·p1ç»™å¤–ç•Œçš„æ„Ÿè§‰p1è¿˜æ˜¯Personç±»ï¼Œå¹¶ä¸çŸ¥é“NSKVONotifyin_Personå­ç±»çš„å­˜åœ¨ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŒœæµ‹NSKVONotifyin_Personå†…é‡å†™çš„classå†…éƒ¨å®žçŽ°å¤§è‡´ä¸º 1234- (Class) class &#123; // å¾—åˆ°ç±»å¯¹è±¡ï¼Œåœ¨æ‰¾åˆ°ç±»å¯¹è±¡çˆ¶ç±» return class_getSuperclass(object_getClass(self));&#125; ##é”®å€¼ç¼–ç KVC åŸºæœ¬ç”¨æ³•KVCçš„æ“ä½œæ–¹æ³•ç”±NSKeyValueCodingåè®®æä¾›ï¼Œè€ŒNSObjectå°±å®žçŽ°äº†è¿™ä¸ªåè®®ï¼Œä¹Ÿå°±æ˜¯è¯´ObjCä¸­å‡ ä¹Žæ‰€æœ‰çš„å¯¹è±¡éƒ½æ”¯æŒKVCæ“ä½œï¼Œå¸¸ç”¨çš„KVCæ“ä½œæ–¹æ³•å¦‚ä¸‹ï¼š åŠ¨æ€è®¾ç½®ï¼š setValue:å±žæ€§å€¼ forKey:å±žæ€§åï¼ˆç”¨äºŽç®€å•è·¯å¾„ï¼‰ã€setValue:å±žæ€§å€¼ forKeyPath:å±žæ€§è·¯å¾„ï¼ˆç”¨äºŽå¤åˆè·¯å¾„ï¼Œä¾‹å¦‚Personæœ‰ä¸€ä¸ªAccountç±»åž‹çš„å±žæ€§ï¼Œé‚£ä¹ˆperson.accountå°±æ˜¯ä¸€ä¸ªå¤åˆå±žæ€§ï¼‰ åŠ¨æ€è¯»å–ï¼š valueForKey:å±žæ€§å ã€valueForKeyPath:å±žæ€§åï¼ˆç”¨äºŽå¤åˆè·¯å¾„ï¼‰ åº•å±‚è°ƒç”¨é¡ºåºsetValue:forKey: é¦–å…ˆè°ƒç”¨setKey:æ–¹æ³•å¯¹å¯¹åº”çš„keyè¿›è¡Œè®¾ç½®ï¼Œå¦‚æžœæ²¡æœ‰æ‰¾åˆ°setKeyæ–¹æ³•ï¼Œåˆ™æŸ¥æ‰¾ä»¥ä¸‹åˆ’çº¿å¼€å¤´çš„æ–¹æ³•_setKey å¦‚æžœç¬¬ä¸€æ­¥çš„ä¸¤ä¸ªæ–¹æ³•å®žçŽ°éƒ½æ²¡æ‰¾åˆ°ï¼Œåˆ™ä¼šè°ƒç”¨ç±»æ–¹æ³•accessInstanceVariablesDirectlyè¯¢é—®èƒ½å¦ç›´æŽ¥è®¿é—®æˆå‘˜å˜é‡ï¼Œç³»ç»Ÿé»˜è®¤è¿”å›žYESã€‚ å¦‚æžœç¬¬äºŒæ­¥çš„æ–¹æ³•ä¸­è¿”å›žå€¼ä¸ºYESï¼Œåˆ™æˆå‘˜å˜é‡ä¼šæŒ‰ç…§ä»¥ä¸‹é¡ºåºè¿›è¡ŒæŸ¥æ‰¾ï¼Œ_keyã€_isKeyã€keyã€isKeyå¦‚æžœæ‰¾åˆ°äº†ç›´æŽ¥è¿›è¡Œèµ‹å€¼ã€‚ å¦‚æžœç¬¬äºŒæ­¥è¿”å›žä¸ºNO,è°ƒç”¨setValue:forUndefinedKey:å¹¶æŠ›å‡ºå¼‚å¸¸NSUnknownKeyException valueForKey: ç¬¬ä¸€æ­¥æ˜¯æŒ‰ç…§getKeyã€keyã€ isKeyã€_keyçš„æ–¹æ³•è°ƒç”¨é¡ºåºåŽ»æŸ¥æ‰¾ï¼Œå¦‚æžœæ‰¾åˆ°ç›´æŽ¥è°ƒç”¨å¯¹åº”çš„æ–¹æ³• æŽ¥ä¸‹æ¥è°ƒç”¨accessInstanceVariablesDirectlyè¯¢é—®æ˜¯å¦èƒ½ç›´æŽ¥è®¿é—®æˆå‘˜å˜é‡ï¼Œç³»ç»Ÿé»˜è®¤è¿”å›žçš„æ˜¯YES å¦‚æžœè‡ªå·±å®žçŽ°äº†ç¬¬äºŒæ­¥çš„æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›žNOï¼Œåˆ™ä¼šè°ƒç”¨valueForUndefinedKey:å¹¶æŠ›å‡ºå¼‚å¸¸NSUnknownKeyExceptionã€‚å¦åˆ™æ‰§è¡Œç¬¬å››æ­¥ æŒ‰ç…§_keyã€_isKeyã€keyã€isKeyé¡ºåºæŸ¥æ‰¾æˆå‘˜å˜é‡,å¦‚æžœæ‰¾åˆ°äº†ï¼Œç›´æŽ¥å–å€¼ã€‚å¦åˆ™ä¼šè°ƒç”¨valueForUndefinedKey:å¹¶æŠ›å‡ºå¼‚å¸¸NSUnknownKeyExceptionã€‚ æ€»ç»“KVOçš„æœ¬è´¨æ˜¯åˆ©ç”¨RuntimeAPIåŠ¨æ€ç”Ÿæˆä¸€ä¸ªå­ç±»ï¼Œå¹¶ä¸”è®©instanceå¯¹è±¡çš„isaæŒ‡å‘è¿™ä¸ªå…¨æ–°çš„å­ç±»ã€‚å½“ä¿®æ”¹instanceå¯¹è±¡çš„å±žæ€§æ—¶ï¼Œä¼šè°ƒç”¨Foundationçš„_NSSetXXXValueAndNotifyå‡½æ•°ã€‚æ­¤å‡½æ•°å†…éƒ¨ä¼šè°ƒç”¨å¦‚ä¸‹çš„æ–¹æ³• willChangeValueForKey: çˆ¶ç±»åŽŸæ¥çš„setter didChangeValueForKeyï¼š æœ€åŽä¸€æ­¥å†…éƒ¨ä¼šè§¦å‘ç›‘å¬å™¨ï¼ˆOberserï¼‰çš„ç›‘å¬æ–¹æ³•( observeValueForKeyPath:ofObject:change:context:ï¼‰ã€‚ æ‰€ä»¥è¿™è·¯æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼Œå¦‚æžœæƒ³è¦æ‰‹åŠ¨å‡ºå‘KVOï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨åŽ»è°ƒç”¨willChangeValueForKey:å’ŒdidChangeValueForKey:ä¸¤ä¸ªæ–¹æ³•å³å¯ã€‚å› ä¸ºKVOåº•å±‚æ˜¯é€šè¿‡è°ƒç”¨setæ–¹æ³•å®žçŽ°ï¼Œæ‰€ä»¥å¦‚æžœç›´æŽ¥ä¿®æ”¹æˆå‘˜å˜é‡çš„è¯ï¼Œå¹¶ä¸ä¼šè§¦å‘KVOæœºåˆ¶ã€‚ æœ€åŽï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œå¦‚æžœé€šè¿‡KVCçš„æ–¹å¼è¿›è¡Œèµ‹å€¼çš„è¯ï¼Œä¼šè§¦å‘KVOã€‚æ ¹æ®ä¸Šä¸€èŠ‚å¯¹KVCæœºåˆ¶çš„åˆ†æžæˆ‘ä»¬å¾—çŸ¥ï¼Œå­˜åœ¨æŸäº›æ—¶åˆ»KVCä¼šç›´æŽ¥è®¿é—®æˆå‘˜å˜é‡è€Œä¸æ˜¯è°ƒç”¨æˆå‘˜å˜é‡çš„setæ–¹æ³•ã€‚ä½†æ˜¯è¿™ç§æƒ…å†µä¸‹KVOä¾ç„¶æœ‰æ•ˆçš„åŽŸå› æˆ‘ä»¬ä¸éš¾æƒ³è±¡ï¼Œè‚¯å®šæ˜¯åœ¨KVCç›´æŽ¥è®¿é—®æˆå‘˜å˜é‡çš„è¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨äº†willChangeValueForKey:å’ŒdidChangeValueForKeyï¼šæ‰€è‡´ã€‚]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>KVC</tag>
        <tag>KVO</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ†ç±»çš„å®žçŽ°åŽŸç†]]></title>
    <url>%2F2018%2F07%2F21%2F%E5%88%86%E7%B1%BB%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[åˆ†ç±»çš„å®žçŽ°åŽŸç†äº†è§£åˆ†ç±»(Category)çš„ä½¿ç”¨åœºæ™¯å½“æˆ‘ä»¬ä¸æ”¹å˜åŽŸæœ‰ä»£ç ä¸ºä¸€ä¸ªç±»æ‰©å±•å…¶ä»–åŠŸèƒ½æ—¶æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç»§æ‰¿è¿™ä¸ªç±»è¿›è¡Œå®žçŽ°ï¼Œä½†æ˜¯è¿™æ ·ä¸€æ¥ä½¿ç”¨æ—¶å°±å¿…é¡»å®šä¹‰æˆæ–°å®žçŽ°çš„å­ç±»æ‰èƒ½æ‹¥æœ‰æ‰©å±•çš„æ–°åŠŸèƒ½ã€‚å¦‚ä½•åœ¨ä¸æ”¹å˜åŽŸæœ‰ç±»çš„æƒ…å†µä¸‹æ‰©å±•æ–°åŠŸèƒ½åˆå¯ä»¥åœ¨ä½¿ç”¨æ—¶ä¸å¿…å®šä¹‰æ–°ç±»åž‹å‘¢ï¼Ÿè¿™å°±æ˜¯åˆ†ç±»Categoryã€‚åˆ©ç”¨åˆ†ç±»ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ObjCä¸­åŠ¨æ€çš„ä¸ºå·²æœ‰ç±»æ·»åŠ æ–°çš„è¡Œä¸ºï¼ˆç‰¹åˆ«æ˜¯ç³»ç»Ÿæˆ–æ¡†æž¶ä¸­çš„ç±»ï¼‰ã€‚ ä¾‹å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬ä¸ºç³»ç»Ÿæä¾›çš„NSStringç±»æä¾›ä¸€ä¸ªåŽ»æŽ‰å­—ç¬¦ä¸²ä¸­ä¸¤ç«¯çš„ç©ºæ ¼æ–¹æ³•ï¼š 12345678910111213141516171819@interface NSString (Extend)-(NSString *)stringByTrim;@end @implementation NSString (Extend)-(NSString *)stringByTrim&#123; NSCharacterSet *character= [NSCharacterSet whitespaceCharacterSet]; return [self stringByTrimmingCharactersInSet:character];&#125;@end int main(int argc, const char * argv[]) &#123; NSString *name=@"simple coder "; name=[name stringByTrim]; NSLog(@"I'm %@!",name); //ç»“æžœï¼šI'm simple coder! return 0;&#125; Categoryçš„æœ¬è´¨è¦æƒ³äº†è§£Categoryçš„æœ¬è´¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠOCæ–‡ä»¶è½¬æ¢æˆC++æ–‡ä»¶çš„å®žçŽ°ï¼Œä»¥çª¥æŽ¢å…¶åº•å±‚ã€‚ 1xcrun -sdk iphoneos clang -arch arm64 -rewrite-objc XXX.m æœç´¢å…³é”®å­—Category,æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ä»¥ä¸‹C++ç»“æž„ä½“çš„å®žçŽ° 1234567891011121314151617struct category_t &#123; const char *name; classref_t cls; struct method_list_t *instanceMethods; // å¯¹è±¡æ–¹æ³• struct method_list_t *classMethods; // ç±»æ–¹æ³• struct protocol_list_t *protocols; // åè®® struct property_list_t *instanceProperties; // å±žæ€§ // Fields below this point are not always present on disk. struct property_list_t *_classProperties; method_list_t *methodsForMeta(bool isMeta) &#123; if (isMeta) return classMethods; else return instanceMethods; &#125; property_list_t *propertiesForMeta(bool isMeta, struct header_info *hi);&#125;; ä»Žæºç å¯ä»¥çœ‹å‡ºï¼Œå¯¹è±¡æ–¹æ³•ï¼Œç±»æ–¹æ³•ï¼Œåè®®ï¼Œå’Œå±žæ€§éƒ½å¯ä»¥æ‰¾åˆ°åœ¨ç»“æž„ä½“category_tä¸­å¯¹åº”çš„å®žçŽ°ã€‚å¹¶ä¸”æˆ‘ä»¬å‘çŽ°åˆ†ç±»ç»“æž„ä½“ä¸­æ˜¯ä¸å­˜åœ¨æˆå‘˜å˜é‡çš„ï¼Œå› æ­¤åˆ†ç±»ä¸­æ˜¯ä¸å…è®¸æ·»åŠ æˆå‘˜å˜é‡çš„ã€‚åˆ†ç±»ä¸­æ·»åŠ çš„å±žæ€§å¹¶ä¸ä¼šå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆæˆå‘˜å˜é‡ï¼Œåªä¼šç”Ÿæˆgetã€setæ–¹æ³•çš„å£°æ˜Žï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±åŽ»å®žçŽ°ã€‚ é‚£ä¹ˆçŽ°åœ¨æˆ‘ä»¬æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œæ—¢ç„¶åˆ†ç±»çš„æœ¬è´¨æ˜¯åœ¨ç¼–è¯‘çš„æ—¶åˆ»ç”Ÿæˆä¸€ä¸ªC++ç»“æž„ä½“ï¼Œå®ƒæ˜¯å¦‚ä½•ä¸ŽåŽŸæ¥çš„ç±»äº§ç”Ÿè”ç³»çš„å‘¢ï¼Ÿ Runtimeæºç åˆ†æžä¸ºäº†è¿›ä¸€æ­¥ç ”ç©¶åˆ†ç±»åœ¨åº•å±‚å¦‚ä½•å®žçŽ°ä¸ŽåŽŸç±»å®žçŽ°å…³è”çš„ï¼Œæˆ‘ä»¬éœ€è¦å¯¹åˆ†ç±»å®žçŽ°çš„æºç è¿›è¡Œåˆ†æžã€‚è¿˜æ˜¯æ‰“å¼€æˆ‘ä»¬çš„objc4,æ‰¾åˆ°åˆå§‹åŒ–ç¨‹åºéƒ¨åˆ†ï¼š 123456789101112131415void _objc_init(void)&#123; static bool initialized = false; if (initialized) return; initialized = true; // fixme defer initialization until an objc-using image is found? environ_init(); tls_init(); static_init(); lock_init(); exception_init(); _dyld_objc_notify_register(&amp;map_images, load_images, unmap_image);&#125; æŽ¥ç€æˆ‘ä»¬æ¥åˆ° &amp;map_imagesè¯»å–æ¨¡å—ï¼ˆimagesè¿™é‡Œä»£è¡¨æ¨¡å—ï¼‰ï¼Œæ¥åˆ°map_images_nolockå‡½æ•°ä¸­æ‰¾åˆ°_read_imageså‡½æ•°ï¼Œåœ¨_read_imageså‡½æ•°ä¸­æˆ‘ä»¬æ‰¾åˆ°åˆ†ç±»ç›¸å…³ä»£ç : 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556// Discover categories. for (EACH_HEADER) &#123; category_t **catlist = _getObjc2CategoryList(hi, &amp;count); bool hasClassProperties = hi-&gt;info()-&gt;hasCategoryClassProperties(); for (i = 0; i &lt; count; i++) &#123; category_t *cat = catlist[i]; Class cls = remapClass(cat-&gt;cls); if (!cls) &#123; // Category's target class is missing (probably weak-linked). // Disavow any knowledge of this category. catlist[i] = nil; if (PrintConnecting) &#123; _objc_inform("CLASS: IGNORING category \?\?\?(%s) %p with " "missing weak-linked target class", cat-&gt;name, cat); &#125; continue; &#125; // Process this category. // First, register the category with its target class. // Then, rebuild the class's method lists (etc) if // the class is realized. bool classExists = NO; if (cat-&gt;instanceMethods || cat-&gt;protocols || cat-&gt;instanceProperties) &#123; addUnattachedCategoryForClass(cat, cls, hi); if (cls-&gt;isRealized()) &#123; remethodizeClass(cls); classExists = YES; &#125; if (PrintConnecting) &#123; _objc_inform("CLASS: found category -%s(%s) %s", cls-&gt;nameForLogging(), cat-&gt;name, classExists ? "on existing class" : ""); &#125; &#125; if (cat-&gt;classMethods || cat-&gt;protocols || (hasClassProperties &amp;&amp; cat-&gt;_classProperties)) &#123; addUnattachedCategoryForClass(cat, cls-&gt;ISA(), hi); if (cls-&gt;ISA()-&gt;isRealized()) &#123; remethodizeClass(cls-&gt;ISA()); &#125; if (PrintConnecting) &#123; _objc_inform("CLASS: found category +%s(%s)", cls-&gt;nameForLogging(), cat-&gt;name); &#125; &#125; &#125;&#125; ä»¥ä¸Šè¿™æ®µä»£ç æ˜¯ç”¨æ¥æŸ¥æ‰¾æœ‰æ²¡æœ‰åˆ†ç±»çš„ã€‚é€šè¿‡_getObjc2CategoryListå‡½æ•°èŽ·å–åˆ°åˆ†ç±»åˆ—è¡¨ä¹‹åŽï¼Œè¿›è¡ŒéåŽ†ï¼ŒèŽ·å–å…¶ä¸­çš„æ–¹æ³•ï¼Œåè®®ï¼Œå±žæ€§ç­‰ã€‚å¯ä»¥çœ‹åˆ°æœ€ç»ˆéƒ½è°ƒç”¨äº†remethodizeClass(cls)å‡½æ•°ã€‚æˆ‘ä»¬æ¥åˆ°remethodizeClass(cls)å‡½æ•°å†…éƒ¨è¿›è¡ŒæŸ¥çœ‹ï¼š 1234567891011121314151617181920static void remethodizeClass(Class cls)&#123; category_list *cats; bool isMeta; runtimeLock.assertWriting(); isMeta = cls-&gt;isMetaClass(); // Re-methodizing: check for more categories if ((cats = unattachedCategoriesForClass(cls, false/*not realizing*/))) &#123; if (PrintConnecting) &#123; _objc_inform("CLASS: attaching categories to class '%s' %s", cls-&gt;nameForLogging(), isMeta ? "(meta)" : ""); &#125; attachCategories(cls, cats, true /*flush caches*/); free(cats); &#125;&#125; é€šè¿‡ä¸Šè¿°ä»£ç æˆ‘ä»¬å‘çŽ°attachCategorieså‡½æ•°æŽ¥æ”¶äº†ç±»å¯¹è±¡clså’Œåˆ†ç±»æ•°ç»„catsï¼Œå› ä¸ºä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªåˆ†ç±»ã€‚ä¹‹å‰æˆ‘ä»¬è¯´åˆ°åˆ†ç±»ä¿¡æ¯å­˜å‚¨åœ¨category_tç»“æž„ä½“ä¸­ï¼Œé‚£ä¹ˆå¤šä¸ªåˆ†ç±»åˆ™ä¿å­˜åœ¨category_listä¸­ã€‚ ä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹çœ‹attachCategorieså‡½æ•°å†…éƒ¨æ˜¯æ€Žæ ·å®žçŽ°çš„ï¼š ä¸Šè¿°æºç ä¸­å¯ä»¥çœ‹å‡ºï¼Œé¦–å…ˆæ ¹æ®æ–¹æ³•åˆ—è¡¨ï¼Œå±žæ€§åˆ—è¡¨ï¼Œåè®®åˆ—è¡¨è¿›è¡Œmallocåˆ†é…å†…å­˜ï¼Œæ ¹æ®å¤šå°‘ä¸ªåˆ†ç±»ä»¥åŠæ¯ä¸€å—æ–¹æ³•éœ€è¦å¤šå°‘å†…å­˜æ¥åˆ†é…ç›¸åº”çš„å†…å­˜åœ°å€ã€‚ ä¹‹åŽé€šè¿‡ç±»å¯¹è±¡çš„data()æ–¹æ³•ï¼Œæ‹¿åˆ°ç±»å¯¹è±¡çš„class_rw_tç»“æž„ä½“rwï¼Œåœ¨classç»“æž„ä¸­æˆ‘ä»¬ä»‹ç»è¿‡ï¼Œclass_rw_tä¸­å­˜æ”¾ç€ç±»å¯¹è±¡çš„æ–¹æ³•ï¼Œå±žæ€§å’Œåè®®ç­‰æ•°æ®ï¼Œrwç»“æž„ä½“é€šè¿‡ç±»å¯¹è±¡çš„dataæ–¹æ³•èŽ·å–ï¼Œæ‰€ä»¥rwé‡Œé¢å­˜æ”¾è¿™ç±»å¯¹è±¡é‡Œé¢çš„æ•°æ®ã€‚ ä¹‹åŽåˆ†åˆ«é€šè¿‡rwè°ƒç”¨æ–¹æ³•åˆ—è¡¨ã€å±žæ€§åˆ—è¡¨ã€åè®®åˆ—è¡¨çš„attachListå‡½æ•°ï¼Œå°†æ‰€æœ‰çš„åˆ†ç±»çš„æ–¹æ³•ã€å±žæ€§ã€åè®®åˆ—è¡¨æ•°ç»„ä¼ è¿›åŽ»ï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥çŒœæƒ³åˆ°åœ¨attachListæ–¹æ³•å†…éƒ¨å°†åˆ†ç±»å’Œæœ¬ç±»ç›¸åº”çš„å¯¹è±¡æ–¹æ³•ï¼Œå±žæ€§ï¼Œå’Œåè®®è¿›è¡Œäº†åˆå¹¶ã€‚ 123456789101112131415161718192021222324252627282930void attachLists(List* const * addedLists, uint32_t addedCount) &#123; if (addedCount == 0) return; if (hasArray()) &#123; // many lists -&gt; many lists uint32_t oldCount = array()-&gt;count; uint32_t newCount = oldCount + addedCount; setArray((array_t *)realloc(array(), array_t::byteSize(newCount))); array()-&gt;count = newCount; memmove(array()-&gt;lists + addedCount, array()-&gt;lists, oldCount * sizeof(array()-&gt;lists[0])); memcpy(array()-&gt;lists, addedLists, addedCount * sizeof(array()-&gt;lists[0])); &#125; else if (!list &amp;&amp; addedCount == 1) &#123; // 0 lists -&gt; 1 list list = addedLists[0]; &#125; else &#123; // 1 list -&gt; many lists List* oldList = list; uint32_t oldCount = oldList ? 1 : 0; uint32_t newCount = oldCount + addedCount; setArray((array_t *)malloc(array_t::byteSize(newCount))); array()-&gt;count = newCount; if (oldList) array()-&gt;lists[addedCount] = oldList; memcpy(array()-&gt;lists, addedLists, addedCount * sizeof(array()-&gt;lists[0])); &#125; &#125; ä»Žä¸Šé¢çš„æºç éƒ¨åˆ†å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿›è¡ŒåŽŸç±»å’Œåˆ†ç±»åˆå¹¶çš„æ—¶å€™ï¼Œå†…å­˜è¿›è¡Œäº†é‡æ–°çš„åˆ†é…ã€‚Runtimeå°†åŽŸç±»ä¸­çš„æ–¹æ³•å‘åŽç§»åŠ¨Nä¸ªå•ä½ï¼ˆNä¸ºåˆ†ç±»ä¸­æ–¹æ³•çš„ä¸ªæ•°ï¼‰ï¼Œç„¶åŽæŒ‰ç…§ä»ŽåŽå¾€å‰çš„é¡ºåºï¼Œä¸€æ¬¡å°†åˆ†ç±»æ–¹æ³•æ•°ç»„ä¸­çš„æ•°æ®æ·»åŠ åˆ°åŽŸç±»å¯¹è±¡ä¸­ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†ä¿è¯åˆ†ç±»æ–¹æ³•ä¼˜å…ˆè°ƒç”¨ï¼Œæˆ‘ä»¬çŸ¥é“å½“åˆ†ç±»é‡å†™æœ¬ç±»çš„æ–¹æ³•æ—¶ï¼Œä¼šè¦†ç›–æœ¬ç±»çš„æ–¹æ³•ï¼Œä½†æ˜¯æœ¬ç±»çš„æ–¹æ³•ä¾ç„¶åœ¨å†…å­˜ä¸­ã€‚ åˆ†ç±»çš„æ€»ç»“é€šè¿‡å¯¹æºç çš„åˆ†æžï¼Œæˆ‘ä»¬å·²ç»èƒ½å¤Ÿè®¤è¯†åˆ°ï¼šCategoryç¼–è¯‘ä¹‹åŽçš„åº•å±‚ç»“æž„æ˜¯struct category_tï¼Œé‡Œé¢å­˜å‚¨ç€åˆ†ç±»çš„å¯¹è±¡æ–¹æ³•ã€ç±»æ–¹æ³•ã€å±žæ€§ã€åè®®ä¿¡æ¯ã€‚åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œruntimeä¼šå°†Categoryçš„æ•°æ®ï¼Œåˆå¹¶åˆ°ç±»ä¿¡æ¯ä¸­ï¼ˆç±»å¯¹è±¡ã€å…ƒç±»å¯¹è±¡ä¸­ï¼‰ã€‚è¿™ä¸€ç‚¹è¦å’Œç±»çš„æ‰©å±•ä½œåŒºåˆ†ï¼ŒClass Extensionåœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œå®ƒçš„æ•°æ®å°±å·²ç»åŒ…å«åœ¨ç±»ä¿¡æ¯ä¸­ã€‚ Categoryå¯ä»¥æ·»åŠ å±žæ€§ï¼Œä½†æ˜¯å¹¶ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆæˆå‘˜å˜é‡åŠset/getæ–¹æ³•ã€‚å› ä¸ºcategory_tç»“æž„ä½“ä¸­å¹¶ä¸å­˜åœ¨æˆå‘˜å˜é‡ã€‚ load å’Œ initializeloadæ–¹æ³•çš„è°ƒç”¨æ—¶åˆ»æ ¹æ®æ‰€å­¦çš„OCåŸºç¡€æˆ‘ä»¬çŸ¥é“ï¼Œ+loadæ–¹æ³•ä¼šåœ¨RuntimeåŠ è½½ç±»ã€åˆ†ç±»çš„æ—¶å€™è°ƒç”¨ï¼Œå¹¶ä¸”æ¯ä¸ªç±»ã€åˆ†ç±»çš„+loadæ–¹æ³•ï¼Œåœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­åªè°ƒç”¨ä¸€æ¬¡ã€‚ ä½†æ˜¯ï¼Œå¦‚æžœå­˜åœ¨çˆ¶ç±»ã€å­ç±»ã€åˆ†ç±»çš„æƒ…å†µä¸‹ï¼Œ+loadæ–¹æ³•çš„è°ƒç”¨é¡ºåºæ˜¯æ€Žæ ·çš„å‘¢ï¼Ÿ loadæ–¹æ³•çš„è°ƒç”¨é¡ºåºæˆ‘ä»¬æ¥å†™ä¸€ä¸ªå°çš„æµ‹è¯•ç¨‹åºï¼Œæ¥éªŒè¯ä¸€ä¸‹è°ƒç”¨è¿‡ç¨‹ï¼Œå…¶ä¸­Personå’ŒStudent (Test)ç±»åˆ†åˆ«æ˜¯Studentç±»çš„çˆ¶ç±»å’Œåˆ†ç±»ã€‚ä¸»è¦ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223@implementation Person+ (void)load&#123; NSLog(@"Person +load");&#125;@end@implementation Student+ (void)load&#123; NSLog(@"Student +load");&#125;@end@implementation Student (Test)+ (void)load&#123; NSLog(@"Student (Test) +load");&#125;@end åªè¦ç¨‹åºè£…è½½è¿›å†…å­˜ï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°æ‰“å°ç»“æžœï¼Œé¡ºåºä¸ºPerson +load,Student +load,Student (Test) +loadã€‚ä½†è¿™ä¼¼ä¹Žä¸åˆä¹Žå¸¸ç†ï¼Œå› ä¸ºæ–¹æ³•è°ƒç”¨çš„æ—¶å€™ï¼Œå­ç±»å¦‚æžœé‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œçˆ¶ç±»çš„æ–¹æ³•å°±ä¼šè¢«è¦†ç›–ã€‚æ ¹æ®ä¸Šä¸€èŠ‚çš„åˆ†æžç»“æžœï¼Œåˆ†ç±»å¦‚æžœå®žçŽ°äº†åŽŸæ¥ç±»çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿è¡Œæ—¶ç³»ç»Ÿå°±ä¼šæŠŠåˆ†ç±»çš„æ–¹æ³•åˆ—è¡¨æ”¾åˆ°åŽŸæ¥ç±»æ–¹æ³•åˆ—è¡¨çš„æœ€å‰é¢ï¼Œä¹Ÿç›¸å½“äºŽè¦†ç›–äº†åŽŸæ¥ç±»çš„å®žçŽ°ã€‚ åº•å±‚æ˜¯æ€Žæ ·å®žçŽ°è°ƒç”¨æ‰€æœ‰ç±»çš„loadæ–¹æ³•ï¼Ÿobjc4æºç è§£è¯»ï¼š æœç´¢objc-os.mmæ–‡ä»¶ï¼Œå¹¶ä¸”æ‰¾åˆ°_objc_initæ–¹æ³•,è¿›å…¥load_imageså‡½æ•° å‡†å¤‡è°ƒç”¨loadï¼šprepare_load_methodsï¼Œå…¶ä¸­åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªå°çš„æ­¥éª¤ schedule_class_loadï¼šå‡†å¤‡loadæ–¹æ³• add_class_to_loadable_listï¼šæ·»åŠ ç±»çš„loadæ–¹æ³•åˆ—è¡¨ add_category_to_loadable_listï¼šæ·»åŠ åˆ†ç±»loadæ–¹æ³•åˆ—è¡¨ æœ€åŽä¸€æ­¥ä¸ºcall_load_methods ä¼˜å…ˆcall_class_loads å…¶æ¬¡call_category_loads ä»¥ä¸‹è´´å‡ºcall_class_loadsæºç éƒ¨åˆ†ï¼š 1234567891011121314151617181920212223242526static void call_class_loads(void)&#123; int i; // Detach current loadable list. struct loadable_class *classes = loadable_classes; int used = loadable_classes_used; loadable_classes = nil; loadable_classes_allocated = 0; loadable_classes_used = 0; // Call all +loads for the detached list. for (i = 0; i &lt; used; i++) &#123; Class cls = classes[i].cls; load_method_t load_method = (load_method_t)classes[i].method; if (!cls) continue; if (PrintLoading) &#123; _objc_inform("LOAD: +[%s load]\n", cls-&gt;nameForLogging()); &#125; (*load_method)(cls, SEL_load); &#125; // Destroy the detached list. if (classes) free(classes);&#125; é‚£ä¹ˆé‡ç‚¹æ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè°ƒç”¨ç±»çš„loadæ–¹æ³•å¹¶ä¸æ˜¯æˆ‘ä»¬æ‰€ç†ŸçŸ¥çš„æ¶ˆæ¯å‘é€æœºåˆ¶ï¼Œå…¶æœ¬è´¨ä¸ºCè¯­è¨€é‡Œé¢çš„é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å¯¹åº”çš„å‡½æ•°ï¼š(*load_method)(cls, SEL_load),å› æ­¤æ‰èƒ½è¶Šè¿‡æ–¹æ³•è°ƒç”¨çš„éšœç¢ï¼Œç›´æŽ¥è°ƒç”¨å¯¹åº”ç±»ä¸­çš„loadæ–¹æ³•ã€‚ initializeåˆ†æžinitializeæ–¹æ³•ä¼šåœ¨ç±»ç¬¬ä¸€æ¬¡æŽ¥æ”¶åˆ°æ¶ˆæ¯æ—¶è°ƒç”¨ï¼Œæˆ‘ä»¬ä½¿ç”¨è·Ÿä¸Šè¿°loadæºç åˆ†æžåŒæ ·çš„æ–¹å¼æ¥ç ”ç©¶initializeæ–¹æ³•ï¼Œä¸‹é¢ç®€å•æ¦‚æ‹¬æºç è§£è¯»é¡ºåºï¼š 12345678objc-msg-arm64.sobjc_msgSendobjc-runtime-new.mmclass_getInstanceMethodlookUpImpOrNillookUpImpOrForward_class_initializecallInitializeobjc_msgSend(cls, SEL_initialize) è¿™é‡Œéœ€è¦é‡ç‚¹åˆ†æžä¸€ä¸‹_class_initializeæ–¹æ³•çš„å®žçŽ° 1234567891011121314void _class_initialize(Class cls)&#123; assert(!cls-&gt;isMetaClass()); Class supercls; bool reallyInitialize = NO; // Make sure super is done initializing BEFORE beginning to initialize cls. // See note about deadlock above. supercls = cls-&gt;superclass; if (supercls &amp;&amp; !supercls-&gt;isInitialized()) &#123; _class_initialize(supercls); &#125;&#125; _class_initialize(supercls);å‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æžœè°ƒç”¨äº†å­ç±»çš„initialize,ä¼šä¼˜å…ˆæŸ¥æ‰¾çˆ¶ç±»ï¼Œæœ‰çˆ¶ç±»çš„å°±å¯¹çˆ¶ç±»è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œä¸€æ­¥æ­¥å¾€ä¸Šé€’å½’ï¼Œç›´åˆ°æ‰¾ä¸å¸¦çˆ¶ç±»ã€‚å¯ä»¥çœ‹å‡ºæ˜Žæ˜¾å’Œloadæ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œ initializeèµ°çš„æ˜¯æ¶ˆæ¯å‘é€æœºåˆ¶ã€‚ load å’Œ initializeæ€»ç»“æˆ‘ä»¬é€šè¿‡å¯¹æ¯”ä¸¤è€…çš„åŒºåˆ«æ¥è¿›è¡Œä¸€æ¬¡æ€»ç»“ï¼š è°ƒç”¨æ–¹å¼ä¸Šï¼š loadæ˜¯æ ¹æ®å‡½æ•°åœ°å€ç›´æŽ¥è°ƒç”¨ initializeæ˜¯é€šè¿‡objc_msgSendè°ƒç”¨ è°ƒç”¨æ—¶åˆ»ï¼š loadæ˜¯runtimeåŠ è½½ç±»ã€åˆ†ç±»çš„æ—¶å€™è°ƒç”¨ï¼ˆåªä¼šè°ƒç”¨1æ¬¡ï¼‰ initializeæ˜¯ç±»ç¬¬ä¸€æ¬¡æŽ¥æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™è°ƒç”¨ï¼Œæ¯ä¸€ä¸ªç±»åªä¼šinitializeä¸€æ¬¡ï¼ˆçˆ¶ç±»çš„initializeæ–¹æ³•å¯èƒ½ä¼šè¢«è°ƒç”¨å¤šæ¬¡ï¼‰ è°ƒç”¨é¡ºåºï¼š load å…ˆè°ƒç”¨ç±»çš„load å…ˆç¼–è¯‘çš„ç±»ï¼Œä¼˜å…ˆè°ƒç”¨load è°ƒç”¨å­ç±»çš„loadä¹‹å‰ï¼Œä¼šå…ˆè°ƒç”¨çˆ¶ç±»çš„load å†è°ƒç”¨åˆ†ç±»çš„load å…ˆç¼–è¯‘çš„åˆ†ç±»ï¼Œä¼˜å…ˆè°ƒç”¨load initialize å…ˆåˆå§‹åŒ–çˆ¶ç±» å†åˆå§‹åŒ–å­ç±»ï¼ˆå¯èƒ½æœ€ç»ˆè°ƒç”¨çš„æ˜¯çˆ¶ç±»çš„initializeæ–¹æ³•ï¼‰]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>category</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[OCå¯¹è±¡æœ¬è´¨çª¥æŽ¢]]></title>
    <url>%2F2018%2F06%2F30%2FOC%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%9C%AC%E8%B4%A8%E7%AA%A5%E6%8E%A2%2F</url>
    <content type="text"><![CDATA[OCå¯¹è±¡æœ¬è´¨çª¥æŽ¢ä»Žä¸€é“é¢è¯•é¢˜è¯´èµ· ä¸€ä¸ªNSObjectå¯¹è±¡å ç”¨å¤šå°‘å†…å­˜ï¼Ÿ è¦å›žç­”è¿™é“é¢è¯•é¢˜ï¼Œé¦–å…ˆéœ€è¦å¯¹OCå¯¹è±¡çš„åº•å±‚å®žçŽ°æœ‰ä¸€å®šçš„è®¤è¯†ã€‚ç›®å‰å·²çŸ¥çš„æ˜¯ï¼šæˆ‘ä»¬å¹³æ—¶ç¼–å†™çš„Objective-Cä»£ç ï¼Œåº•å±‚å®žçŽ°å…¶å®žéƒ½æ˜¯C\C++ä»£ç ã€‚ Objective-Cçš„é¢å‘å¯¹è±¡éƒ½æ˜¯åŸºäºŽC\C++çš„æ•°æ®ç»“æž„å®žçŽ°çš„ã€‚ é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šObjective-Cçš„å¯¹è±¡ã€ç±»ä¸»è¦æ˜¯åŸºäºŽC/C++çš„ä»€ä¹ˆæ•°æ®ç»“æž„å®žçŽ°çš„ï¼Ÿ ç­”æ¡ˆæ˜¯ç»“æž„ä½“ã€‚è¦æƒ³è¯æ˜Žè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å°†OCä»£ç è½¬æ¢ä¸ºC/C++ä»£ç ï¼Œä»¥ä¾¿æˆ‘ä»¬è¿›ä¸€æ­¥å¯¹OCå¯¹è±¡æœ¬è´¨çš„è¿›ä¸€æ­¥æŽ¢ç´¢ã€‚ OCå¯¹è±¡çš„æœ¬è´¨OCä»£ç è½¬C/C++æ€Žæ ·è¿›è¡ŒOCåˆ°C/C++ä»£ç çš„è½¬åŒ–å‘¢ï¼Ÿå…¶å®žXcodeå·²ç»å‘æˆ‘ä»¬æä¾›äº†å‘½ä»¤è¡Œè½¬æ¢å·¥å…·ï¼Œåªè¦æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š 1xcrun -sdk iphoneos clang -arch arm64 -rewrite-objc OCæºæ–‡ä»¶ -o è¾“å‡ºçš„CPPæ–‡ä»¶ å…¶ä¸­ï¼š-sdkå‚æ•°ä¸ºæŒ‡å®šç¼–è¯‘ä»£ç è¿è¡Œçš„å¹³å°ï¼ˆä¸åŒå¹³å°ä»£ç ä¸ä¸€æ ·ï¼‰ã€‚-archä¸ºæŒ‡å®šæž¶æž„ï¼Œæ‰‹æœºä¸ºarm64ã€‚ï¼ˆæ¨¡æ‹Ÿå™¨(i386)ã€32bit(armv7)ã€64bitï¼ˆarm64ï¼‰ï¼‰ å¦‚æžœéœ€è¦é“¾æŽ¥å…¶ä»–æ¡†æž¶ï¼Œä½¿ç”¨-frameworkå‚æ•°ã€‚æ¯”å¦‚-framework UIKitã€‚ å…·ä½“è½¬æ¢æ­¥éª¤ï¼š æ–°å»ºXcodeå‘½ä»¤è¡Œé¡¹ç›® åœ¨main.mä¸­åˆ›å»ºä¸€ä¸ªæœ€ç®€å•çš„NSObjectå¯¹è±¡ 1NSObject *obj = [[NSObject alloc] init]; æ‰“å¼€ç»ˆç«¯ï¼Œå®šä½åˆ°é¡¹ç›®çš„ main.mã€‚æ­¤æ­¥å»ºè®®é€šè¿‡å®‰è£…æ’ä»¶Go2Shellæ‰§è¡Œã€‚ è¿è¡Œå‘½ä»¤ xcrun -sdk iphoneos clang -arch arm64 -rewrite-objc main.m -o cppmain.cpp è½¬æ¢å®Œæˆï¼Œé€šè¿‡open ./æ‰“å¼€Finderæ‰¾åˆ°cppmain.cppæ–‡ä»¶ C/C++åº•å±‚å®žçŽ°C/C++éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š 123456int main(int argc, const char * argv[]) &#123; /* @autoreleasepool */ &#123; __AtAutoreleasePool __autoreleasepool; NSObject *obj = ((NSObject *(*)(id, SEL))(void *)objc_msgSend)((id)((NSObject *(*) (id, SEL))(void *)objc_msgSend)((id)objc_getClass("NSObject"), sel_registerName("alloc")), sel_registerName("init")); &#125; return 0;&#125; é€šè¿‡ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡ºï¼Œåˆ›å»ºä¸€ä¸ªNSObjectå¯¹è±¡å…¶å®žåº•å±‚å°±æ˜¯é€šè¿‡objc_msgSendå‘é€æ¶ˆæ¯ã€‚åˆ†é…ç©ºé—´æ¶ˆæ¯ä¸ºallocï¼Œåˆå§‹åŒ–æ¶ˆæ¯ä¸ºinitã€‚ä½†æ˜¯åªé€šè¿‡è¿™äº›ä»£ç æˆ‘ä»¬è¿˜çœ‹ä¸å‡ºOCå¯¹è±¡çš„åº•å±‚å®žçŽ°ã€‚ è¿›ä¸€æ­¥åœ¨cppæœç´¢æ–‡ä»¶æœç´¢å…³é”®è¯NSObjectï¼Œå¯ä»¥æ‰¾åˆ°ä»¥ä¸‹å®žçŽ°ï¼š 123struct NSObject_IMPL &#123; Class isa;&#125;; å¾ˆæ˜Žæ˜¾è¿™æ˜¯ä¸€ä¸ªç»“æž„ä½“ã€‚ç»“æž„ä½“é‡Œé¢å°±ä¸€ä¸ªClassæˆå‘˜ã€‚æ­¤æ—¶æˆ‘ä»¬è·³è½¬åˆ°Classçš„å®šä¹‰éƒ¨åˆ†ï¼š 1typedef struct objc_class *Class; è¿™æ˜¯ä¸€ä¸ªç»“æž„ä½“æŒ‡é’ˆï¼ŒæŒ‡å‘struct objc_classã€‚æ‰€ä»¥ï¼Œä¸€ä¸ªOCå¯¹è±¡åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•å¸ƒå±€çš„ï¼Œåˆ°è¿™é‡Œåº”è¯¥æ¯”è¾ƒæ¸…æ™°æ˜Žäº†äº†ã€‚ æ ¹æ®ç›®å‰æˆ‘ä»¬å·²çŸ¥çš„éƒ¨åˆ†ï¼Œå¯ä»¥æ€»ç»“å‡ºï¼šNSObjectå®žä¾‹å¯¹è±¡åº•å±‚æ˜¯é€šè¿‡ç»“æž„ä½“æ¥å®žçŽ°çš„ï¼Œæ¯ä¸ªç»“æž„ä½“å†…éƒ¨éƒ½æœ‰ä¸€ä¸ªisaæŒ‡é’ˆï¼ŒæŒ‡å‘åˆ›å»ºå®ƒçš„ç±»çš„å†…å­˜åœ°å€ã€‚ çŽ°åœ¨å›žåˆ°å¼€ç¯‡é‚£é“é¢è¯•é¢˜ï¼šä¸€ä¸ªNSObjectå¯¹è±¡åˆ°åº•å æ®äº†å¤šå¤§çš„å†…å­˜ç©ºé—´å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨64ä½æ“ä½œç³»ç»ŸçŽ¯å¢ƒä¸‹ï¼Œä¸€ä¸ªæŒ‡é’ˆå æ®8ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œæ­£å¥½ä¸€ä¸ªNSObject_IMPLç»“æž„ä½“é‡Œé¢æœ‰ä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™æ˜¯ä¸æ˜¯å°±æ„å‘³ç€ä¸€ä¸ªNSObjectå¯¹è±¡å æ®8ä¸ªå­—èŠ‚çš„å­˜å‚¨ç©ºé—´å‘¢ï¼Ÿæˆ‘ä»¬ä¸å¦¨é€šè¿‡ä»£ç åŽ»è¿›è¡ŒéªŒè¯ä¸€ä¸‹ã€‚ ç›®å‰è®¡ç®—æ‰€å ç©ºé—´å¤§å°ä¸»è¦æœ‰ä¸¤ç§æ–¹æ¡ˆã€‚é¦–å…ˆå¯¼å…¥æ‰€éœ€å‡½æ•°çš„å¤´æ–‡ä»¶ï¼š 12#import &lt;objc/runtime.h&gt;#import &lt;malloc/malloc.h&gt; è°ƒç”¨çš„å‡½æ•°ï¼š 123456781.class_getInstanceSize(&lt;#Class _Nullable __unsafe_unretained cls#&gt;);2.malloc_size(const void *ptr);// èŽ·å¾—NSObjectå®žä¾‹å¯¹è±¡çš„æˆå‘˜å˜é‡æ‰€å ç”¨çš„å¤§å° &gt;&gt; 8 æ‰“å°ç»“æžœä¸º8 NSLog(@"%zd", class_getInstanceSize([NSObject class])); // èŽ·å¾—objæŒ‡é’ˆæ‰€æŒ‡å‘å†…å­˜çš„å¤§å° &gt;&gt; 16 æ‰“å°ç»“æžœä¸º16 NSLog(@"%zd", malloc_size((__bridge const void *)obj)); å‡½æ•°è¯´æ˜Žï¼šclass_getInstanceSizeéœ€è¦æˆ‘ä»¬ä¼ å…¥å…·ä½“çš„å®žä¾‹å¯¹è±¡ã€‚å±žäºŽè¿è¡Œæ—¶ç³»ç»Ÿçš„APIï¼ŒåŠ¨æ€è®¡ç®—å®žä¾‹å¯¹è±¡çš„å®žä¾‹å˜é‡å®žé™…å ç”¨äº†å¤šå°‘å†…å­˜ç©ºé—´ã€‚è€Œmalloc_sizeå±žäºŽCè¯­è¨€APIï¼Œè¦æ±‚æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæŒ‡é’ˆï¼Œèƒ½å¤ŸèŽ·å–åˆ°ç³»ç»Ÿå®žé™…åˆ†é…äº†å¤šå°‘å†…å­˜ç»™å¯¹è±¡ã€‚ä¼ å…¥OCå¯¹è±¡çš„æ—¶å€™éœ€è¦__bridgeè¿›è¡Œæ¡¥æŽ¥ã€‚ class_getInstanceSizeè¿”å›žå€¼ç»“æžœä¸º8ï¼Œmalloc_sizeè¿”å›žå€¼ä¸º16ï¼Œä¸ºä»€ä¹ˆä¸ä¸€æ ·å‘¢ï¼Ÿå…¶å®žåœ¨ä¸Šé¢çš„å‡½æ•°è¯´æ˜Žéƒ¨åˆ†å·²ç»æœ‰è§£é‡Šäº†ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡runtimeæºç è¿›è¡Œè¿›ä¸€æ­¥åˆ†æžã€‚ Runtime&amp;allocWithZoneæºç åˆ†æžé¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“çš„ä¸€ç‚¹æ˜¯ï¼Œç›®å‰OCå®žçŽ°çš„æºç å·²ç»æ˜¯éƒ¨åˆ†å¼€æºçš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—® opensource.apple.comæ‰¾åˆ°æœ€æ–°çš„ï¼ˆæ•°å­—æœ€å¤§ï¼‰çš„ç‰ˆæœ¬è¿›è¡Œä¸‹è½½ã€‚ è§£åŽ‹å¹¶æ‰“å¼€æˆ‘ä»¬ä¸‹è½½çš„objc4æ–‡ä»¶ï¼Œæœç´¢åˆ°class_getInstanceSizeçš„å®žçŽ°éƒ¨åˆ†ï¼š 1234size_t class_getInstanceSize(Class cls)&#123; if (!cls) return 0; return cls-&gt;alignedInstanceSize();&#125; è¿›å…¥ alignedInstanceSizeå‡½æ•°å†…éƒ¨ï¼š 1234// Class's ivar size rounded up to a pointer-size boundary.uint32_t alignedInstanceSize() &#123; return word_align(unalignedInstanceSize());&#125; æ³¨é‡Šçš„è¯´æ˜Žæ–‡å­—éƒ¨åˆ†å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªå‡½æ•°è¿”å›žçš„æ˜¯å¯¹è±¡å†…éƒ¨çš„å®žä¾‹å˜é‡å®žé™…æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å¤§å°ï¼ˆivarä»£è¡¨æˆå‘˜å˜é‡ï¼ŒåŽé¢çš„ç« èŠ‚ä¼šè®²åˆ°ï¼‰ã€‚çŽ°åœ¨å¯¹æ¯”malloc_sizeå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŽ¢ç©¶ä¸€ä¸‹NSObjectè°ƒç”¨allocæ–¹æ³•çš„åº•å±‚å®žçŽ°ï¼š æ‰“å¼€ä¸Šè¿°ä¸‹è½½çš„æºç æ–‡ä»¶objc4,æœç´¢allocWithZoneæ–¹æ³• æ‰¾åˆ°å‡½æ•°_objc_rootAllocWithZone(Class cls, malloc_zone_t *zone)ï¼Œåœ¨æ­¤æ–¹æ³•çš„å®žçŽ°ä¸­æŸ¥çœ‹obj = class_createInstance(cls, 0)å‡½æ•°ï¼Œå¹¶è·³è½¬å…¶å®žçŽ°ä»£ç éƒ¨åˆ†ã€‚ åœ¨class_createInstanceå‡½æ•°å®žçŽ°ä¸­æŸ¥æ‰¾_class_createInstanceFromZone(cls, extraBytes, nil),å¹¶è·³è½¬å…¶å®žçŽ°ä»£ç éƒ¨åˆ† åœ¨_class_createInstanceFromZoneå®žçŽ°é‡ŒæŸ¥æ‰¾size_t size = cls-&gt;instanceSize(extraBytes),å¹¶è·³è½¬å…¶å®žçŽ°éƒ¨åˆ†ã€‚ ä»¥ä¸‹ä¸ºcls-&gt;instanceSize(extraBytes)å‡½æ•°ä¸ºOCå¯¹è±¡åˆ†é…å†…å­˜ç©ºé—´çš„å‡½æ•°ï¼š 123456size_t instanceSize(size_t extraBytes) &#123; size_t size = alignedInstanceSize() + extraBytes; // CF requires all objects be at least 16 bytes. if (size &lt; 16) size = 16; return size; &#125; å¦‚æžœè®¡ç®—å‡ºæ¥çš„sizeå°äºŽ16ï¼Œç³»ç»Ÿä¼šæŠŠåˆ†é…çš„å†…å­˜ç©ºé—´ç½®ä¸º16ã€‚æ¢å¥è¯è¯´ï¼Œç³»ç»Ÿåœ¨ä¸ºOCå¯¹è±¡åˆ†é…å­˜å‚¨ç©ºé—´æ—¶ï¼Œæœ‰ä¸€ä¸ªç¡¬æ€§è§„å®šï¼Œé‚£å°±æ˜¯æœ€å°ä¸º16ä¸ªå­—èŠ‚å¤§å°ã€‚ é€šè¿‡ä»¥ä¸Šåˆ†æžæ€»ç»“å‡ºä»¥ä¸‹ç»“è®ºï¼š ç³»ç»Ÿåˆ†é…äº†16ä¸ªå­—èŠ‚ç»™NSObjectå¯¹è±¡ï¼ˆé€šè¿‡malloc_sizeå‡½æ•°èŽ·å¾—ï¼‰ã€‚ ä½†NSObjectå¯¹è±¡å†…éƒ¨åªä½¿ç”¨äº†8ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼ˆ64bitçŽ¯å¢ƒä¸‹ï¼Œå¯ä»¥é€šè¿‡class_getInstanceSizeå‡½æ•°èŽ·å¾—ï¼‰ å¦ä¸€ç§è§’åº¦æˆ‘ä»¬ä¹Ÿé€šè¿‡Xcodeæä¾›çš„å·¥å…·æ¥çª¥æŽ¢OCå¯¹è±¡æ‰€å ç”¨å†…å­˜ã€‚è¿˜æ˜¯ç”¨ä¸Šé¢çš„åˆ›å»ºçš„NSObjectå¯¹è±¡çš„å·¥ç¨‹ï¼Œåœ¨åˆ›å»ºä»£ç ä¸‹ä¸€è¡Œä»£ç å¤„æ‰“ä¸€ä¸ªæ–­ç‚¹ã€‚ è¿è¡Œç¨‹åºï¼Œåœ¨æ–­ç‚¹åœæ­¢çš„æ—¶å€™ç‚¹å‡»å°å¹å·æŸ¥çœ‹å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚ æŽ§åˆ¶å°å¤åˆ¶å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚è¿›å…¥ï¼šDebug -&gt; Debug Workfllow -&gt; View Memory ï¼ˆShift + Command + Mï¼‰ åœ¨ä¸‹å›¾ç®­å¤´æ‰€æŒ‡å‘çš„è¾“å…¥æ¡†å†…ç²˜è´´å¯¹è±¡åœ°å€ï¼ŒæŸ¥çœ‹ã€‚ ä¸Šé¢è¿™å¼ å›¾ä¸­ï¼Œç¬¬ä¸€è¡Œè“çº¿å’Œç»¿çº¿æ ‡è¯†çš„éƒ¨åˆ†ï¼ˆ16ä¸ªå­—èŠ‚ï¼‰å³ä¸ºNSObjectå¯¹è±¡åˆ†é…çš„å†…å­˜åœ°å€ã€‚ä¸éš¾çœ‹å‡ºï¼Œå¯¹è±¡å®žé™…ä¸Šåªä½¿ç”¨äº†å‰8ä¸ªå­—èŠ‚çš„å†…å­˜åœ°å€ï¼Œå‰©ä½™8ä¸ªå­—èŠ‚ä¸ºç©ºå€¼ã€‚ è¿™ç§æ–¹å¼ç±»ä¼¼äºŽæˆ‘ä»¬å¸¸ç”¨çš„LLDBæŒ‡ä»¤ï¼Œæ‹¿åˆ°å¯¹è±¡çš„åœ°å€ä»¥åŽå¯ä»¥è¿›è¡Œ memory readã€‚æ‰“å°ç»“æžœä¸Žä¸Šå›¾å±•ç¤ºçš„ä¸€æ ·ï¼Œè¿™é‡Œä¸åšè¯¦ç»†ä»‹ç»ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„LLDBæŒ‡ä»¤ï¼š printã€p:æ‰“å° po:æ‰“å°å¯¹è±¡ memory readï¼šè¯»å–å†…å­˜ã€‚å¸¸ç”¨æ ¼å¼ä¸ºmemory read/æ•°é‡æ ¼å¼å­—èŠ‚æ•° å†…å­˜åœ°å€ã€‚å¸¸ç”¨ç®€å†™æ–¹å¼ï¼šx/æ•°é‡æ ¼å¼å­—èŠ‚æ•° å†…å­˜åœ°å€ã€‚ä¾‹å¦‚x/3xw 0x10010ã€‚è¿™é‡Œè¯´æ˜Žä¸‹æ ¼å¼ï¼šxä»£è¡¨16è¿›åˆ¶ï¼Œfæ˜¯æµ®ç‚¹ï¼Œdæ˜¯åè¿›åˆ¶ã€‚å­—èŠ‚å¤§å°çš„è¡¨ç¤ºä¸ºï¼šb:byte 1ä¸ªå­—èŠ‚ã€‚ h:half word 2ä¸ªå­—èŠ‚ã€‚wï¼šword 4å­—èŠ‚ã€‚gï¼šgiant word 8å­—èŠ‚ ä¿®æ”¹å†…å­˜ä¸­çš„å€¼ï¼špmemory write å†…å­˜åœ°å€ æ•°å€¼ å¤æ‚å¯¹è±¡çš„å†…å­˜åˆ†é…é—®é¢˜å…ˆæ¥æ€è€ƒä¸‹é¢è¿™æ®µä»£ç çš„è¾“å‡ºï¼š 123456789101112131415161718192021222324252627282930/* Person */@interface Person : NSObject&#123; int _age;&#125;@end@implementation Person@end/* Student */@interface Student : Person&#123; int _no;&#125;@end@implementation Student@endint main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; NSLog(@"%zd %zd", class_getInstanceSize([Person class]), class_getInstanceSize([Student class]) ); &#125; return 0;&#125; æˆ‘ä»¬ä¾æ®ä¸Šé¢çš„åˆ†æžä¸Žå‘çŽ°ï¼Œç±»å¯¹è±¡å®žè´¨ä¸Šæ˜¯ä»¥ç»“æž„ä½“çš„å½¢å¼å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œç”»å‡ºçœŸæ­£çš„å†…å­˜å›¾ä¾‹ åªè¦æ˜¯ç»§æ‰¿è‡ªNSObjectçš„å¯¹è±¡ï¼Œé‚£ä¹ˆåº•å±‚ç»“æž„ä½“å†…ä¸€å®šæœ‰ä¸€ä¸ªisaæŒ‡é’ˆã€‚ é‚£ä¹ˆä»–ä»¬æ‰€å çš„å†…å­˜ç©ºé—´æ˜¯å¤šå°‘å‘¢ï¼Ÿå•çº¯çš„å°†æŒ‡é’ˆå’Œæˆå‘˜å˜é‡æ‰€å çš„å†…å­˜ç›¸åŠ å³å¯å—ï¼Ÿä¸Šè¿°ä»£ç å®žé™…æ‰“å°çš„å†…å®¹æ˜¯16 16ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œpersonå¯¹è±¡å’Œstudentå¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´éƒ½ä¸º16ä¸ªå­—èŠ‚ã€‚å®žé™…ä¸Špersonå¯¹è±¡ç¡®å®žåªä½¿ç”¨äº†12ä¸ªå­—èŠ‚ã€‚ä½†æ˜¯å› ä¸ºå†…å­˜å¯¹é½çš„åŽŸå› ã€‚ä½¿personå¯¹è±¡ä¹Ÿå ç”¨16ä¸ªå­—èŠ‚ã€‚ ç¼–è¯‘å™¨åœ¨ç»™ç»“æž„ä½“å¼€è¾Ÿç©ºé—´æ—¶ï¼Œé¦–å…ˆæ‰¾åˆ°ç»“æž„ä½“ä¸­æœ€å®½çš„åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œç„¶åŽå¯»æ‰¾å†…å­˜åœ°å€èƒ½æ˜¯è¯¥åŸºæœ¬æ•°æ®ç±»åž‹çš„æ•´å€çš„ä½ç½®ï¼Œä½œä¸ºç»“æž„ä½“çš„é¦–åœ°å€ã€‚å°†è¿™ä¸ªæœ€å®½çš„åŸºæœ¬æ•°æ®ç±»åž‹çš„å¤§å°ä½œä¸ºå¯¹é½æ¨¡æ•°ã€‚ ä¸ºç»“æž„ä½“çš„ä¸€ä¸ªæˆå‘˜å¼€è¾Ÿç©ºé—´ä¹‹å‰ï¼Œç¼–è¯‘å™¨é¦–å…ˆæ£€æŸ¥é¢„å¼€è¾Ÿç©ºé—´çš„é¦–åœ°å€ç›¸å¯¹äºŽç»“æž„ä½“é¦–åœ°å€çš„åç§»æ˜¯å¦æ˜¯æœ¬æˆå‘˜çš„æ•´æ•°å€ï¼Œè‹¥æ˜¯ï¼Œåˆ™å­˜æ”¾æœ¬æˆå‘˜ï¼Œåä¹‹ï¼Œåˆ™åœ¨æœ¬æˆå‘˜å’Œä¸Šä¸€ä¸ªæˆå‘˜ä¹‹é—´å¡«å……ä¸€å®šçš„å­—èŠ‚ï¼Œä»¥è¾¾åˆ°æ•´æ•°å€çš„è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯å°†é¢„å¼€è¾Ÿç©ºé—´çš„é¦–åœ°å€åŽç§»å‡ ä¸ªå­—èŠ‚ã€‚ æˆ‘ä»¬å¯ä»¥æ€»ç»“å†…å­˜å¯¹é½ä¸ºä¸¤ä¸ªåŽŸåˆ™ï¼š å‰é¢çš„åœ°å€å¿…é¡»æ˜¯åŽé¢çš„åœ°å€æ•´æ•°å€,ä¸æ˜¯å°±è¡¥é½ã€‚ æ•´ä¸ªStructçš„åœ°å€å¿…é¡»æ˜¯æœ€å¤§å­—èŠ‚çš„æ•´æ•°å€ã€‚ é€šè¿‡ä¸Šè¿°å†…å­˜å¯¹é½çš„åŽŸåˆ™æˆ‘ä»¬æ¥çœ‹ï¼Œpersonå¯¹è±¡çš„ç¬¬ä¸€ä¸ªåœ°å€è¦å­˜æ”¾isaæŒ‡é’ˆéœ€è¦8ä¸ªå­—èŠ‚ï¼Œç¬¬äºŒä¸ªåœ°å€è¦å­˜æ”¾_ageæˆå‘˜å˜é‡éœ€è¦4ä¸ªå­—èŠ‚ï¼Œæ ¹æ®åŽŸåˆ™ä¸€ï¼Œ8æ˜¯4çš„æ•´æ•°å€ï¼Œç¬¦åˆåŽŸåˆ™ä¸€ï¼Œä¸éœ€è¦è¡¥é½ã€‚ç„¶åŽæ£€æŸ¥åŽŸåˆ™2ï¼Œç›®å‰personå¯¹è±¡å…±å æ®12ä¸ªå­—èŠ‚çš„å†…å­˜ï¼Œä¸æ˜¯æœ€å¤§å­—èŠ‚æ•°8ä¸ªå­—èŠ‚çš„æ•´æ•°å€ï¼Œæ‰€ä»¥éœ€è¦è¡¥é½4ä¸ªå­—èŠ‚ï¼Œå› æ­¤personå¯¹è±¡å°±å ç”¨16ä¸ªå­—èŠ‚ç©ºé—´ã€‚ è€Œå¯¹äºŽstudentå¯¹è±¡ï¼Œæˆ‘ä»¬çŸ¥é“sutdentå¯¹è±¡ä¸­ï¼ŒåŒ…å«personå¯¹è±¡çš„ç»“æž„ä½“å®žçŽ°ï¼Œå’Œä¸€ä¸ªintç±»åž‹çš„_noæˆå‘˜å˜é‡ï¼ŒåŒæ ·isaæŒ‡é’ˆ8ä¸ªå­—èŠ‚ï¼Œ_ageæˆå‘˜å˜é‡4ä¸ªå­—èŠ‚ï¼Œ_noæˆå‘˜å˜é‡4ä¸ªå­—èŠ‚ï¼Œåˆšå¥½æ»¡è¶³åŽŸåˆ™1å’ŒåŽŸåˆ™2ï¼Œæ‰€ä»¥studentå¯¹è±¡å æ®çš„å†…å­˜ç©ºé—´ä¹Ÿæ˜¯16ä¸ªå­—èŠ‚ã€‚ OCå¯¹è±¡çš„åˆ†ç±»OCå¯¹è±¡ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸‰ç§ instanceå¯¹è±¡ï¼ˆå®žä¾‹å¯¹è±¡ï¼‰ classå¯¹è±¡ï¼ˆç±»å¯¹è±¡ï¼‰ meta-classå¯¹è±¡ï¼ˆå…ƒç±»å¯¹è±¡ï¼‰ ä¸‹é¢æ¥ä¸€ä¸€ä»‹ç»ç€ä¸‰ç§å¯¹è±¡ã€‚ instanceå¯¹è±¡instanceå¯¹è±¡å°±æ˜¯é€šè¿‡ç±»allocå‡ºæ¥çš„å¯¹è±¡ï¼Œæ¯æ¬¡è°ƒç”¨allocéƒ½ä¼šäº§ç”Ÿæ–°çš„instanceå¯¹è±¡ 12NSObjcet *object1 = [[NSObjcet alloc] init];NSObjcet *object2 = [[NSObjcet alloc] init]; object1å’Œobject2éƒ½æ˜¯NSObjectçš„instaceå¯¹è±¡ï¼ˆå®žä¾‹å¯¹è±¡ï¼‰ï¼Œä½†ä»–ä»¬æ˜¯ä¸åŒçš„ä¸¤ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”åˆ†åˆ«å æ®ç€ä¸¤å—ä¸åŒçš„å†…å­˜ã€‚instanceå¯¹è±¡åœ¨å†…å­˜ä¸­å­˜å‚¨çš„ä¿¡æ¯åŒ…æ‹¬: isaæŒ‡é’ˆ å…¶ä»–æˆå‘˜å˜é‡ï¼ˆå®žé™…ä¸Šæ˜¯å­˜æ”¾æˆå‘˜å˜é‡å…·ä½“å€¼ï¼‰ ä½†æ˜¯ï¼Œåœ¨ä¸Šå›¾å®žä¾‹å¯¹è±¡ä¸­æ ¹æœ¬æ²¡æœ‰çœ‹åˆ°æ–¹æ³•ï¼Œé‚£ä¹ˆå®žä¾‹å¯¹è±¡çš„æ–¹æ³•çš„ä»£ç æ”¾åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿç±»çš„æ–¹æ³•çš„ä¿¡æ¯ï¼Œåè®®çš„ä¿¡æ¯ï¼Œå±žæ€§çš„ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿ classå¯¹è±¡æˆ‘ä»¬é€šè¿‡classæ–¹æ³•æˆ–runtimeæ–¹æ³•å¾—åˆ°ä¸€ä¸ªclasså¯¹è±¡ã€‚classå¯¹è±¡ä¹Ÿå°±æ˜¯ç±»å¯¹è±¡ã€‚ 12345678Class objectClass1 = [object1 class];Class objectClass2 = [object2 class];Class objectClass3 = [NSObject class];// runtimeClass objectClass4 = object_getClass(object1);Class objectClass5 = object_getClass(object2);NSLog(@"%p %p %p %p %p", objectClass1, objectClass2, objectClass3, objectClass4, objectClass5); æ¯ä¸€ä¸ªç±»åœ¨å†…å­˜ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªclasså¯¹è±¡ã€‚å¯ä»¥é€šè¿‡æ‰“å°å†…å­˜åœ°å€è¯æ˜Ž. classå¯¹è±¡åœ¨å†…å­˜ä¸­å­˜å‚¨çš„ä¿¡æ¯ä¸»è¦åŒ…æ‹¬: isaæŒ‡é’ˆ superclassæŒ‡é’ˆ ç±»çš„å±žæ€§ä¿¡æ¯ï¼ˆ@propertyï¼‰ï¼Œç±»çš„æˆå‘˜å˜é‡ä¿¡æ¯ï¼ˆivarï¼‰ ç±»çš„å¯¹è±¡æ–¹æ³•ä¿¡æ¯ï¼ˆinstance methodï¼‰ï¼Œç±»çš„åè®®ä¿¡æ¯ï¼ˆprotocolï¼‰ æˆå‘˜å˜é‡çš„å€¼æ—¶å­˜å‚¨åœ¨å®žä¾‹å¯¹è±¡ä¸­çš„ï¼Œå› ä¸ºåªæœ‰å½“æˆ‘ä»¬åˆ›å»ºå®žä¾‹å¯¹è±¡çš„æ—¶å€™æ‰ä¸ºæˆå‘˜å˜èµ‹å€¼ã€‚ä½†æ˜¯æˆå‘˜å˜é‡å«ä»€ä¹ˆåå­—ï¼Œæ˜¯ä»€ä¹ˆç±»åž‹ï¼Œåªéœ€è¦æœ‰ä¸€ä»½å°±å¯ä»¥äº†ã€‚æ‰€ä»¥å­˜å‚¨åœ¨classå¯¹è±¡ä¸­ã€‚ é‚£ä¹ˆï¼Œç±»æ–¹æ³•æ”¾åˆ°å“ªé‡Œçš„å‘¢ï¼Ÿ ####meta-classå¯¹è±¡ 1234567//runtimeä¸­ä¼ å…¥ç±»å¯¹è±¡æ­¤æ—¶å¾—åˆ°çš„å°±æ˜¯å…ƒç±»å¯¹è±¡Class objectMetaClass = object_getClass([NSObject class]);// è€Œè°ƒç”¨ç±»å¯¹è±¡çš„classæ–¹æ³•æ—¶å¾—åˆ°è¿˜æ˜¯ç±»å¯¹è±¡ï¼Œæ— è®ºè°ƒç”¨å¤šå°‘æ¬¡éƒ½æ˜¯ç±»å¯¹è±¡Class cls = [[NSObject class] class];Class objectClass3 = [NSObject class];class_isMetaClass(objectMetaClass) // åˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦ä¸ºå…ƒç±»å¯¹è±¡NSLog(@"%p %p %p", objectMetaClass, objectClass3, cls); // åŽé¢ä¸¤ä¸ªåœ°å€ç›¸åŒï¼Œè¯´æ˜Žå¤šæ¬¡è°ƒç”¨classå¾—åˆ°çš„è¿˜æ˜¯ç±»å¯¹è±¡ æ¯ä¸ªç±»åœ¨å†…å­˜ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªmeta-classå¯¹è±¡ã€‚meta-classå¯¹è±¡å’Œclasså¯¹è±¡çš„å†…å­˜ç»“æž„æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ç”¨é€”ä¸ä¸€æ ·ï¼Œåœ¨å†…å­˜ä¸­å­˜å‚¨çš„ä¿¡æ¯ä¸»è¦åŒ…æ‹¬: isaæŒ‡é’ˆ superclassæŒ‡é’ˆ ç±»çš„ç±»æ–¹æ³•çš„ä¿¡æ¯ï¼ˆclass methodï¼‰ meta-classå¯¹è±¡å’Œclasså¯¹è±¡çš„å†…å­˜ç»“æž„æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥meta-classä¸­ä¹Ÿæœ‰ç±»çš„å±žæ€§ä¿¡æ¯ï¼Œç±»çš„å¯¹è±¡æ–¹æ³•ä¿¡æ¯ç­‰æˆå‘˜å˜é‡ï¼Œä½†æ˜¯å…¶ä¸­çš„å€¼å¯èƒ½æ˜¯ç©ºçš„ã€‚ isaæŒ‡é’ˆå½“å¯¹è±¡è°ƒç”¨å®žä¾‹æ–¹æ³•çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸Šé¢è®²åˆ°ï¼Œå®žä¾‹æ–¹æ³•ä¿¡æ¯æ˜¯å­˜å‚¨åœ¨classç±»å¯¹è±¡ä¸­çš„ï¼Œé‚£ä¹ˆè¦æƒ³æ‰¾åˆ°å®žä¾‹æ–¹æ³•ï¼Œå°±å¿…é¡»æ‰¾åˆ°classç±»å¯¹è±¡ï¼Œé‚£ä¹ˆæ­¤æ—¶isaçš„ä½œç”¨å°±æ¥äº†ã€‚ instanceçš„isaæŒ‡å‘classï¼Œå½“è°ƒç”¨å¯¹è±¡æ–¹æ³•æ—¶ï¼Œé€šè¿‡instanceçš„isaæ‰¾åˆ°classï¼Œæœ€åŽæ‰¾åˆ°å¯¹è±¡æ–¹æ³•çš„å®žçŽ°è¿›è¡Œè°ƒç”¨ã€‚ å½“ç±»å¯¹è±¡è°ƒç”¨ç±»æ–¹æ³•çš„æ—¶å€™ï¼ŒåŒä¸Šï¼Œç±»æ–¹æ³•æ˜¯å­˜å‚¨åœ¨meta-classå…ƒç±»å¯¹è±¡ä¸­çš„ã€‚é‚£ä¹ˆè¦æ‰¾åˆ°ç±»æ–¹æ³•ï¼Œå°±éœ€è¦æ‰¾åˆ°meta-classå…ƒç±»å¯¹è±¡ï¼Œè€Œclassç±»å¯¹è±¡çš„isaæŒ‡é’ˆå°±æŒ‡å‘å…ƒç±»å¯¹è±¡ classçš„isaæŒ‡å‘meta-class,å½“è°ƒç”¨ç±»æ–¹æ³•æ—¶ï¼Œé€šè¿‡classçš„isaæ‰¾åˆ°meta-classï¼Œæœ€åŽæ‰¾åˆ°ç±»æ–¹æ³•çš„å®žçŽ°è¿›è¡Œè°ƒç”¨ å½“å¯¹è±¡è°ƒç”¨å…¶çˆ¶ç±»å¯¹è±¡æ–¹æ³•çš„æ—¶å€™ï¼Œåˆæ˜¯æ€Žä¹ˆæ‰¾åˆ°çˆ¶ç±»å¯¹è±¡æ–¹æ³•çš„å‘¢ï¼Ÿï¼Œæ­¤æ—¶å°±éœ€è¦ä½¿ç”¨åˆ°classç±»å¯¹è±¡superclassæŒ‡é’ˆã€‚ 12[stu personMethod];[stu init]; å½“Studentçš„instanceå¯¹è±¡è¦è°ƒç”¨Personçš„å¯¹è±¡æ–¹æ³•æ—¶ï¼Œä¼šå…ˆé€šè¿‡isaæ‰¾åˆ°Studentçš„classï¼Œç„¶åŽé€šè¿‡superclassæ‰¾åˆ°Personçš„classï¼Œæœ€åŽæ‰¾åˆ°å¯¹è±¡æ–¹æ³•çš„å®žçŽ°è¿›è¡Œè°ƒç”¨ï¼ŒåŒæ ·å¦‚æžœPersonå‘çŽ°è‡ªå·±æ²¡æœ‰å“åº”çš„å¯¹è±¡æ–¹æ³•ï¼Œåˆä¼šé€šè¿‡Personçš„superclassæŒ‡é’ˆæ‰¾åˆ°NSObjectçš„classå¯¹è±¡ï¼ŒåŽ»å¯»æ‰¾å“åº”çš„æ–¹æ³•ã€‚ å½“ç±»å¯¹è±¡è°ƒç”¨çˆ¶ç±»çš„ç±»æ–¹æ³•æ—¶ï¼Œå°±éœ€è¦å…ˆé€šè¿‡isaæŒ‡é’ˆæ‰¾åˆ°meta-classï¼Œç„¶åŽé€šè¿‡superclassåŽ»å¯»æ‰¾å“åº”çš„æ–¹æ³• 12[Student personClassMethod];[Student load]; å½“Studentçš„classè¦è°ƒç”¨Personçš„ç±»æ–¹æ³•æ—¶ï¼Œä¼šå…ˆé€šè¿‡isaæ‰¾åˆ°Studentçš„meta-classï¼Œç„¶åŽé€šè¿‡superclassæ‰¾åˆ°Personçš„meta-classï¼Œæœ€åŽæ‰¾åˆ°ç±»æ–¹æ³•çš„å®žçŽ°è¿›è¡Œè°ƒç”¨. æœ€åŽåˆæ˜¯è¿™å¼ é™å®šçš„isaæŒ‡å‘å›¾ï¼Œç»è¿‡ä¸Šé¢çš„åˆ†æžæˆ‘ä»¬åœ¨æ¥çœ‹è¿™å¼ å›¾ï¼Œå°±æ˜¾å¾—æ¸…æ™°æ˜Žäº†å¾ˆå¤šã€‚ å¯¹isaã€superclassæ€»ç»“ instanceçš„isaæŒ‡å‘class classçš„isaæŒ‡å‘meta-class meta-classçš„isaæŒ‡å‘åŸºç±»çš„meta-classï¼ŒåŸºç±»çš„isaæŒ‡å‘è‡ªå·± classçš„superclassæŒ‡å‘çˆ¶ç±»çš„classï¼Œå¦‚æžœæ²¡æœ‰çˆ¶ç±»ï¼ŒsuperclassæŒ‡é’ˆä¸ºnil meta-classçš„superclassæŒ‡å‘çˆ¶ç±»çš„meta-classï¼ŒåŸºç±»çš„meta-classçš„superclassæŒ‡å‘åŸºç±»çš„class instanceè°ƒç”¨å¯¹è±¡æ–¹æ³•çš„è½¨è¿¹ï¼Œisaæ‰¾åˆ°classï¼Œæ–¹æ³•ä¸å­˜åœ¨ï¼Œå°±é€šè¿‡superclassæ‰¾çˆ¶ç±» classè°ƒç”¨ç±»æ–¹æ³•çš„è½¨è¿¹ï¼Œisaæ‰¾meta-classï¼Œæ–¹æ³•ä¸å­˜åœ¨ï¼Œå°±é€šè¿‡superclassæ‰¾çˆ¶ç±» Classçš„ç»“æž„###Classåº•å±‚ç»“æž„ æˆ‘ä»¬çŸ¥é“ä¸ç®¡æ˜¯ç±»å¯¹è±¡è¿˜æ˜¯å…ƒç±»å¯¹è±¡ï¼Œç±»åž‹éƒ½æ˜¯Classï¼Œclasså’Œmete-classçš„åº•å±‚éƒ½æ˜¯objc_classç»“æž„ä½“çš„æŒ‡é’ˆï¼Œå†…å­˜ä¸­å°±æ˜¯ç»“æž„ä½“ã€‚ 12Class objectClass = [NSObject class]; Class objectMetaClass = object_getClass([NSObject class]); ç‚¹å‡»Classæ¥åˆ°å†…éƒ¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘çŽ° 1typedef struct objc_class *Class; Classå¯¹è±¡å…¶å®žæ˜¯ä¸€ä¸ªæŒ‡å‘objc_classç»“æž„ä½“çš„æŒ‡é’ˆã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥è¯´ç±»å¯¹è±¡æˆ–å…ƒç±»å¯¹è±¡åœ¨å†…å­˜ä¸­å…¶å®žå°±æ˜¯objc_classç»“æž„ä½“ã€‚ æˆ‘ä»¬æ¥åˆ°objc_classå†…éƒ¨ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ®µåœ¨åº•å±‚åŽŸç†ä¸­ç»å¸¸å‡ºçŽ°çš„ä»£ç ã€‚ 1234567891011121314151617struct objc_class &#123; Class _Nonnull isa OBJC_ISA_AVAILABILITY;#if !__OBJC2__ Class _Nullable super_class OBJC2_UNAVAILABLE; const char * _Nonnull name OBJC2_UNAVAILABLE; long version OBJC2_UNAVAILABLE; long info OBJC2_UNAVAILABLE; long instance_size OBJC2_UNAVAILABLE; struct objc_ivar_list * _Nullable ivars OBJC2_UNAVAILABLE; struct objc_method_list * _Nullable * _Nullable methodLists OBJC2_UNAVAILABLE; struct objc_cache * _Nonnull cache OBJC2_UNAVAILABLE; struct objc_protocol_list * _Nullable protocols OBJC2_UNAVAILABLE;#endif&#125; OBJC2_UNAVAILABLE;/* Use `Class` instead of `struct objc_class *` */ è¿™éƒ¨åˆ†ä»£ç ç›¸ä¿¡åœ¨æ–‡ç« ä¸­å¾ˆå¸¸è§ï¼Œä½†æ˜¯OBJC2_UNAVAILABLE;è¯´æ˜Žè¿™äº›ä»£ç å·²ç»ä¸åœ¨ä½¿ç”¨äº†ã€‚é‚£ä¹ˆç›®å‰objc_classçš„ç»“æž„æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡objcæºç ä¸­åŽ»æŸ¥æ‰¾objc_classç»“æž„ä½“çš„å†…å®¹ã€‚ æ‰“å¼€æˆ‘ä»¬åœ¨Runtime&amp;allocWithZoneæºç åˆ†æžç« èŠ‚ä¸­ä¸‹è½½çš„objc4æºç ï¼Œæœç´¢objc_classçš„å®žçŽ°éƒ¨åˆ†ï¼Œå¯ä»¥çœ‹åˆ°ä»£ç éžå¸¸é•¿ï¼Œä¸‹é¢è´´å‡ºæœ€ä¸»è¦çš„éƒ¨åˆ†ï¼š 12345678910struct objc_class : objc_object &#123; // Class ISA; Class superclass; cache_t cache; // formerly cache pointer and vtable class_data_bits_t bits; // class_rw_t * plus custom rr/alloc flags class_rw_t *data() &#123; return bits.data(); &#125;&#125; æˆ‘ä»¬å‘çŽ°è¿™ä¸ªç»“æž„ä½“ç»§æ‰¿ objc_object å¹¶ä¸”ç»“æž„ä½“å†…æœ‰ä¸€äº›å‡½æ•°ï¼Œå› ä¸ºè¿™æ˜¯c++ç»“æž„ä½“ï¼Œåœ¨cä¸Šåšäº†æ‰©å±•ï¼Œå› æ­¤ç»“æž„ä½“ä¸­å¯ä»¥åŒ…å«å‡½æ•°ã€‚æˆ‘ä»¬æ¥åˆ°objc_objectå†…ï¼Œæˆªå–éƒ¨åˆ†ä»£ç  123456789101112struct objc_object &#123;private: isa_t isa;public: // ISA() assumes this is NOT a tagged pointer object Class ISA(); // getIsa() allows this to be a tagged pointer object Class getIsa();&#125; æˆ‘ä»¬å‘çŽ°objc_objectä¸­æœ‰ä¸€ä¸ªisaæŒ‡é’ˆï¼Œé‚£ä¹ˆobjc_classç»§æ‰¿objc_objectï¼Œä¹Ÿå°±åŒæ ·æ‹¥æœ‰ä¸€ä¸ªisaæŒ‡é’ˆã€‚ é‚£ä¹ˆæˆ‘ä»¬ä¹‹å‰äº†è§£åˆ°çš„ï¼Œç±»ä¸­å­˜å‚¨çš„ç±»çš„æˆå‘˜å˜é‡ä¿¡æ¯ï¼Œå®žä¾‹æ–¹æ³•ï¼Œå±žæ€§åç­‰è¿™äº›ä¿¡æ¯åœ¨å“ªé‡Œå‘¢ã€‚æˆ‘ä»¬æ¥åˆ°class_rw_tä¸­ï¼Œæˆªå–éƒ¨åˆ†ä»£ç ï¼Œæˆ‘ä»¬å‘çŽ°class_rw_tä¸­å­˜å‚¨ç€æ–¹æ³•åˆ—è¡¨ï¼Œå±žæ€§åˆ—è¡¨ï¼Œåè®®åˆ—è¡¨ç­‰å†…å®¹ã€‚ 12345678910111213141516struct class_rw_t &#123; // Be warned that Symbolication knows the layout of this structure. uint32_t flags; uint32_t version; const class_ro_t *ro; method_array_t methods; //æ–¹æ³•åˆ—è¡¨ property_array_t properties;//å±žæ€§åˆ—è¡¨ protocol_array_t protocols;//åè®®åˆ—è¡¨ Class firstSubclass; Class nextSiblingClass; char *demangledName;&#125; è€Œclass_rw_tæ˜¯é€šè¿‡bitsè°ƒç”¨dataæ–¹æ³•å¾—æ¥çš„ï¼Œæˆ‘ä»¬æ¥åˆ°dataæ–¹æ³•å†…éƒ¨å®žçŽ°ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œdataå‡½æ•°å†…éƒ¨ä»…ä»…å¯¹bitsè¿›è¡Œ&amp;FAST_DATA_MASKæ“ä½œ 123class_rw_t* data() &#123; return (class_rw_t *)(bits &amp; FAST_DATA_MASK); &#125; è€Œæˆå‘˜å˜é‡ä¿¡æ¯åˆ™æ˜¯å­˜å‚¨åœ¨class_ro_tå†…éƒ¨ä¸­çš„ï¼Œæˆ‘ä»¬æ¥åˆ°class_ro_tå†…æŸ¥çœ‹ 12345678910111213141516171819202122struct class_ro_t &#123; uint32_t flags; uint32_t instanceStart; uint32_t instanceSize;#ifdef __LP64__ uint32_t reserved;#endif const uint8_t * ivarLayout; const char * name; method_list_t * baseMethodList; protocol_list_t * baseProtocols; const ivar_list_t * ivars; const uint8_t * weakIvarLayout; property_list_t *baseProperties; method_list_t *baseMethods() const &#123; return baseMethodList; &#125;&#125;; æœ€åŽæ€»ç»“é€šè¿‡ä¸€å¼ å›¾è¿›è¡Œæ€»ç»“: å®žè·µéªŒè¯æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªç»“æž„ä½“ï¼Œå¦‚æžœæˆ‘ä»¬è‡ªå·±å†™çš„ç»“æž„å’Œobjc_classçœŸå®žç»“æž„æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬å¼ºåˆ¶è½¬åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šä¸€ä¸€å¯¹åº”çš„èµ‹å€¼ã€‚æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°ç»“æž„ä½“å†…éƒ¨çš„ä¿¡æ¯ã€‚ ä¸‹åˆ—ä»£ç æ˜¯æˆ‘ä»¬ä»¿ç…§objc_classç»“æž„ä½“ï¼Œæå–å…¶ä¸­éœ€è¦ä½¿ç”¨åˆ°çš„ä¿¡æ¯ï¼Œè‡ªå®šä¹‰çš„ä¸€ä¸ªç»“æž„ä½“ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136#import &lt;Foundation/Foundation.h&gt;#ifndef SPClassInfo_h#define SPClassInfo_h# if __arm64__# define ISA_MASK 0x0000000ffffffff8ULL# elif __x86_64__# define ISA_MASK 0x00007ffffffffff8ULL# endif#if __LP64__typedef uint32_t mask_t;#elsetypedef uint16_t mask_t;#endiftypedef uintptr_t cache_key_t;struct bucket_t &#123; cache_key_t _key; IMP _imp;&#125;;struct cache_t &#123; bucket_t *_buckets; mask_t _mask; mask_t _occupied;&#125;;struct entsize_list_tt &#123; uint32_t entsizeAndFlags; uint32_t count;&#125;;struct method_t &#123; SEL name; const char *types; IMP imp;&#125;;struct method_list_t : entsize_list_tt &#123; method_t first;&#125;;struct ivar_t &#123; int32_t *offset; const char *name; const char *type; uint32_t alignment_raw; uint32_t size;&#125;;struct ivar_list_t : entsize_list_tt &#123; ivar_t first;&#125;;struct property_t &#123; const char *name; const char *attributes;&#125;;struct property_list_t : entsize_list_tt &#123; property_t first;&#125;;struct chained_property_list &#123; chained_property_list *next; uint32_t count; property_t list[0];&#125;;typedef uintptr_t protocol_ref_t;struct protocol_list_t &#123; uintptr_t count; protocol_ref_t list[0];&#125;;struct class_ro_t &#123; uint32_t flags; uint32_t instanceStart; uint32_t instanceSize; // instanceå¯¹è±¡å ç”¨çš„å†…å­˜ç©ºé—´#ifdef __LP64__ uint32_t reserved;#endif const uint8_t * ivarLayout; const char * name; // ç±»å method_list_t * baseMethodList; protocol_list_t * baseProtocols; const ivar_list_t * ivars; // æˆå‘˜å˜é‡åˆ—è¡¨ const uint8_t * weakIvarLayout; property_list_t *baseProperties;&#125;;struct class_rw_t &#123; uint32_t flags; uint32_t version; const class_ro_t *ro; method_list_t * methods; // æ–¹æ³•åˆ—è¡¨ property_list_t *properties; // å±žæ€§åˆ—è¡¨ const protocol_list_t * protocols; // åè®®åˆ—è¡¨ Class firstSubclass; Class nextSiblingClass; char *demangledName;&#125;;#define FAST_DATA_MASK 0x00007ffffffffff8ULstruct class_data_bits_t &#123; uintptr_t bits;public: class_rw_t* data() &#123; // æä¾›data()æ–¹æ³•è¿›è¡Œ &amp; FAST_DATA_MASK æ“ä½œ return (class_rw_t *)(bits &amp; FAST_DATA_MASK); &#125;&#125;;/* OCå¯¹è±¡ */struct sp_objc_object &#123; void *isa;&#125;;/* ç±»å¯¹è±¡ */struct sp_objc_class : sp_objc_object &#123; Class superclass; cache_t cache; class_data_bits_t bits;public: class_rw_t* data() &#123; return bits.data(); &#125; sp_objc_class* metaClass() &#123; // æä¾›metaClasså‡½æ•°ï¼ŒèŽ·å–å…ƒç±»å¯¹è±¡// ä¸Šä¸€ç¯‡æˆ‘ä»¬è®²è§£è¿‡ï¼ŒisaæŒ‡é’ˆéœ€è¦ç»è¿‡ä¸€æ¬¡ &amp; ISA_MASKæ“ä½œä¹‹åŽæ‰å¾—åˆ°çœŸæ­£çš„åœ°å€ return (sp_objc_class *)((long long)isa &amp; ISA_MASK); &#125;&#125;;#endif /* spClassInfo_h */ æŽ¥ä¸‹æ¥æˆ‘ä»¬å°†è‡ªå·±å®šä¹‰çš„ç±»å¼ºåˆ¶è½¬åŒ–ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„ç²¾ç®€çš„classç»“æž„ä½“ç±»åž‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465#import &lt;Foundation/Foundation.h&gt;#import &lt;objc/runtime.h&gt;#import "SPClassInfo.h"/* Person */@interface Person : NSObject &lt;NSCopying&gt;&#123; @public int _age;&#125;@property (nonatomic, assign) int height;- (void)personMethod;+ (void)personClassMethod;@end@implementation Person- (void)personMethod &#123;&#125;+ (void)personClassMethod &#123;&#125;@end/* Student */@interface Student : Person &lt;NSCoding&gt;&#123; @public int _no;&#125;@property (nonatomic, assign) int score;- (void)studentMethod;+ (void)studentClassMethod;@end@implementation Student- (void)studentMethod &#123;&#125;+ (void)studentClassMethod &#123;&#125;@endint main(int argc, const char * argv[]) &#123; @autoreleasepool &#123; NSObject *object = [[NSObject alloc] init]; Person *person = [[Person alloc] init]; Student *student = [[Student alloc] init]; sp_objc_class *objectClass = (__bridge sp_objc_class *)[object class]; sp_objc_class *personClass = (__bridge sp_objc_class *)[person class]; sp_objc_class *studentClass = (__bridge sp_objc_class *)[student class]; sp_objc_class *objectMetaClass = objectClass-&gt;metaClass(); sp_objc_class *personMetaClass = personClass-&gt;metaClass(); sp_objc_class *studentMetaClass = studentClass-&gt;metaClass(); class_rw_t *objectClassData = objectClass-&gt;data(); class_rw_t *personClassData = personClass-&gt;data(); class_rw_t *studentClassData = studentClass-&gt;data(); class_rw_t *objectMetaClassData = objectMetaClass-&gt;data(); class_rw_t *personMetaClassData = personMetaClass-&gt;data(); class_rw_t *studentMetaClassData = studentMetaClass-&gt;data(); // 0x00007ffffffffff8 NSLog(@"%p %p %p %p %p %p", objectClassData, personClassData, studentClassData, objectMetaClassData, personMetaClassData, studentMetaClassData); return 0;&#125; é€šè¿‡æ‰“æ–­ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°classå†…éƒ¨ä¿¡æ¯ã€‚ instanceå¯¹è±¡é¦–å…ˆæˆ‘ä»¬æ¥çœ‹instanceå¯¹è±¡ï¼Œæˆ‘ä»¬é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« çŸ¥é“ï¼Œinstanceå¯¹è±¡ä¸­å­˜å‚¨ç€isaæŒ‡é’ˆå’Œå…¶ä»–æˆå‘˜å˜é‡ï¼Œå¹¶ä¸”instanceå¯¹è±¡çš„isaæŒ‡é’ˆæ˜¯æŒ‡å‘å…¶ç±»å¯¹è±¡åœ°å€çš„ã€‚æˆ‘ä»¬é¦–å…ˆåˆ†æžä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬åˆ›å»ºçš„objectï¼Œpersonï¼Œstudentä¸‰ä¸ªinstanceå¯¹è±¡ä¸Žå…¶ç›¸å¯¹åº”çš„ç±»å¯¹è±¡objectClassï¼ŒpersonClassï¼ŒstudentClassã€‚ ä»Žä¸Šå›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘çŽ°instanceå¯¹è±¡ä¸­ç¡®å®žå­˜å‚¨äº†isaæŒ‡é’ˆå’Œå…¶æˆå‘˜å˜é‡ï¼ŒåŒæ—¶å°†instanceå¯¹è±¡çš„isaæŒ‡é’ˆç»è¿‡&amp;è¿ç®—ä¹‹åŽè®¡ç®—å‡ºçš„åœ°å€ç¡®å®žæ˜¯å…¶ç›¸åº”ç±»å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚ç”±æ­¤æˆ‘ä»¬è¯æ˜Žisaï¼ŒsuperclassæŒ‡å‘å›¾ä¸­çš„1ï¼Œ2ï¼Œ3å·çº¿ã€‚ classå¯¹è±¡æŽ¥ç€æˆ‘ä»¬æ¥çœ‹classå¯¹è±¡ï¼ŒåŒæ ·é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬æ˜Žç¡®classå¯¹è±¡ä¸­å­˜å‚¨ç€isaæŒ‡é’ˆï¼ŒsuperclassæŒ‡é’ˆï¼Œä»¥åŠç±»çš„å±žæ€§ä¿¡æ¯ï¼Œç±»çš„æˆå‘˜å˜é‡ä¿¡æ¯ï¼Œç±»çš„å¯¹è±¡æ–¹æ³•ï¼Œå’Œç±»çš„åè®®ä¿¡æ¯ï¼Œè€Œé€šè¿‡ä¸Šé¢å¯¹objectæºç çš„åˆ†æžï¼Œæˆ‘ä»¬çŸ¥é“è¿™äº›ä¿¡æ¯å­˜å‚¨åœ¨classå¯¹è±¡çš„class_rw_tä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å¼ºåˆ¶è½¬åŒ–æ¥çª¥æŽ¢å…¶ä¸­çš„å†…å®¹ã€‚å¦‚ä¸‹å›¾ ä¸Šå›¾ä¸­æˆ‘ä»¬é€šè¿‡æ¨¡æ‹Ÿå¯¹personç±»å¯¹è±¡è°ƒç”¨.dataå‡½æ•°ï¼Œå³å¯¹bitsè¿›è¡Œ&amp;FAST_DATA_MASK(0x00007ffffffffff8UL)è¿ç®—ï¼Œå¹¶è½¬åŒ–ä¸ºclass_rw_tã€‚å³ä¸Šå›¾ä¸­çš„personClassDataã€‚å…¶ä¸­æˆ‘ä»¬å‘çŽ°æˆå‘˜å˜é‡ä¿¡æ¯ï¼Œå¯¹è±¡æ–¹æ³•ï¼Œå±žæ€§ç­‰ä¿¡æ¯åªæ˜¾ç¤ºfirstç¬¬ä¸€ä¸ªï¼Œå¦‚æžœæƒ³è¦æ‹¿åˆ°æ›´å¤šçš„éœ€è¦é€šè¿‡ä»£ç å°†æŒ‡é’ˆåŽç§»èŽ·å–ã€‚è€Œä¸Šå›¾ä¸­çš„instaceSize = 16ä¹ŸåŒpersonå¯¹è±¡ä¸­isaæŒ‡é’ˆ8ä¸ªå­—èŠ‚+_age4ä¸ªå­—èŠ‚+_height4ä¸ªå­—èŠ‚ç›¸å¯¹åº”èµ·æ¥ã€‚è¿™é‡Œä¸åœ¨å±•å¼€å¯¹objectClassDataåŠstudentClassDataè¿›è¡Œåˆ†æžï¼ŒåŸºæœ¬å†…å®¹åŒpersonClassDataç›¸åŒã€‚ meta-classå¯¹è±¡æœ€åŽæˆ‘ä»¬æ¥çœ‹meta-classå…ƒç±»å¯¹è±¡ï¼Œä¸Šæ–‡æåˆ°meta-classä¸­å­˜å‚¨ç€isaæŒ‡é’ˆï¼ŒsuperclassæŒ‡é’ˆï¼Œä»¥åŠç±»çš„ç±»æ–¹æ³•ä¿¡æ¯ã€‚åŒæ—¶æˆ‘ä»¬çŸ¥é“meta-classå…ƒç±»å¯¹è±¡ä¸Žclassç±»å¯¹è±¡ï¼Œå…·æœ‰ç›¸åŒçš„ç»“æž„ï¼Œåªä¸è¿‡å­˜å‚¨çš„ä¿¡æ¯ä¸åŒï¼Œå¹¶ä¸”å…ƒç±»å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘åŸºç±»çš„å…ƒç±»å¯¹è±¡ï¼ŒåŸºç±»çš„å…ƒç±»å¯¹è±¡çš„isaæŒ‡é’ˆæŒ‡å‘è‡ªå·±ã€‚å…ƒç±»å¯¹è±¡çš„superclassæŒ‡é’ˆæŒ‡å‘å…¶çˆ¶ç±»çš„å…ƒç±»å¯¹è±¡ï¼ŒåŸºç±»çš„å…ƒç±»å¯¹è±¡çš„superclassæŒ‡é’ˆæŒ‡å‘å…¶ç±»å¯¹è±¡ã€‚ ä¸Žclasså¯¹è±¡ç›¸åŒï¼Œæˆ‘ä»¬åŒæ ·é€šè¿‡æ¨¡æ‹Ÿå¯¹personå…ƒç±»å¯¹è±¡è°ƒç”¨.dataå‡½æ•°ï¼Œå³å¯¹bitsè¿›è¡Œ&amp;FAST_DATA_MASK(0x00007ffffffffff8UL)è¿ç®—ï¼Œå¹¶è½¬åŒ–ä¸ºclass_rw_tã€‚ é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æž„åŒpersonClassDataç›¸åŒï¼Œå¹¶ä¸”æˆå‘˜å˜é‡åŠå±žæ€§åˆ—è¡¨ç­‰ä¿¡æ¯ä¸ºç©ºï¼Œè€Œmethodsä¸­å­˜å‚¨ç€ç±»æ–¹æ³•personClassMethodã€‚ æŽ¥ç€æ¥éªŒè¯isaåŠsuperclassæŒ‡é’ˆçš„æŒ‡å‘æ˜¯å¦åŒä¸Šå›¾åºå·æ ‡æ³¨ä¸€æ ·ã€‚ ä¸Šå›¾ä¸­é€šè¿‡åœ°å€è¯æ˜Žmeta-classçš„isaæŒ‡å‘åŸºç±»çš„meta-classï¼ŒåŸºç±»çš„isaæŒ‡é’ˆä¹ŸæŒ‡å‘è‡ªå·±ã€‚ ä¸Šå›¾ä¸­é€šè¿‡åœ°å€è¯æ˜Žmeta-classçš„superclassæŒ‡å‘çˆ¶ç±»çš„meta-classï¼ŒåŸºç±»çš„meta-classçš„superclassæŒ‡å‘åŸºç±»çš„classç±»ã€‚]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>OCæœ¬è´¨</tag>
        <tag>å…ƒç±»</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CoreText æ¡†æž¶]]></title>
    <url>%2F2018%2F06%2F21%2FCoreText%2F</url>
    <content type="text"><![CDATA[CoreText æ¡†æž¶å‰è¨€æ–‡ç« å‚è€ƒè‡ªå”å·§ã€ŠiOSå¼€å‘è¿›é˜¶ã€‹ï¼Œå¯¹å…¶ä¸­çš„ç»†èŠ‚éš¾ç‚¹è¿›è¡Œäº†è¡¥å……è¯´æ˜Žã€‚ ä½¿ç”¨ CoreText æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å¯Œæ–‡æœ¬è¿›è¡Œå¤æ‚çš„æŽ’ç‰ˆã€‚ç»è¿‡ä¸€äº›ç®€å•çš„æ‰©å±•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®žçŽ°å¯¹äºŽå›¾ç‰‡ï¼Œé“¾æŽ¥çš„ç‚¹å‡»æ•ˆæžœã€‚CoreText æŠ€æœ¯ç›¸å¯¹äºŽ UIWebViewï¼Œæœ‰ç€æ›´å°‘çš„å†…å­˜å ç”¨ï¼Œä»¥åŠå¯ä»¥åœ¨åŽå°æ¸²æŸ“çš„ä¼˜ç‚¹ï¼Œéžå¸¸é€‚åˆç”¨äºŽå†…å®¹çš„æŽ’ç‰ˆå·¥ä½œã€‚ CoreText ç®€ä»‹CoreText æ˜¯ç”¨äºŽå¤„ç†æ–‡å­—å’Œå­—ä½“çš„åº•å±‚æŠ€æœ¯ã€‚å®ƒç›´æŽ¥å’Œ Core Graphicsï¼ˆåˆè¢«ç§°ä¸º Quartzï¼‰æ‰“äº¤é“ã€‚Quartz æ˜¯ä¸€ä¸ª 2D å›¾å½¢æ¸²æŸ“å¼•æ“Žï¼Œèƒ½å¤Ÿå¤„ç† OSX å’Œ iOS ä¸­çš„å›¾å½¢æ˜¾ç¤ºã€‚ Quartz èƒ½å¤Ÿç›´æŽ¥å¤„ç†å­—ä½“ï¼ˆfontï¼‰å’Œå­—å½¢ï¼ˆglyphsï¼‰ï¼Œå°†æ–‡å­—æ¸²æŸ“åˆ°ç•Œé¢ä¸Šï¼Œå®ƒæ˜¯åŸºç¡€åº“ä¸­å”¯ä¸€èƒ½å¤Ÿå¤„ç†å­—å½¢çš„æ¨¡å—ã€‚å› æ­¤ï¼ŒCoreText ä¸ºäº†æŽ’ç‰ˆï¼Œéœ€è¦å°†æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹ã€ä½ç½®ã€å­—ä½“ã€å­—å½¢ç›´æŽ¥ä¼ é€’ç»™ Quartzã€‚ç›¸æ¯”å…¶å®ƒ UI ç»„ä»¶ï¼Œç”±äºŽ CoreText ç›´æŽ¥å’Œ Quartz æ¥äº¤äº’ï¼Œæ‰€ä»¥å®ƒå…·æœ‰é«˜é€Ÿçš„æŽ’ç‰ˆæ•ˆæžœã€‚ ä¸‹å›¾æ˜¯ CoreText çš„æž¶æž„å›¾ï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒCoreText å¤„äºŽéžå¸¸åº•å±‚çš„ä½ç½®ï¼Œä¸Šå±‚çš„ UI æŽ§ä»¶ï¼ˆåŒ…æ‹¬ UILabelï¼ŒUITextField ä»¥åŠ UITextViewï¼‰å’Œ UIWebView éƒ½æ˜¯åŸºäºŽ CoreText æ¥å®žçŽ°çš„ã€‚ æ³¨æ„ï¼šè¿™ä¸ªæ˜¯ iOS7 ä¹‹åŽçš„æž¶æž„å›¾ï¼Œåœ¨ iOS7 ä»¥å‰ï¼Œå¹¶æ²¡æœ‰å›¾ä¸­çš„ Text Kit ç±»ï¼Œä¸è¿‡ CoreText ä»ç„¶æ˜¯å¤„åœ¨æœ€åº•å±‚ç›´æŽ¥å’Œ Core Graphics æ‰“äº¤é“çš„æ¨¡å—ã€‚ UIWebView ä¹Ÿæ˜¯å¤„ç†å¤æ‚çš„æ–‡å­—æŽ’ç‰ˆçš„å¤‡é€‰æ–¹æ¡ˆã€‚å¯¹äºŽæŽ’ç‰ˆï¼ŒåŸºäºŽ CoreText å’ŒåŸºäºŽ UIWebView ç›¸æ¯”ï¼Œå‰è€…æœ‰ä»¥ä¸‹å¥½å¤„ï¼š CoreText å ç”¨çš„å†…å­˜æ›´å°‘ï¼Œæ¸²æŸ“é€Ÿåº¦å¿«ï¼ŒUIWebView å ç”¨çš„å†…å­˜æ›´å¤šï¼Œæ¸²æŸ“é€Ÿåº¦æ…¢ã€‚ CoreText åœ¨æ¸²æŸ“ç•Œé¢å‰å°±å¯ä»¥ç²¾ç¡®åœ°èŽ·å¾—æ˜¾ç¤ºå†…å®¹çš„é«˜åº¦ï¼ˆåªè¦æœ‰äº† CTFrame å³å¯ï¼‰ï¼Œè€Œ UIWebView åªæœ‰æ¸²æŸ“å‡ºå†…å®¹åŽï¼Œæ‰èƒ½èŽ·å¾—å†…å®¹çš„é«˜åº¦ï¼ˆè€Œä¸”è¿˜éœ€è¦ç”¨ javascript ä»£ç æ¥èŽ·å–ï¼‰ CoreText çš„ CTFrame å¯ä»¥åœ¨åŽå°çº¿ç¨‹æ¸²æŸ“ï¼ŒUIWebView çš„å†…å®¹åªèƒ½åœ¨ä¸»çº¿ç¨‹ï¼ˆUI çº¿ç¨‹ï¼‰æ¸²æŸ“ã€‚ åŸºäºŽ CoreText å¯ä»¥åšæ›´å¥½çš„åŽŸç”Ÿäº¤äº’æ•ˆæžœï¼Œäº¤äº’æ•ˆæžœå¯ä»¥æ›´ç»†è…»ã€‚è€Œ UIWebView çš„äº¤äº’æ•ˆæžœéƒ½æ˜¯ç”¨ javascript æ¥å®žçŽ°çš„ï¼Œåœ¨äº¤äº’æ•ˆæžœä¸Šä¼šæœ‰ä¸€äº›å¡é¡¿å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ UIWebView ä¸‹ï¼Œä¸€ä¸ªç®€å•çš„æŒ‰é’®æŒ‰ä¸‹æ•ˆæžœï¼Œéƒ½æ— æ³•åšåˆ°åŽŸç”ŸæŒ‰é’®çš„å³æ—¶å’Œç»†è…»çš„æŒ‰ä¸‹æ•ˆæžœã€‚ å½“ç„¶ï¼ŒåŸºäºŽ CoreText çš„æŽ’ç‰ˆæ–¹æ¡ˆä¹Ÿæœ‰ä¸€äº›åŠ£åŠ¿ï¼š CoreText æ¸²æŸ“å‡ºæ¥çš„å†…å®¹ä¸èƒ½åƒ UIWebView é‚£æ ·æ–¹ä¾¿åœ°æ”¯æŒå†…å®¹çš„å¤åˆ¶ã€‚ åŸºäºŽ CoreText æ¥æŽ’ç‰ˆéœ€è¦è‡ªå·±å¤„ç†å¾ˆå¤šå¤æ‚é€»è¾‘ï¼Œä¾‹å¦‚éœ€è¦è‡ªå·±å¤„ç†å›¾ç‰‡ä¸Žæ–‡å­—æ··æŽ’ç›¸å…³çš„é€»è¾‘ï¼Œä¹Ÿéœ€è¦è‡ªå·±å®žçŽ°é“¾æŽ¥ç‚¹å‡»æ“ä½œçš„æ”¯æŒã€‚ CoreTextåŸºæœ¬ç”¨æ³•èƒŒæ™¯çŸ¥è¯†å­—ä½“ï¼ˆFontï¼‰å’Œæˆ‘ä»¬å¹³æ—¶è¯´çš„å­—ä½“ä¸åŒï¼Œè®¡ç®—æœºæ„ä¹‰ä¸Šçš„å­—ä½“è¡¨ç¤ºçš„æ˜¯åŒä¸€å¤§å°ï¼ŒåŒä¸€æ ·å¼(Style)å­—å½¢çš„é›†åˆã€‚ä»Žè¿™ä¸ªæ„ä¹‰ä¸Šæ¥è¯´ï¼Œå½“æˆ‘ä»¬ä¸ºæ–‡å­—è®¾ç½®ç²—ä½“ï¼Œæ–œä½“æ—¶å…¶å®žæ˜¯ä½¿ç”¨äº†å¦å¤–ä¸€ç§å­—ä½“(ä¸‹åˆ’çº¿ä¸ç®—)ã€‚è€Œå¹³æ—¶æˆ‘ä»¬æ‰€è¯´çš„å­—ä½“åªæ˜¯å…·æœ‰ç›¸åŒè®¾è®¡å±žæ€§çš„å­—ä½“é›†åˆï¼Œå³Font Familyæˆ–typefaceã€‚ å­—ç¬¦(Character)å’Œå­—å½¢(Glyphs)æŽ’ç‰ˆè¿‡ç¨‹ä¸­ä¸€ä¸ªé‡è¦çš„æ­¥éª¤å°±æ˜¯ä»Žå­—ç¬¦åˆ°å­—å½¢çš„è½¬æ¢ï¼Œå­—ç¬¦è¡¨ç¤ºä¿¡æ¯æœ¬èº«ï¼Œè€Œå­—å½¢æ˜¯å®ƒçš„å›¾å½¢è¡¨çŽ°å½¢å¼ã€‚å­—ç¬¦ä¸€èˆ¬å°±æ˜¯æŒ‡æŸç§ç¼–ç ï¼Œå¦‚Unicodeç¼–ç ï¼Œè€Œå­—å½¢åˆ™æ˜¯è¿™äº›ç¼–ç å¯¹åº”çš„å›¾ç‰‡ã€‚ä½†æ˜¯ä»–ä»¬ä¹‹é—´ä¸æ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»ï¼ŒåŒä¸ªå­—ç¬¦çš„ä¸åŒå­—ä½“æ—ï¼Œä¸åŒå­—ä½“å¤§å°ï¼Œä¸åŒå­—ä½“æ ·å¼éƒ½å¯¹åº”äº†ä¸åŒçš„å­—å½¢ã€‚è€Œç”±äºŽè¿žå†™(Ligatures)çš„å­˜åœ¨ï¼Œå¤šä¸ªå­—ç¬¦ä¹Ÿä¼šå­˜åœ¨å¯¹åº”ä¸€ä¸ªå­—å½¢çš„æƒ…å†µã€‚ ä¸‹é¢å°±æ¥è¯¦ç»†çœ‹çœ‹å­—å½¢çš„å„ä¸ªå‚æ•°ä¹Ÿå°±æ˜¯æ‰€è°“çš„å­—å½¢åº¦é‡Glyph Metrics è¾¹ç•Œæ¡† bbox(bounding box) è¿™æ˜¯ä¸€ä¸ªå‡æƒ³çš„æ¡†å­ï¼Œå®ƒå°½å¯èƒ½ç´§å¯†çš„è£…å…¥å­—å½¢ã€‚ åŸºçº¿(baseline) ä¸€æ¡å‡æƒ³çš„çº¿,ä¸€è¡Œä¸Šçš„å­—å½¢éƒ½ä»¥æ­¤çº¿ä½œä¸ºä¸Šä¸‹ä½ç½®çš„å‚è€ƒï¼Œåœ¨è¿™æ¡çº¿çš„å·¦ä¾§å­˜åœ¨ä¸€ä¸ªç‚¹å«åšåŸºçº¿çš„åŽŸç‚¹ï¼Œ ä¸Šè¡Œé«˜åº¦(ascent) ä»ŽåŽŸç‚¹åˆ°å­—ä½“ä¸­æœ€é«˜ï¼ˆè¿™é‡Œçš„é«˜æ·±éƒ½æ˜¯ä»¥åŸºçº¿ä¸ºå‚ç…§çº¿çš„ï¼‰çš„å­—å½¢çš„é¡¶éƒ¨çš„è·ç¦»ï¼Œascentæ˜¯ä¸€ä¸ªæ­£å€¼ ä¸‹è¡Œé«˜åº¦(descent) ä»ŽåŽŸç‚¹åˆ°å­—ä½“ä¸­æœ€æ·±çš„å­—å½¢åº•éƒ¨çš„è·ç¦»ï¼Œdescentæ˜¯ä¸€ä¸ªè´Ÿå€¼ï¼ˆæ¯”å¦‚ä¸€ä¸ªå­—ä½“åŽŸç‚¹åˆ°æœ€æ·±çš„å­—å½¢çš„åº•éƒ¨çš„è·ç¦»ä¸º2ï¼Œé‚£ä¹ˆdescentå°±ä¸º-2ï¼‰ è¡Œè·(line gap) line gapä¹Ÿå¯ä»¥ç§°ä½œleadingï¼ˆå…¶å®žå‡†ç¡®ç‚¹è®²åº”è¯¥å«åšExternal leadingï¼‰,è¡Œé«˜line Heightåˆ™å¯ä»¥é€šè¿‡ ascent + |descent| + linegap æ¥è®¡ç®—ã€‚ å­—é—´è·(Kerning) å­—ä¸Žå­—ä¹‹é—´çš„è·ç¦»ï¼Œä¸ºäº†æŽ’ç‰ˆçš„ç¾Žè§‚ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å­—å½¢ä¹‹é—´çš„è·ç¦»éƒ½æ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯è¿™ä¸ªåŸºæœ¬æ­¥å½±å“åˆ°æˆ‘ä»¬çš„æ–‡å­—æŽ’ç‰ˆã€‚ åŸºç¡€åŽŸç‚¹(Origin) åŸºçº¿ä¸Šæœ€å·¦ä¾§çš„ç‚¹ã€‚ çº¢æ¡†é«˜åº¦æ—¢ä¸ºå½“å‰è¡Œçš„è¡Œé«˜ï¼Œç»¿çº¿ä¸ºbaselineï¼Œç»¿è‰²åˆ°çº¢æ¡†ä¸Šéƒ¨åˆ†ä¸ºå½“å‰è¡Œçš„æœ€å¤§Ascentï¼Œç»¿çº¿åˆ°é»„çº¿ä¸ºå½“å‰è¡Œçš„æœ€å¤§Desentï¼Œè€Œé»„æ¡†çš„é«˜å³ä¸ºè¡Œé—´è·ã€‚ç”±æ­¤å¯ä»¥å¾—å‡ºï¼šlineHeight = Ascent + |Decent| + Leadingã€‚ åæ ‡ç³»ä¼ ç»Ÿçš„Macä¸­çš„åæ ‡ç³»çš„åŽŸç‚¹åœ¨å·¦ä¸‹è§’ï¼Œæ¯”å¦‚NSViewé»˜è®¤çš„åæ ‡ç³»ï¼ŒåŽŸç‚¹å°±åœ¨å·¦ä¸‹è§’ã€‚ä½†Macä¸­æœ‰äº›Viewä¸ºäº†å…¶å®žçŽ°çš„ä¾¿æ·å°†åŽŸç‚¹å˜æ¢åˆ°å·¦ä¸Šè§’ï¼ŒåƒNSTableViewçš„åæ ‡ç³»åæ ‡åŽŸç‚¹å°±åœ¨å·¦ä¸Šè§’ã€‚ iOS UIKitä¸­ï¼ŒUIViewæ˜¯ä»¥å·¦ä¸Šè§’ä¸ºåŽŸç‚¹ï¼Œè€ŒCore Textä¸€å¼€å§‹çš„å®šä½æ˜¯ä½¿ç”¨ä¸Žæ¡Œé¢åº”ç”¨çš„æŽ’ç‰ˆç³»ç»Ÿï¼Œæ¡Œé¢åº”ç”¨çš„åæ ‡ç³»æ˜¯ä»¥å·¦ä¸‹è§’ä¸ºåŽŸç‚¹ï¼Œå³Core Textåœ¨ç»˜åˆ¶çš„æ—¶å€™ä¹Ÿæ˜¯å‚ç…§å·¦ä¸‹è§’ä¸ºåŽŸç‚¹è¿›è¡Œç»˜åˆ¶çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹å½“å‰çš„åæ ‡ç³»è¿›è¡Œå¤„ç† 123456789//å› ä¸ºCore Textè¦é…åˆCore Graphic é…åˆä½¿ç”¨çš„ï¼Œå¦‚Core Graphicä¸€æ ·ï¼Œç»˜å›¾çš„æ—¶å€™éœ€è¦èŽ·å¾—å½“å‰çš„ä¸Šä¸‹æ–‡è¿›è¡Œç»˜åˆ¶CGContextRef context = UIGraphicsGetCurrentContext();//ç¿»è½¬å½“å‰çš„åæ ‡ç³»ï¼ˆå› ä¸ºå¯¹äºŽåº•å±‚ç»˜åˆ¶å¼•æ“Žæ¥è¯´ï¼Œå±å¹•å·¦ä¸‹è§’ä¸ºï¼ˆ0ï¼Œ0ï¼‰ï¼‰//è®¾ç½®æ–‡æœ¬ä¸è¿›è¡Œå˜æ¢CGContextSetTextMatrix(context, CGAffineTransformIdentity);//å‘ä¸‹å¹³ç§»æ•´ä¸ªç”»å¸ƒå•ä½CGContextTranslateCTM(context, 0, self.bounds.size.height);//å¯¹å¹³ç§»åŽçš„ç”»å¸ƒè¿›è¡Œç¿»è½¬CGContextScaleCTM(context, 1.0, -1.0); CoreTextå¯¹è±¡æ¨¡åž‹ CTFramesetterRef é€šè¿‡CFAttributedStringRefè¿›è¡Œåˆå§‹åŒ–ï¼Œå®ƒä½œä¸ºCTFrameå¯¹è±¡çš„ç”Ÿäº§å·¥åŽ‚ï¼Œè´Ÿè´£æ ¹æ®pathç”Ÿäº§å¯¹åº”çš„CTFrameï¼› CTFrame CTFrameæ˜¯å¯ä»¥é€šè¿‡CTFrameDrawå‡½æ•°ç›´æŽ¥ç»˜åˆ¶åˆ°contextä¸Šçš„ï¼Œå½“ç„¶ä½ å¯ä»¥åœ¨ç»˜åˆ¶ä¹‹å‰ï¼Œæ“ä½œCTFrameä¸­çš„CTLineï¼Œè¿›è¡Œä¸€äº›å‚æ•°çš„å¾®è°ƒï¼› CTLine åœ¨CTFrameå†…éƒ¨æ˜¯ç”±å¤šä¸ªCTLineæ¥ç»„æˆçš„ï¼Œæ¯ä¸ªCTLineä»£è¡¨ä¸€è¡Œï¼›å¯ä»¥çœ‹åšCore Textç»˜åˆ¶ä¸­çš„ä¸€è¡Œçš„å¯¹è±¡ï¼Œé€šè¿‡å®ƒå¯ä»¥èŽ·å¾—å½“å‰è¡Œçš„line ascent,line descent ,line leading,è¿˜å¯ä»¥èŽ·å¾—Lineä¸‹çš„æ‰€æœ‰Glyph Runsï¼› CTRun æˆ–è€…å«åš Glyph Runï¼Œæ¯ä¸ªCTLineåˆæ˜¯ç”±å¤šä¸ªCTRunç»„æˆçš„ï¼Œæ¯ä¸ªCTRunä»£è¡¨ä¸€ç»„æ˜¾ç¤ºé£Žæ ¼ä¸€è‡´çš„æ–‡æœ¬ï¼Œæ˜¯ä¸€ç»„å…±äº«æƒ³ç›¸åŒattributesï¼ˆå±žæ€§ï¼‰çš„å­—å½¢çš„é›†åˆä½“ï¼› æ€»ç»“ï¼š CTFramesetteræ˜¯ç”±CFAttributedString(NSAttributedString)åˆå§‹åŒ–è€Œæ¥ï¼Œå¯ä»¥è®¤ä¸ºå®ƒæ˜¯CTFrameçš„ä¸€ä¸ªFactoryï¼Œé€šè¿‡ä¼ å…¥CGPathç”Ÿæˆç›¸åº”çš„CTFrameå¹¶ä½¿ç”¨å®ƒè¿›è¡Œæ¸²æŸ“ï¼šç›´æŽ¥ä»¥CTFrameä¸ºå‚æ•°ä½¿ç”¨CTFrameDrawç»˜åˆ¶æˆ–è€…ä»ŽCTFrameä¸­èŽ·å–CTLineè¿›è¡Œå¾®è°ƒåŽä½¿ç”¨CTLineDrawè¿›è¡Œç»˜åˆ¶ã€‚CTFrame ä½œä¸ºä¸€ä¸ªæ•´ä½“çš„ç”»å¸ƒ(Canvas)ï¼Œå…¶ä¸­ç”±è¡Œ(CTLine)ç»„æˆï¼Œè€Œæ¯è¡Œå¯ä»¥åˆ†ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå°æ–¹å—ï¼ˆCTRunï¼‰ã€‚ æ³¨æ„ï¼šä½ ä¸éœ€è¦è‡ªå·±åˆ›å»ºCTRunï¼ŒCore Textå°†æ ¹æ®NSAttributedStringçš„å±žæ€§æ¥è‡ªåŠ¨åˆ›å»ºCTRunã€‚æ¯ä¸ªCTRunå¯¹è±¡å¯¹åº”ä¸åŒçš„å±žæ€§ï¼Œæ­£å› æ­¤ï¼Œä½ å¯ä»¥è‡ªç”±çš„æŽ§åˆ¶å­—ä½“ã€é¢œè‰²ã€å­—é—´è·ç­‰ç­‰ä¿¡æ¯ã€‚ é€šå¸¸çš„å¤„ç†æ­¥éª¤ èŽ·å–ä¸Šä¸‹æ–‡ ç¿»è½¬åæ ‡ç³» åˆ›å»ºNSAttributedString æ ¹æ®NSAttributedStringåˆ›å»ºCTFramesetterRef åˆ›å»ºç»˜åˆ¶åŒºåŸŸCGPathRefï¼ˆè¯¥CGPathRefæ˜¯åº“CoreGraphicsé‡Œè¾¹çš„ï¼Œåˆå§‹åŽŸç‚¹ä¸ºå·¦ä¸Šè§’ï¼›ç¿»è½¬åŽï¼ŒåŽŸç‚¹ä¸ºå·¦ä¸‹è§’ï¼‰ æ ¹æ®CTFramesetterRefå’ŒCGPathRefåˆ›å»ºCTFrame CTFrameDrawç»˜åˆ¶ã€‚ CoreTextç¤ºä¾‹ç¨‹åºé¦–å…ˆä»Žä¸€ä¸ªç®€å•çš„ç»˜åˆ¶æ–‡å­—ç¤ºä¾‹å¼€å§‹ï¼š è‡ªå®šä¹‰ä¸€ä¸ªCTDisplayViewï¼Œè®©å…¶ import å¤´æ–‡ä»¶CoreText/CoreText.hï¼ŒæŽ¥ç€è¾“å…¥ä»¥ä¸‹ä»£ç æ¥å®žçŽ°å…¶drawRectæ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839#import &quot;CTDisplayView.h&quot;#import &quot;CoreText/CoreText.h&quot;@implementation CTDisplayView- (void)drawRect:(CGRect)rect&#123; [super drawRect:rect]; // æ­¥éª¤ 1 //å› ä¸ºCore Textè¦é…åˆCore Graphic é…åˆä½¿ç”¨çš„ï¼Œå¦‚Core Graphicä¸€æ ·ï¼Œç»˜å›¾çš„æ—¶å€™éœ€è¦èŽ·å¾—å½“å‰çš„ä¸Šä¸‹æ–‡ è¿›è¡Œç»˜åˆ¶ CGContextRef context = UIGraphicsGetCurrentContext(); // æ­¥éª¤ 2 //ç¿»è½¬å½“å‰çš„åæ ‡ç³»ï¼ˆå› ä¸ºå¯¹äºŽåº•å±‚ç»˜åˆ¶å¼•æ“Žæ¥è¯´ï¼Œå±å¹•å·¦ä¸‹è§’ä¸ºï¼ˆ0ï¼Œ0ï¼‰ï¼‰ //è®¾ç½®æ–‡æœ¬ä¸è¿›è¡Œå˜æ¢ CGContextSetTextMatrix(context, CGAffineTransformIdentity); //å‘ä¸‹å¹³ç§»æ•´ä¸ªç”»å¸ƒå•ä½ CGContextTranslateCTM(context, 0, self.bounds.size.height); //å¯¹å¹³ç§»åŽçš„ç”»å¸ƒè¿›è¡Œç¿»è½¬ CGContextScaleCTM(context, 1.0, -1.0); // æ­¥éª¤ 3 //åˆ›å»ºç”»å¸ƒè¾¹æ¡†è·¯å¾„ CGMutablePathRef path = CGPathCreateMutable(); CGPathAddRect(path, NULL, self.bounds); // æ­¥éª¤ 4 NSAttributedString *attString = [[NSAttributedString alloc] initWithString:@&quot;Hello World!&quot;]; //é€šè¿‡NSAttributedStringåˆ›å»ºframesetter CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)attString); //åˆ›å»ºCTFrameå¯¹è±¡ï¼Œè¿™é‡Œç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªRangeèŒƒå›´ç”¨æ¥ç¡®å®šframesetterã€‚ä¸€èˆ¬ä¼ å…¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¦‚æžœè®¾ä¸º0çš„è¯é‚£ä¹ˆframesetterå°†ç»§ç»­æ·»åŠ è¡Œç›´åˆ°å®ƒç”¨å®Œæ–‡æœ¬æˆ–ç©ºé—´ã€‚ç¬¬å››ä¸ªå‚æ•°ä¸ºå…¶ä»–å±žæ€§ï¼Œä¸€èˆ¬ä¸éœ€è¦ï¼Œè®¾ä¸ºNULLå³å¯ã€‚ CTFrameRef frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, [attString length]), path, NULL); // æ­¥éª¤ 5 ç»˜åˆ¶ CTFrameDraw(frame, context); // æ­¥éª¤ 6 //CoreFoundationéœ€è¦è‡ªå·±æ‰‹åŠ¨ç®¡ç†å†…å­˜ CFRelease(frame); CFRelease(path); CFRelease(framesetter);&#125;@end è¿è¡Œç»“æžœï¼š æŽ’ç‰ˆå¼•æ“Žæ¡†æž¶ä¸Šé¢çš„ ç¤ºä¾‹ä»…ä»…å±•ç¤ºäº† Core Text æŽ’ç‰ˆçš„åŸºæœ¬èƒ½åŠ›ã€‚ä½†æ˜¯è¦åˆ¶ä½œä¸€ä¸ªè¾ƒå®Œå–„çš„æŽ’ç‰ˆå¼•æ“Žï¼Œæˆ‘ä»¬ä¸èƒ½ç®€å•çš„å°†æ‰€æœ‰ä»£ç éƒ½æ”¾åˆ° CTDisplayView çš„drawRectæ–¹æ³•é‡Œé¢ã€‚æ ¹æ®è®¾è®¡æ¨¡å¼ä¸­çš„ â€œ å•ä¸€åŠŸèƒ½åŽŸåˆ™ â€œ(Single responsibility principle)ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠåŠŸèƒ½æ‹†åˆ†ï¼ŒæŠŠä¸åŒçš„åŠŸèƒ½éƒ½æ”¾åˆ°å„è‡ªä¸åŒçš„ç±»é‡Œé¢ã€‚ å¯¹äºŽä¸€ä¸ªå¤æ‚çš„æŽ’ç‰ˆå¼•æ“Žæ¥è¯´ï¼Œå¯ä»¥å°†å…¶åŠŸèƒ½æ‹†æˆä»¥ä¸‹å‡ ä¸ªç±»æ¥å®Œæˆï¼š ä¸€ä¸ªæ˜¾ç¤ºç”¨çš„ç±»ï¼Œä»…è´Ÿè´£æ˜¾ç¤ºå†…å®¹ï¼Œä¸è´Ÿè´£æŽ’ç‰ˆ ä¸€ä¸ªæ¨¡åž‹ç±»ï¼Œç”¨äºŽæ‰¿è½½æ˜¾ç¤ºæ‰€éœ€è¦çš„æ‰€æœ‰æ•°æ® ä¸€ä¸ªæŽ’ç‰ˆç±»ï¼Œç”¨äºŽå®žçŽ°æ–‡å­—å†…å®¹çš„æŽ’ç‰ˆ ä¸€ä¸ªé…ç½®ç±»ï¼Œç”¨äºŽå®žçŽ°ä¸€äº›æŽ’ç‰ˆæ—¶çš„å¯é…ç½®é¡¹ æ³¨ï¼šâ€ å•ä¸€åŠŸèƒ½åŽŸåˆ™ â€œå‚è€ƒé“¾æŽ¥ Single responsibility principle æŒ‰ç…§ä»¥ä¸ŠåŽŸåˆ™ï¼Œæˆ‘ä»¬å°†CTDisplayViewä¸­çš„éƒ¨åˆ†å†…å®¹æ‹†å¼€ï¼Œç”± 4 ä¸ªç±»æž„æˆï¼š CTFrameParserConfigç±»ï¼Œç”¨äºŽé…ç½®ç»˜åˆ¶çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼šæ–‡å­—é¢œè‰²ï¼Œå¤§å°ï¼Œè¡Œé—´è·ç­‰ã€‚ CTFrameParserç±»ï¼Œç”¨äºŽç”Ÿæˆæœ€åŽç»˜åˆ¶ç•Œé¢éœ€è¦çš„CTFrameRefå®žä¾‹ã€‚ CoreTextDataç±»ï¼Œç”¨äºŽä¿å­˜ç”±CTFrameParserç±»ç”Ÿæˆçš„CTFrameRefå®žä¾‹ä»¥åŠCTFrameRefå®žé™…ç»˜åˆ¶éœ€è¦çš„é«˜åº¦ã€‚ CTDisplayViewç±»ï¼ŒæŒæœ‰CoreTextDataç±»çš„å®žä¾‹ï¼Œè´Ÿè´£å°†CTFrameRefç»˜åˆ¶åˆ°ç•Œé¢ä¸Šã€‚ å…³äºŽè¿™ 4 ä¸ªç±»çš„å…³é”®ä»£ç å¦‚ä¸‹ï¼š CTFrameParserConfigç±»: 12345678910111213141516171819202122232425#import &lt;Foundation/Foundation.h&gt;#import &lt;UIKit/UIKit.h&gt;@interface CTFrameParserConfig : NSObject/** é¢œè‰² */@property (nonatomic, strong) UIColor *textColor;/** å®½åº¦ */@property (nonatomic, assign) CGFloat width;/** å­—å· */@property (nonatomic, assign) CGFloat fontSize;/** è¡Œé«˜ */@property (nonatomic, assign) CGFloat lineSpace;@end 12345678910111213141516#import &quot;CTFrameParserConfig.h&quot;#import &quot;UIColor+Extend.h&quot;@implementation CTFrameParserConfig- (id)init &#123; self = [super init]; if (self) &#123; _width = 200.0f; _fontSize = 16.0f; _lineSpace = 8.0f; _textColor = [UIColor colorFromHexRGB:@&quot;333333&quot;]; &#125; return self;&#125;@end CTFrameParserç±»: 123456#import &lt;Foundation/Foundation.h&gt;#import &quot;CoreTextData.h&quot;#import &quot;CTFrameParserConfig.h&quot;@interface CTFrameParser : NSObject+ (CoreTextData *)parseContent:(NSString *)content config:(CTFrameParserConfig*)config;@end 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#import &quot;CTFrameParser.h&quot;#import &quot;CTFrameParserConfig.h&quot;@implementation CTFrameParser+ (NSDictionary *)attributesWithConfig:(CTFrameParserConfig *)config &#123; //åˆ›å»ºå­—ä½“ åŒ…æ‹¬å­—å½¢å’Œå¤§å° CGFloat fontSize = config.fontSize; CTFontRef fontRef = CTFontCreateWithName((CFStringRef)@&quot;ArialMT&quot;, fontSize, NULL); //è¡Œé«˜ CGFloat lineSpacing = config.lineSpace; //æ®µè½å±žæ€§ const CFIndex kNumberOfSettings = 3; //åˆ›å»ºæ®µè½å±žæ€§çš„ç»“æž„ä½“æ•°ç»„ å…·ä½“çš„æ®µè½å±žæ€§å€¼å‚è€ƒè‹¹æžœå®˜æ–¹æ–‡æ¡£ CTParagraphStyleSetting theSettings[kNumberOfSettings] = &#123; &#123; kCTParagraphStyleSpecifierLineSpacingAdjustment, sizeof(CGFloat), &amp;lineSpacing &#125;, &#123; kCTParagraphStyleSpecifierMaximumLineSpacing, sizeof(CGFloat), &amp;lineSpacing &#125;, &#123; kCTParagraphStyleSpecifierMinimumLineSpacing, sizeof(CGFloat), &amp;lineSpacing &#125; &#125;; //åˆ›å»ºæ®µè½å±žæ€§ CTParagraphStyleRef theParagraphRef = CTParagraphStyleCreate(theSettings, kNumberOfSettings); UIColor * textColor = config.textColor; NSMutableDictionary * dict = [NSMutableDictionary dictionary]; dict[(id)kCTForegroundColorAttributeName] = (id)textColor.CGColor; dict[(id)kCTFontAttributeName] = (__bridge id)fontRef; dict[(id)kCTParagraphStyleAttributeName] = (__bridge id)theParagraphRef; CFRelease(theParagraphRef); CFRelease(fontRef); return dict;&#125;+ (CoreTextData *)parseContent:(NSString *)content config:(CTFrameParserConfig*)config &#123; NSDictionary *attributes = [self attributesWithConfig:config]; NSAttributedString *contentString = [[NSAttributedString alloc] initWithString:content attributes:attributes]; // åˆ›å»º CTFramesetterRef å®žä¾‹ CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)contentString); // èŽ·å¾—è¦ç»˜åˆ¶çš„åŒºåŸŸçš„é«˜åº¦ CGSize restrictSize = CGSizeMake(config.width, CGFLOAT_MAX); CGSize coreTextSize = CTFramesetterSuggestFrameSizeWithConstraints(framesetter, CFRangeMake(0,0), nil, restrictSize, nil); CGFloat textHeight = coreTextSize.height; // ç”Ÿæˆ CTFrameRef å®žä¾‹ CTFrameRef frame = [self createFrameWithFramesetter:framesetter config:config height:textHeight]; // å°†ç”Ÿæˆå¥½çš„ CTFrameRef å®žä¾‹å’Œè®¡ç®—å¥½çš„ç»˜åˆ¶é«˜åº¦ä¿å­˜åˆ° CoreTextData å®žä¾‹ä¸­ï¼Œæœ€åŽè¿”å›ž CoreTextData å®žä¾‹ CoreTextData *data = [[CoreTextData alloc] init]; data.ctFrame = frame; data.height = textHeight; // é‡Šæ”¾å†…å­˜ CFRelease(frame); CFRelease(framesetter); return data;&#125;+ (CTFrameRef)createFrameWithFramesetter:(CTFramesetterRef)framesetter config:(CTFrameParserConfig *)config height:(CGFloat)height &#123; //ç”»å¸ƒçš„è·¯å¾„ï¼ˆè½®å»“æˆ–è€…èŒƒå›´ï¼‰ CGMutablePathRef path = CGPathCreateMutable(); CGPathAddRect(path, NULL, CGRectMake(0, 0, config.width, height)); //æœ€ç»ˆç”Ÿæˆç»˜åˆ¶éœ€è¦çš„frameï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ–‡æœ¬èŒƒå›´ï¼ŒCFRangeMake(0,0)ä»£è¡¨æ•´ä¸ªæ–‡æœ¬ï¼Œæœ€åŽä¸€ä¸ªå‚æ•°ä¸ºå¼€å‘ è€…è‡ªå®šä¹‰é¢å¤–çš„å±žæ€§ï¼Œä¸éœ€è¦å¡«NULLå³å¯ã€‚ CTFrameRef frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, 0), path, NULL); CFRelease(path); return frame;&#125;@end CoreTextDataç±»: 12345#import &lt;Foundation/Foundation.h&gt;@interface CoreTextData : NSObject@property (assign, nonatomic) CTFrameRef ctFrame;@property (assign, nonatomic) CGFloat height;@end 12345678910111213141516171819#import &quot;CoreTextData.h&quot;@implementation CoreTextData// CTFrameRef å±žäºŽCoreTextæ¡†æž¶ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨ç®¡ç†å†…å­˜ã€‚ARCæœºåˆ¶åœ¨æ­¤ä¸åœ¨é€‚ç”¨ï¼Œæ‰€ä»¥éœ€è¦é‡å†™Settter- (void)setCtFrame:(CTFrameRef)ctFrame &#123; if (_ctFrame != ctFrame) &#123; if (_ctFrame != nil) &#123; CFRelease(_ctFrame); &#125; CFRetain(ctFrame); _ctFrame = ctFrame; &#125;&#125;- (void)dealloc &#123; if (_ctFrame != nil) &#123; CFRelease(_ctFrame); _ctFrame = nil; &#125;&#125;@end CTDisplayViewç±»ï¼š 12345#import &lt;Foundation/Foundation.h&gt;#import &quot;CoreTextData.h&quot;@interface CTDisplayView : UIView@property (strong, nonatomic) CoreTextData * data;@end 1234567891011121314151617181920#import &quot;CTDisplayView.h&quot;@implementation CTDisplayView- (void)drawRect:(CGRect)rect&#123; [super drawRect:rect]; //å› ä¸ºCore Textè¦é…åˆCore Graphic é…åˆä½¿ç”¨çš„ï¼Œå¦‚Core Graphicä¸€æ ·ï¼Œç»˜å›¾çš„æ—¶å€™éœ€è¦èŽ·å¾—å½“å‰çš„ä¸Šä¸‹æ–‡è¿›è¡Œç»˜åˆ¶ CGContextRef context = UIGraphicsGetCurrentContext(); //ç¿»è½¬å½“å‰çš„åæ ‡ç³»ï¼ˆå› ä¸ºå¯¹äºŽåº•å±‚ç»˜åˆ¶å¼•æ“Žæ¥è¯´ï¼Œå±å¹•å·¦ä¸‹è§’ä¸ºï¼ˆ0ï¼Œ0ï¼‰ï¼‰ //è®¾ç½®æ–‡æœ¬ä¸è¿›è¡Œå˜æ¢ CGContextSetTextMatrix(context, CGAffineTransformIdentity); //å‘ä¸‹å¹³ç§»æ•´ä¸ªç”»å¸ƒå•ä½ CGContextTranslateCTM(context, 0, self.bounds.size.height); //å¯¹å¹³ç§»åŽçš„ç”»å¸ƒè¿›è¡Œç¿»è½¬ CGContextScaleCTM(context, 1.0, -1.0); if (self.data) &#123; //ç»˜åˆ¶ CTFrameDraw(self.data.ctFrame, context); &#125;&#125;@end ä»¥ä¸‹æ˜¯æœ¬æ¡†æž¶çš„ UML ç¤ºæ„å›¾ï¼Œä»Žå›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™ 4 ä¸ª Core Text ç±»çš„å…³ç³»æ˜¯è¿™æ ·çš„ï¼š CTFrameParseré€šè¿‡CTFrameparserConfigå®žä¾‹æ¥ç”ŸæˆCoreTextDataå®žä¾‹ã€‚ CTDisplayViewé€šè¿‡æŒæœ‰CoreTextDataå®žä¾‹æ¥èŽ·å¾—ç»˜åˆ¶æ‰€éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯ã€‚ ViewControllerç±»é€šè¿‡é…ç½®CTFrameparserConfigå®žä¾‹ï¼Œè¿›è€ŒèŽ·å¾—ç”Ÿæˆçš„CoreTextDataå®žä¾‹ï¼Œæœ€åŽå°†å…¶èµ‹å€¼ç»™ä»–çš„CTDisplayViewæˆå‘˜ï¼Œè¾¾åˆ°å°†æŒ‡å®šå†…å®¹æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šçš„æ•ˆæžœã€‚ å®šåˆ¶æŽ’ç‰ˆæ–‡ä»¶æ ¼å¼å¯¹äºŽä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç»™ CTFrameParser ä½¿å¢žåŠ äº†ä¸€ä¸ªå°† NSString è½¬æ¢ä¸º CoreTextData çš„æ–¹æ³•ã€‚ä½†è¿™æ ·çš„å®žçŽ°æ–¹å¼æœ‰å¾ˆå¤šå±€é™æ€§ï¼Œå› ä¸ºæ•´ä¸ªå†…å®¹è™½ç„¶å¯ä»¥å®šåˆ¶å­—ä½“å¤§å°ï¼Œé¢œè‰²ï¼Œè¡Œé«˜ç­‰ä¿¡æ¯ï¼Œä½†æ˜¯å´ä¸èƒ½æ”¯æŒå®šåˆ¶å†…å®¹ä¸­çš„æŸä¸€éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæˆ‘ä»¬åªæƒ³è®©å†…å®¹çš„å‰ä¸‰ä¸ªå­—æ˜¾ç¤ºæˆçº¢è‰²ï¼Œè€Œå…¶å®ƒæ–‡å­—æ˜¾ç¤ºæˆé»‘è‰²ï¼Œé‚£ä¹ˆå°±åŠžä¸åˆ°äº†ã€‚ä¸‹é¢çš„ç¤ºä¾‹ç¨‹åºä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è§£æžä¸€ä¸ªjsonæ ¼å¼çš„æ–‡ä»¶æ¥è¯´æ˜Žå®žçŽ°éƒ¨åˆ†å­—ä½“è‡ªå®šä¹‰ã€å›¾æ–‡æ··æŽ’ï¼Œç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•ã€‚ ä¸‹é¢æ˜¯æˆ‘ä»¬éœ€è¦çš„jsonæ¨¡æ¿ï¼Œå¼€å‘è€…å¯æ ¹æ®è‡ªå·±çš„æŽ’ç‰ˆéœ€æ±‚å®šåˆ¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445[ &#123; &quot;type&quot; : &quot;img&quot;, &quot;width&quot; : 300, &quot;height&quot; : 160, &quot;name&quot; : &quot;coretext-image-1.jpg&quot; &#125;, &#123; &quot;color&quot; : &quot;blue&quot;, &quot;content&quot; : &quot;å¯¹äºŽä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç»™ CTFrameParser ä½¿å¢žåŠ äº†ä¸€ä¸ªå°† NSString è½¬æ¢ä¸º CoreTextData çš„æ–¹æ³• &quot;, &quot;size&quot; : 16, &quot;type&quot; : &quot;txt&quot; &#125;, &#123; &quot;color&quot; : &quot;red&quot;, &quot;content&quot; : &quot;å†…å®¹ã€é¢œè‰²ã€å­—ä½“&quot;, &quot;size&quot; : 22, &quot;type&quot; : &quot;txt&quot; &#125;, &#123; &quot;color&quot; : &quot;black&quot;, &quot;content&quot; : &quot;å¤§å°ç­‰ä¿¡æ¯ã€‚\n&quot;, &quot;size&quot; : 16, &quot;type&quot; : &quot;txt&quot; &#125;, &#123; &quot;color&quot; : &quot;default&quot;, &quot;content&quot; : &quot;ä¸‹é¢çš„ç¤ºä¾‹ç¨‹åºä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è§£æžä¸€ä¸ªjsonæ ¼å¼çš„æ–‡ä»¶æ¥è¯´æ˜Žå®žçŽ°éƒ¨åˆ†å­—ä½“è‡ªå®šä¹‰ã€å›¾æ–‡æ··æŽ’ï¼Œç‚¹å‡»äº‹ä»¶çš„æ–¹æ³•ã€‚&quot;, &quot;type&quot; : &quot;txt&quot; &#125;, &#123; &quot;type&quot; : &quot;img&quot;, &quot;width&quot; : 50, &quot;height&quot; : 32, &quot;name&quot; : &quot;coretext-image-2.jpg&quot; &#125;, &#123; &quot;color&quot; : &quot;default&quot;, &quot;content&quot; : &quot;è¿™åœ¨è¿™é‡Œå°è¯•æ”¾ä¸€ä¸ªå‚è€ƒé“¾æŽ¥ï¼š&quot;, &quot;type&quot; : &quot;txt&quot; &#125;, &#123; &quot;color&quot; : &quot;blue&quot;, &quot;content&quot; : &quot;é“¾æŽ¥æ–‡å­—&quot;, &quot;url&quot; : &quot;https://www.baidu.com&quot;, &quot;type&quot; : &quot;link&quot; &#125;, &#123; &quot;color&quot; : &quot;default&quot;, &quot;content&quot; : &quot;å¤§å®¶å¯ä»¥å°è¯•ç‚¹å‡»ä¸€ä¸‹&quot;, &quot;type&quot; : &quot;txt&quot; &#125;] è¿™é‡Œé¦–å…ˆè§£é‡Šä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªjsonæ ¼å¼çš„æ–‡ä»¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿›è¡Œå›¾æ–‡æ··æŽ’çš„æ—¶å€™ï¼Œéƒ½éœ€è¦æ‰¾å‡ºstringä¸­éœ€è¦ç‰¹åˆ«å¤„ç†çš„substringã€‚æ¯”å¦‚æˆ‘ä»¬Demoä¸­çš„â€œå†…å®¹ã€é¢œè‰²ã€å­—ä½“â€ï¼Œä½œä¸ºæ–‡æœ¬å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦æ˜¾ç¤ºä¸ºçº¢è‰²è€Œä¸åŒäºŽæ–‡æœ¬æ•´ä½“çš„é¢œè‰²ã€‚è¿™é‡Œå¦‚æžœåŽå°ä¼ ç»™æˆ‘ä»¬çš„æ•°æ®å¦‚æžœåªæ˜¯çº¯æ–‡æœ¬çš„è¯ï¼Œæˆ‘ä»¬å°±å¯èƒ½éœ€è¦åˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼åŽ»æ•´ä¸ªæ–‡æœ¬ä¸­åŽ»å¯»æ‰¾éœ€è¦ç€è‰²çš„æ–‡æœ¬ã€‚ç›¸æ¯”äºŽè¿™ç§ç›´æŽ¥ç»™å‡ºsubstringå±žæ€§çš„çš„æ–¹å¼ï¼Œç”¨æ­£åˆ™è¡¨è¾¾å¼å¯èƒ½è§£æžèµ·æ¥æ›´éº»çƒ¦ã€‚å…³äºŽæ­£åˆ™è¡¨è¾¾å¼å¯å‚è€ƒé“¾æŽ¥ iOSæ­£åˆ™è¡¨è¾¾å¼è¿™é‡Œä¸åšèµ˜è¿°ã€‚æœ¬æ–‡é‡‡ç”¨è§£æžjsonæ–‡ä»¶çš„æ–¹å¼è¿›è¡Œç»˜åˆ¶ã€‚ å…ˆæ¥çœ‹ä¸‹Demoå®žçŽ°çš„æ•ˆæžœ å…¶ä¸­ï¼Œç‚¹å‡»å›¾ç‰‡éƒ¨åˆ†ä¼šå¼¹å‡ºå›¾ç‰‡å¤§å›¾æµè§ˆå™¨ï¼Œç‚¹å‡»é“¾æŽ¥æ–‡å­—ä¼šè·³è½¬åˆ°æŒ‡å®šçš„é“¾æŽ¥ã€‚ ç¤ºä¾‹ç¨‹åºå…³é”®ä»£ç è§£è¯»CTFrameParserConfigç±»:å’Œä¸Šæ–‡ä¸€æ ·ï¼Œè´Ÿè´£æ–‡æœ¬å±žæ€§çš„å…¨å±€é…ç½® CTFrameParserç±»ï¼šå¢žåŠ ä¸€ä¸ªæ–¹æ³•ï¼Œè®©å…¶å¯ä»¥ä»Žå¦‚ä¸Šæ ¼å¼çš„æ¨¡ç‰ˆæ–‡ä»¶ä¸­ç”ŸæˆCoreTextDataã€‚æœ€ç»ˆæˆ‘ä»¬çš„å®žçŽ°ä»£ç å¦‚ä¸‹ï¼š 12345678#import &lt;Foundation/Foundation.h&gt;#import &quot;CoreTextData.h&quot;@interface CTFrameParser : NSObject+ (CoreTextData *)parseTemplateFile:(NSString *)path config:(CTFrameParserConfig *)config;@end 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237#import &quot;CTFrameParser.h&quot;#import &quot;CoreTextData.h&quot;#import &quot;CTFrameParserConfig.h&quot;#import &quot;CoreTextImageData.h&quot;#import &quot;CoreTextLinkData.h&quot;@implementation CTFrameParser// CTRunä»£ç†æ–¹æ³•ï¼ŒèŽ·å–å½“å‰runçš„ä¸Šè¡Œé«˜åº¦static CGFloat ascentCallback(void *ref)&#123; return [(NSNumber*)[(__bridge NSDictionary*)ref objectForKey:@&quot;height&quot;] floatValue];&#125;// CTRunä»£ç†æ–¹æ³•ï¼ŒèŽ·å–å½“å‰runçš„ä¸‹è¡Œé«˜åº¦static CGFloat descentCallback(void *ref)&#123; return 0;&#125;// CTRunä»£ç†æ–¹æ³•ï¼ŒèŽ·å–å½“å‰runçš„å®½åº¦static CGFloat widthCallback(void* ref)&#123; return [(NSNumber*)[(__bridge NSDictionary*)ref objectForKey:@&quot;width&quot;] floatValue];&#125;//å…¨å±€é…ç½®+ (NSMutableDictionary *)attributesWithConfig:(CTFrameParserConfig *)config &#123; CGFloat fontSize = config.fontSize; //åˆ›å»ºå­—ä½“ åŒ…æ‹¬å­—å½¢å’Œå¤§å° CTFontRef fontRef = CTFontCreateWithName((CFStringRef)@&quot;ArialMT&quot;, fontSize, NULL); //è¡Œé«˜ CGFloat lineSpacing = config.lineSpace; //æ®µè½å±žæ€§ const CFIndex kNumberOfSettings = 3; //åˆ›å»ºæ®µè½å±žæ€§çš„ç»“æž„ä½“æ•°ç»„ å…·ä½“çš„æ®µè½å±žæ€§å€¼å‚è€ƒè‹¹æžœå®˜æ–¹æ–‡æ¡£ CTParagraphStyleSetting theSettings[kNumberOfSettings] = &#123; &#123; kCTParagraphStyleSpecifierLineSpacingAdjustment, sizeof(CGFloat), &amp;lineSpacing &#125;, &#123; kCTParagraphStyleSpecifierMaximumLineSpacing, sizeof(CGFloat), &amp;lineSpacing &#125;, &#123; kCTParagraphStyleSpecifierMinimumLineSpacing, sizeof(CGFloat), &amp;lineSpacing &#125; &#125;; //åˆ›å»ºæ®µè½å±žæ€§ CTParagraphStyleRef theParagraphRef = CTParagraphStyleCreate(theSettings, kNumberOfSettings); UIColor * textColor = config.textColor; //å±žæ€§æ”¾å…¥å­—å…¸ NSMutableDictionary * dict = [NSMutableDictionary dictionary]; dict[(id)kCTForegroundColorAttributeName] = (id)textColor.CGColor; dict[(id)kCTFontAttributeName] = (__bridge id)fontRef; dict[(id)kCTParagraphStyleAttributeName] = (__bridge id)theParagraphRef; //å†…å­˜ç®¡ç† CFRelease(theParagraphRef); CFRelease(fontRef); return dict;&#125;// å¯¹å¤–æŽ¥å£ï¼Œä¼ å…¥jsonæ–‡ä»¶è·¯å¾„å’Œå…¨å±€é…ç½®ï¼Œè¿”å›žç»˜åˆ¶éœ€è¦çš„CoreTextDataå¯¹è±¡+ (CoreTextData *)parseTemplateFile:(NSString *)path config:(CTFrameParserConfig*)config &#123; //å­˜æ”¾å›¾ç‰‡CoreTextImageData NSMutableArray *imageArray = [NSMutableArray array]; //å­˜æ”¾é“¾æŽ¥CoreTextImageData NSMutableArray *linkArray = [NSMutableArray array]; //è§£æžjsonæ–‡ä»¶ï¼ŒèŽ·å–ç»˜åˆ¶éœ€è¦çš„AttributedString NSAttributedString *content = [self loadTemplateFile:path config:config imageArray:imageArray linkArray:linkArray]; //æ ¹æ®AttributedStringæ¥åˆ›å»ºCoreTextData CoreTextData *data = [self parseAttributedContent:content config:config]; data.imageArray = imageArray; data.linkArray = linkArray; return data;&#125;//è§£æžjsonæ–‡ä»¶ï¼ŒèŽ·å–ç»˜åˆ¶éœ€è¦çš„AttributedString+ (NSAttributedString *)loadTemplateFile:(NSString *)path config:(CTFrameParserConfig*)config imageArray:(NSMutableArray *)imageArray linkArray:(NSMutableArray *)linkArray &#123; //jsonè§£æž NSData *data = [NSData dataWithContentsOfFile:path]; NSMutableAttributedString *result = [[NSMutableAttributedString alloc] init]; if (data) &#123; NSArray *array = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingAllowFragments error:nil]; if ([array isKindOfClass:[NSArray class]]) &#123; for (NSDictionary *dict in array) &#123; NSString *type = dict[@&quot;type&quot;]; if ([type isEqualToString:@&quot;txt&quot;]) &#123; //çº¯æ–‡æœ¬çš„å¤„ç† //æ­¤æ–¹æ³•ä½œç”¨ï¼š1ã€å†…éƒ¨é¦–å…ˆä¼šè°ƒç”¨attributesWithConfigå¢žåŠ å…¨å±€å±žæ€§ 2ã€æ ¹æ®è§£æžç»“æžœç»™å¯¹åº”çš„æ–‡æœ¬å¢žåŠ Attribute NSAttributedString *as = [self parseAttributedContentFromNSDictionary:dict config:config]; [result appendAttributedString:as]; &#125; else if ([type isEqualToString:@&quot;img&quot;]) &#123; //å›¾ç‰‡ // åˆ›å»º CoreTextImageDataç”¨äºŽå­˜æ”¾å›¾ç‰‡å±žæ€§ CoreTextImageData *imageData = [[CoreTextImageData alloc] init]; imageData.name = dict[@&quot;name&quot;]; //resultçš„é•¿åº¦å³ä¸ºå›¾ç‰‡çš„range.location imageData.position = [result length]; [imageArray addObject:imageData]; // åˆ›å»ºç©ºç™½å ä½ç¬¦ï¼Œå¹¶ä¸”è®¾ç½®å®ƒçš„CTRunDelegateä¿¡æ¯. å¯¹äºŽå›¾ç‰‡çš„æŽ’ç‰ˆï¼Œå…¶å®ž CoreText æœ¬è´¨ä¸Šä¸æ˜¯ç›´æŽ¥æ”¯æŒçš„ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¦æ˜¾ç¤ºæ–‡æœ¬çš„åœ°æ–¹ï¼Œç”¨ä¸€ä¸ªç‰¹æ®Šçš„ç©ºç™½å­—ç¬¦ä»£æ›¿ï¼ŒåŒæ—¶è®¾ç½®è¯¥å­—ä½“çš„CTRunDelegateä¿¡æ¯ä¸ºè¦æ˜¾ç¤ºçš„å›¾ç‰‡çš„å®½åº¦å’Œé«˜åº¦ä¿¡æ¯ï¼Œè¿™æ ·æœ€åŽç”Ÿæˆçš„CTFrameå®žä¾‹ï¼Œå°±ä¼šåœ¨ç»˜åˆ¶æ—¶å°†å›¾ç‰‡çš„ä½ç½®é¢„ç•™å‡ºæ¥ã€‚ //å› ä¸ºæˆ‘ä»¬çš„CTDisplayViewçš„ç»˜åˆ¶ä»£ç æ˜¯åœ¨drawRecté‡Œé¢çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°æŠŠéœ€è¦ç»˜åˆ¶çš„å›¾ç‰‡ï¼Œç”¨CGContextDrawImageæ–¹æ³•ç›´æŽ¥ç»˜åˆ¶å‡ºæ¥å°±å¯ä»¥äº†ã€‚ //æ­¤å¤„æœ€ç»ˆçš„è¿”å›žå­—ç¬¦ä¸²ä¸ºä¸Žéœ€è¦ç»˜åˆ¶å›¾ç‰‡åŒç­‰å¤§å°çš„å ä½ç¬¦ï¼ˆç©ºç™½å­—ç¬¦ï¼‰ NSAttributedString *as = [self parseImageDataFromNSDictionary:dict config:config]; [result appendAttributedString:as]; &#125; else if ([type isEqualToString:@&quot;link&quot;]) &#123; //é“¾æŽ¥å¤„ç† //é“¾æŽ¥å¼€å§‹ä½ç½®çš„indexä¸ºæ‹¼æŽ¥ä¹‹å‰çš„é•¿åº¦ NSUInteger startPos = result.length; //åŒçº¯æ–‡æœ¬å¤„ç†æ–¹å¼ NSAttributedString *as = [self parseAttributedContentFromNSDictionary:dict config:config]; [result appendAttributedString:as]; // åˆ›å»º CoreTextLinkData NSUInteger length = result.length - startPos; //è®¡ç®—å‡ºé“¾æŽ¥åœ¨æ•´ä¸ªæ–‡æœ¬ä¸­çš„Rangeä¿å­˜åˆ°linkDataä¸­ï¼Œç›®çš„æ˜¯æ–¹ä¾¿åˆ¤æ–­ç‚¹å‡»ä½ç½®æ˜¯å¦åœ¨é“¾æŽ¥çš„èŒƒå›´å†…ï¼Œåœ¨çš„è¯åˆ™è·³è½¬å¯¹åº”çš„é“¾æŽ¥ã€‚ NSRange linkRange = NSMakeRange(startPos, length); CoreTextLinkData *linkData = [[CoreTextLinkData alloc] init]; linkData.title = dict[@&quot;content&quot;]; linkData.url = dict[@&quot;url&quot;]; linkData.range = linkRange; [linkArray addObject:linkData]; &#125; &#125; &#125; &#125; return result;&#125;//è§£æžå›¾ç‰‡æ•°æ®ï¼Œè®¾ç½®CTRunçš„ä»£ç†ã€‚ï¼ˆå›¾æ–‡æ··æŽ’æ ¸å¿ƒå†…å®¹ï¼‰+ (NSAttributedString *)parseImageDataFromNSDictionary:(NSDictionary *)dict config:(CTFrameParserConfig*)config &#123; //ç»“æž„ä½“ç±»åž‹ï¼Œå…¶ä¸­åŒ…å«äº†CTRunçš„æ‰€æœ‰å›žè°ƒå‡½æ•° CTRunDelegateCallbacks callbacks; //ç»™ç»“æž„ä½“åˆ†é…å†…å­˜ç©ºé—´ memset(&amp;callbacks, 0, sizeof(CTRunDelegateCallbacks)); //æ–‡æ¡£è§£é‡Šä¸º This field should always be set to kCTRunDelegateCurrentVersion. ä¼ å…¥kCTRunDelegateVersion1å³å¯ ï¼ˆkCTRunDelegateCurrentVersion = kCTRunDelegateVersion1ï¼‰ callbacks.version = kCTRunDelegateVersion1; //è®¾ç½®èŽ·å–æ–‡å­—ä¸Šè¡Œé«˜åº¦çš„å›žè°ƒæ–¹æ³• callbacks.getAscent = ascentCallback; //è®¾ç½®èŽ·å–æ–‡å­—ä¸‹è¡Œé«˜åº¦çš„å›žè°ƒæ–¹æ³• callbacks.getDescent = descentCallback; //è®¾ç½®èŽ·å–æ–‡å­—å®½åº¦çš„å›žè°ƒæ–¹æ³• callbacks.getWidth = widthCallback; //åˆ›å»ºä»£ç†ï¼Œä¼ å…¥å›žè°ƒæ–¹æ³•ç»“æž„ä½“ã€‚ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥éšä¾¿å¡«å†™æˆ‘ä»¬éœ€è¦ä¼ å…¥çš„æ•°æ®ï¼Œæ³¨æ„ç±»åž‹ä¸ºvoid * CTRunDelegateRef delegate = CTRunDelegateCreate(&amp;callbacks, (__bridge void *)(dict)); // ä½¿ç”¨0xFFFCä½œä¸ºç©ºç™½çš„å ä½ç¬¦ unichar objectReplacementChar = 0xFFFC; NSString * content = [NSString stringWithCharacters:&amp;objectReplacementChar length:1]; NSDictionary * attributes = [self attributesWithConfig:config]; //ç»™å­—ç¬¦æ·»åŠ å…¨å±€å±žæ€§ NSMutableAttributedString * space = [[NSMutableAttributedString alloc] initWithString:content attributes:attributes]; //è®¾ç½®ä»£ç† CFAttributedStringSetAttribute((CFMutableAttributedStringRef)space, CFRangeMake(0, 1), kCTRunDelegateAttributeName, delegate); //å†…å­˜ç®¡ç† CFRelease(delegate); return space;&#125;//è§£æžåŽŸå§‹æ•°æ®ï¼Œè¿”å›žAttributedString+ (NSAttributedString *)parseAttributedContentFromNSDictionary:(NSDictionary *)dict config:(CTFrameParserConfig*)config &#123; //å¢žåŠ å…¨å±€å±žæ€§ NSMutableDictionary *attributes = [self attributesWithConfig:config]; // ä»¥ä¸‹ä¸ºå¢žåŠ è‡ªå®šä¹‰å±žæ€§ //æ ¹æ®å­—å…¸çš„keyå€¼è¿”å›žå¯¹åº”çš„é¢œè‰² UIColor *color = [self colorFromTemplate:dict[@&quot;color&quot;]]; if (color) &#123; attributes[(id)kCTForegroundColorAttributeName] = (id)color.CGColor; &#125; // è®¾ç½®å­—ä½“å¤§å° CGFloat fontSize = [dict[@&quot;size&quot;] floatValue]; if (fontSize &gt; 0) &#123; //åˆ›å»ºå­—ä½“å¯¹è±¡ï¼ŒåŒ…å«äº†å­—å½¢å’Œå­—ä½“å¤§å° CTFontRef fontRef = CTFontCreateWithName((CFStringRef)@&quot;ArialMT&quot;, fontSize, NULL); attributes[(id)kCTFontAttributeName] = (__bridge id)fontRef; CFRelease(fontRef); &#125; NSString *content = dict[@&quot;content&quot;]; //è¿”å›žç»è¿‡è‡ªå®šä¹‰éœ€è¦å±€éƒ¨å¤„ç†çš„å­—ç¬¦ä¸² return [[NSAttributedString alloc] initWithString:content attributes:attributes];&#125;//æ ¹æ®å­—å…¸çš„keyå€¼è¿”å›žå¯¹åº”çš„é¢œè‰²+ (UIColor *)colorFromTemplate:(NSString *)name &#123; if ([name isEqualToString:@&quot;blue&quot;]) &#123; return [UIColor blueColor]; &#125; else if ([name isEqualToString:@&quot;red&quot;]) &#123; return [UIColor redColor]; &#125; else if ([name isEqualToString:@&quot;black&quot;]) &#123; return [UIColor blackColor]; &#125; else &#123; return nil; &#125;&#125;// æ ¹æ®ä¹‹å‰è§£æžå‡ºæ¥çš„AttributedStringåˆ›å»ºç»˜åˆ¶æ‰€éœ€è¦çš„CoreTextData+ (CoreTextData *)parseAttributedContent:(NSAttributedString *)content config:(CTFrameParserConfig*)config &#123; // åˆ›å»ºCTFramesetterRefå®žä¾‹ CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)content); // èŽ·å¾—è¦ç»˜åˆ¶çš„åŒºåŸŸçš„é«˜åº¦ CGSize restrictSize = CGSizeMake(config.width, CGFLOAT_MAX); //ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ–‡æœ¬èŒƒå›´ï¼ŒCFRangeMake(0,0)ä»£è¡¨æ•´ä¸ªæ–‡æœ¬ CGSize coreTextSize = CTFramesetterSuggestFrameSizeWithConstraints(framesetter, CFRangeMake(0,0), nil, restrictSize, nil); CGFloat textHeight = coreTextSize.height; // ç”ŸæˆCTFrameRefå®žä¾‹ CTFrameRef frame = [self createFrameWithFramesetter:framesetter config:config height:textHeight]; // å°†ç”Ÿæˆå¥½çš„CTFrameRefå®žä¾‹å’Œè®¡ç®—å¥½çš„ç¼“åˆ¶é«˜åº¦ä¿å­˜åˆ°CoreTextDataå®žä¾‹ä¸­ï¼Œæœ€åŽè¿”å›žCoreTextDataå®žä¾‹ CoreTextData *data = [[CoreTextData alloc] init]; data.ctFrame = frame; data.height = textHeight; data.content = content; // é‡Šæ”¾å†…å­˜ CFRelease(frame); CFRelease(framesetter); return data;&#125;//åˆ›å»ºCTFrameRefå®žä¾‹+ (CTFrameRef)createFrameWithFramesetter:(CTFramesetterRef)framesetter config:(CTFrameParserConfig *)config height:(CGFloat)height &#123; //ç”»å¸ƒçš„è·¯å¾„ï¼ˆè½®å»“æˆ–è€…èŒƒå›´ï¼‰ CGMutablePathRef path = CGPathCreateMutable(); CGPathAddRect(path, NULL, CGRectMake(0, 0, config.width, height)); //æœ€ç»ˆç”Ÿæˆç»˜åˆ¶éœ€è¦çš„frameï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ–‡æœ¬èŒƒå›´ï¼ŒCFRangeMake(0,0)ä»£è¡¨æ•´ä¸ªæ–‡æœ¬ï¼Œæœ€åŽä¸€ä¸ªå‚æ•°ä¸ºå¼€å‘è€…è‡ªå®šä¹‰é¢å¤–çš„å±žæ€§ï¼Œä¸éœ€è¦å¡«NULLå³å¯ã€‚ CTFrameRef frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, 0), path, NULL); CFRelease(path); return frame;&#125;@end CoreTextDataç±»ï¼šå¢žåŠ ä¸¤ä¸ªå¯å˜æ•°åˆ†åˆ«ç”¨æ¥å­˜æ”¾æ–‡æœ¬ä¸­çš„å›¾ç‰‡å’Œé“¾æŽ¥,åœ¨è®¾ç½®imageArrayæˆå‘˜æ—¶ï¼Œæˆ‘ä»¬è¿˜ä¼šè°ƒä¸€ä¸ªæ–°åˆ›å»ºçš„fillImagePositionæ–¹æ³•ï¼Œç”¨äºŽæ‰¾åˆ°æ¯å¼ å›¾ç‰‡åœ¨ç»˜åˆ¶æ—¶çš„ä½ç½®ã€‚ 1234567891011121314151617#import &lt;Foundation/Foundation.h&gt;#import &quot;CTFrameParserConfig.h&quot;#import &lt;CoreText/CoreText.h&gt;@interface CoreTextData : NSObject//ç»˜åˆ¶éœ€è¦çš„CTFrameRefå®žä¾‹@property (assign, nonatomic) CTFrameRef ctFrame;//é«˜åº¦@property (assign, nonatomic) CGFloat height;//å›¾ç‰‡ä¿¡æ¯@property (strong, nonatomic) NSArray * imageArray;//é“¾æŽ¥ä¿¡æ¯@property (strong, nonatomic) NSArray * linkArray;//æ–‡æœ¬@property (strong, nonatomic) NSAttributedString *content;@end 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899#import &quot;CoreTextData.h&quot;#import &quot;CoreTextImageData.h&quot;@implementation CoreTextData// CTFrameRef å±žäºŽCoreTextæ¡†æž¶ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨ç®¡ç†å†…å­˜ã€‚ARCæœºåˆ¶åœ¨æ­¤ä¸åœ¨é€‚ç”¨ï¼Œæ‰€ä»¥éœ€è¦é‡å†™Settter- (void)setCtFrame:(CTFrameRef)ctFrame &#123; if (_ctFrame != ctFrame) &#123; if (_ctFrame != nil) &#123; CFRelease(_ctFrame); &#125; CFRetain(ctFrame); _ctFrame = ctFrame; &#125;&#125;- (void)dealloc &#123; if (_ctFrame != nil) &#123; CFRelease(_ctFrame); _ctFrame = nil; &#125;&#125;- (void)setImageArray:(NSArray *)imageArray &#123; _imageArray = imageArray; [self fillImagePosition];&#125;// è®¡ç®—æ‰€æœ‰å›¾ç‰‡çš„ä½ç½®å’Œå°ºå¯¸- (void)fillImagePosition &#123; if (self.imageArray.count == 0) &#123; return; &#125; //èŽ·å–æ‰€æœ‰CTLineå¯¹è±¡ NSArray *lines = (NSArray *)CTFrameGetLines(self.ctFrame); NSUInteger lineCount = [lines count]; // æ¯ä¸ªCTLineå¯¹åº”çš„origin CGPoint lineOrigins[lineCount]; // èŽ·å–æ‰€æœ‰originï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥æ–‡æœ¬çš„èŒƒå›´ï¼ŒCFRangeMake(0, 0)ä»£è¡¨æ•´ä¸ªCTFrameçš„èŒƒå›´ CTFrameGetLineOrigins(self.ctFrame, CFRangeMake(0, 0), lineOrigins); int imgIndex = 0; CoreTextImageData * imageData = self.imageArray[0]; for (int i = 0; i &lt; lineCount; ++i) &#123; if (imageData == nil) &#123; break; &#125; // å½“å‰ç¬¬ iä¸ª CTLine CTLineRef line = (__bridge CTLineRef)lines[i]; // èŽ·å–lineå½“ä¸­æ‰€æœ‰çš„CTRunå¯¹è±¡ NSArray * runObjArray = (NSArray *)CTLineGetGlyphRuns(line); //éåŽ†æ‰€æœ‰çš„CTRunå¯¹è±¡ for (id runObj in runObjArray) &#123; CTRunRef run = (__bridge CTRunRef)runObj; // èŽ·å–å½“å‰CTRunå¯¹è±¡çš„Attributes NSDictionary *runAttributes = (NSDictionary *)CTRunGetAttributes(run); // èŽ·å–å½“å‰CTRunçš„ä»£ç† ï¼ˆå› ä¸ºä»£ç†æ–¹æ³•ä¸­ä¼ å…¥äº†æˆ‘ä»¬éœ€è¦çš„å›¾ç‰‡ä½ç½®å­—å…¸ï¼‰ CTRunDelegateRef delegate = (__bridge CTRunDelegateRef)[runAttributes valueForKey:(id)kCTRunDelegateAttributeName]; if (delegate == nil) &#123; //åˆ¤æ–­ä»£ç†æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™è¯´æ˜Žå½“å‰CTRunä¸æ˜¯å›¾ç‰‡ï¼Œç»§ç»­å¾ªçŽ¯æŸ¥æ‰¾ä¸‹ä¸€ä¸ªï¼Œå­˜åœ¨åˆ™ç»§ç»­èŽ·å–CTRunçš„å„å±žæ€§å€¼ continue; &#125; //metDicä¸ºCTFrameParserç±»ä¸­è§£æžå›¾ç‰‡æ—¶ä¼ å…¥ä»£ç†çš„å‚æ•° NSDictionary * metaDic = CTRunDelegateGetRefCon(delegate); if (![metaDic isKindOfClass:[NSDictionary class]]) &#123; continue; &#125; CGRect runBounds; CGFloat ascent; CGFloat descent; //CTRunGetTypographicBounds:èŽ·å–CTRunçš„å‚æ•°ï¼Œç¬¬äºŒä¸ªRangeä¼ å…¥CFRangeMake(0, 0)è¡¨ç¤ºæ•´ä¸ªCTRun runBounds.size.width = CTRunGetTypographicBounds(run, CFRangeMake(0, 0), &amp;ascent, &amp;descent, NULL); //CTRunçš„é«˜åº¦åˆ™ä¸ºä¸Šè¡Œé«˜åº¦ + ä¸‹è¡Œé«˜åº¦ï¼Œå„å¸¸ç”¨å±žæ€§è¯¦è§£å‚è€ƒæ–‡ç«  runBounds.size.height = ascent + descent; //CTLineGetOffsetForStringIndex èŽ·å–ç‰¹å®šIndexå¤„å­—ç¬¦çš„åç§»é‡ CGFloat xOffset = CTLineGetOffsetForStringIndex(line, CTRunGetStringRange(run).location, NULL); // CTRunï¼ˆå›¾ç‰‡ï¼‰çš„æ¨ªåæ ‡ä½ç½®ä¸º åŸºç¡€åŽŸç‚¹(Origin)çš„x + åç§»é‡ runBounds.origin.x = lineOrigins[i].x + xOffset; runBounds.origin.y = lineOrigins[i].y; //çºµåæ ‡ä¸ºåŸºç¡€åŽŸç‚¹(Origin)çš„yå€¼ - ä¸‹è¡Œé«˜åº¦ ï¼ˆç›®çš„æ˜¯ä¿è¯å›¾ç‰‡åº•éƒ¨å’Œæ–‡å­—çš„æœ€åº•éƒ¨å¯¹é½ã€‚ä¹Ÿå¯ä»¥ä¸å‡åŽ»descentï¼Œæ­¤æ—¶å›¾ç‰‡çš„åº•éƒ¨å’Œæ–‡å­—çš„åŸºçº¿(baseline) å¯¹é½ï¼‰ runBounds.origin.y -= descent; // èŽ·å–å½“å‰CTFrameçš„è·¯å¾„ CGPathRef pathRef = CTFrameGetPath(self.ctFrame); //èŽ·å–è·¯å¾„çš„å°ºå¯¸ CGRect colRect = CGPathGetBoundingBox(pathRef); //ç›¸å¯¹çˆ¶è§†å›¾è¿›è¡Œåç§»ï¼ŒèŽ·å–å›¾ç‰‡ç›¸å¯¹åæ ‡ç³»çš„ä½ç½® CGRect delegateBounds = CGRectOffset(runBounds, colRect.origin.x, colRect.origin.y); imageData.imagePosition = delegateBounds; imgIndex++; if (imgIndex == self.imageArray.count) &#123; imageData = nil; break; &#125; else &#123; imageData = self.imageArray[imgIndex]; &#125; &#125; &#125;&#125;@end CoreTextUtilsæ–°å¢žç±»ï¼Œä¸»è¦çš„æ–¹æ³•æ˜¯ä½¿ç”¨ CTLineGetStringIndexForPosition å‡½æ•°æ¥èŽ·å¾—ç”¨æˆ·ç‚¹å‡»çš„ä½ç½®ä¸Ž NSAttributedString å­—ç¬¦ä¸²ä¸Šçš„ä½ç½®çš„å¯¹åº”å…³ç³»ã€‚è¿™æ ·å°±çŸ¥é“æ˜¯ç‚¹å‡»çš„å“ªä¸ªå­—ç¬¦äº†ã€‚ç„¶åŽåˆ¤æ–­è¯¥å­—ç¬¦ä¸²æ˜¯å¦åœ¨é“¾æŽ¥ä¸Šå³å¯ã€‚è¯¥ Util åœ¨å®žçŽ°é€»è¾‘å¦‚ä¸‹ 12345678910111213141516171819202122232425#import &lt;Foundation/Foundation.h&gt;#import &quot;CoreTextLinkData.h&quot;#import &quot;CoreTextData.h&quot;@interface CoreTextUtils : NSObject/** èŽ·å–ç‚¹å‡»å¤„CoreTextLinkDataï¼Œå¦‚æžœç‚¹å‡»çš„ä¸æ˜¯é“¾æŽ¥ï¼Œè¿”å›žç©º @param view å½“å‰ç‚¹å‡»æ‰€åœ¨çš„View @param point ç‚¹å‡»ä½ç½® @param data å½“å‰æ–‡æœ¬ä¿¡æ¯ @return èŽ·å–ç‚¹å‡»å¤„CoreTextLinkDataï¼Œå¦‚æžœç‚¹å‡»çš„ä¸æ˜¯é“¾æŽ¥ï¼Œè¿”å›žç©º */+ (CoreTextLinkData *)touchLinkInView:(UIView *)view atPoint:(CGPoint)point data:(CoreTextData *)data;/** @param view ç‚¹å‡»æ‰€åœ¨View @param point ç‚¹å‡»ä½ç½® @param data å½“å‰æ–‡æœ¬ä¿¡æ¯ @return ç‚¹å‡»å­—ç¬¦å¤„çš„index */+ (CFIndex)touchContentOffsetInView:(UIView *)view atPoint:(CGPoint)point data:(CoreTextData *)data;@end 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980#import &quot;CoreTextUtils.h&quot;@implementation CoreTextUtils// æ£€æµ‹ç‚¹å‡»ä½ç½®æ˜¯å¦åœ¨é“¾æŽ¥ä¸Š+ (CoreTextLinkData *)touchLinkInView:(UIView *)view atPoint:(CGPoint)point data:(CoreTextData *)data &#123; //å°†ç‚¹å‡»çš„ä½ç½®è½¬æ¢æˆå­—ç¬¦ä¸²çš„åç§»é‡ CFIndex idx = [self touchContentOffsetInView:view atPoint:point data:data]; if (idx == -1) &#123; //ä¸åœ¨æ–‡æœ¬ä¸Š return nil; &#125; //å¦‚æžœèƒ½æ‰¾åˆ°ç‚¹å‡»å¤„çš„indexï¼Œåˆ™æ‰§è¡Œå¯¹linkçš„éåŽ†ï¼ŒæŸ¥çœ‹indexæ˜¯å¦åœ¨linkçš„RangeèŒƒå›´ä¹‹å†… CoreTextLinkData * foundLink = [self linkAtIndex:idx linkArray:data.linkArray]; return foundLink;&#125;// å°†ç‚¹å‡»çš„ä½ç½®è½¬æ¢æˆå­—ç¬¦ä¸²çš„åç§»é‡ï¼Œå¦‚æžœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™è¿”å›ž-1+ (CFIndex)touchContentOffsetInView:(UIView *)view atPoint:(CGPoint)point data:(CoreTextData *)data &#123; //èŽ·å–å½“å‰çš„CTFrameRefå®žä¾‹ CTFrameRef textFrame = data.ctFrame; //èŽ·å–æ¯ä¸€è¡Œ CFArrayRef lines = CTFrameGetLines(textFrame); if (!lines) &#123; return -1; &#125; //èŽ·å–æ€»å…±çš„è¡Œæ•° CFIndex count = CFArrayGetCount(lines); // èŽ·å¾—æ¯ä¸€è¡Œçš„originåæ ‡ CGPoint origins[count]; CTFrameGetLineOrigins(textFrame, CFRangeMake(0,0), origins); // ç¿»è½¬åæ ‡ç³» CGAffineTransform transform = CGAffineTransformMakeTranslation(0, view.bounds.size.height); transform = CGAffineTransformScale(transform, 1.f, -1.f); CFIndex idx = -1; for (int i = 0; i &lt; count; i++) &#123; CGPoint linePoint = origins[i]; CTLineRef line = CFArrayGetValueAtIndex(lines, i); // èŽ·å¾—æ¯ä¸€è¡Œçš„CGRectä¿¡æ¯ CGRect flippedRect = [self getLineBounds:line point:linePoint]; CGRect rect = CGRectApplyAffineTransform(flippedRect, transform); //å¦‚æžœç‚¹å‡»å¤„åœ¨å½“å‰è¡Œçš„èŒƒå›´ä¹‹å†… if (CGRectContainsPoint(rect, point)) &#123; // å°†ç‚¹å‡»çš„åæ ‡è½¬æ¢æˆç›¸å¯¹äºŽå½“å‰è¡Œçš„åæ ‡ CGPoint relativePoint = CGPointMake(point.x-CGRectGetMinX(rect), point.y-CGRectGetMinY(rect)); // èŽ·å¾—å½“å‰ç‚¹å‡»åæ ‡å¯¹åº”çš„å­—ç¬¦ä¸²åç§»ï¼Œè¿™é‡Œç‰¹åˆ«æ³¨æ„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç›¸å¯¹å½“å‰è¡Œçš„åæ ‡ï¼Œä¸æ˜¯ç›¸å¯¹æ•´ä¸ªframeåæ ‡ï¼Œæ•…éœ€è¦ä¹‹å‰çš„è½¬æ¢ idx = CTLineGetStringIndexForPosition(line, relativePoint); &#125; &#125; return idx;&#125;//èŽ·å–å½“å‰è¡Œçš„ä½ç½®å’Œå°ºå¯¸ï¼Œæ³¨æ„è¿™é‡Œçš„è¿”å›žçš„åæ ‡éƒ½æ˜¯CoreTextåæ ‡ï¼Œå’ŒUIKitçš„åæ ‡ç³»ä¸åŒ+ (CGRect)getLineBounds:(CTLineRef)line point:(CGPoint)point &#123; CGFloat ascent = 0.0f; CGFloat descent = 0.0f; CGFloat leading = 0.0f; //åŽé¢ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºä¸Šè¡Œé«˜åº¦ã€ä¸‹è¡Œé«˜åº¦ã€è¡Œé—´è·çš„åœ°å€ CGFloat width = (CGFloat)CTLineGetTypographicBounds(line, &amp;ascent, &amp;descent, &amp;leading); CGFloat height = ascent + descent; return CGRectMake(point.x, point.y - descent, width, height);&#125;//éåŽ†linkArrayï¼ŒæŸ¥çœ‹ç‚¹å‡»å¤„æ˜¯å¦åœ¨linkçš„RangeèŒƒå›´ä¹‹å†…+ (CoreTextLinkData *)linkAtIndex:(CFIndex)i linkArray:(NSArray *)linkArray &#123; CoreTextLinkData *link = nil; for (CoreTextLinkData *data in linkArray) &#123; if (NSLocationInRange(i, data.range)) &#123; link = data; //æ‰¾åˆ°ä¹‹åŽç›´æŽ¥è·³å‡ºå¾ªçŽ¯ï¼Œæ²¡æœ‰åˆ™è¿”å›žç©º break; &#125; &#125; return link;&#125;@end CTDisplayViewæ·»åŠ å¯¹å›¾ç‰‡ç‚¹å‡»çš„æ”¯æŒï¼Œæˆ‘ä»¬éœ€è¦ç»™CTDisplayViewç±»å¢žåŠ ç”¨æˆ·ç‚¹å‡»æ“ä½œçš„æ£€æµ‹å‡½æ•°ï¼Œåœ¨æ£€æµ‹å‡½æ•°ä¸­ï¼Œåˆ¤æ–­å½“å‰ç”¨æˆ·ç‚¹å‡»çš„åŒºåŸŸæ˜¯å¦åœ¨å›¾ç‰‡ä¸Šï¼Œå¦‚æžœåœ¨å›¾ç‰‡ä¸Šï¼Œåˆ™è§¦å‘ç‚¹å‡»å›¾ç‰‡çš„é€»è¾‘ã€‚è‹¹æžœæä¾›çš„UITapGestureRecognizerå¯ä»¥å¾ˆå¥½çš„æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç”¨å®ƒæ¥æ£€æµ‹ç”¨æˆ·çš„ç‚¹å‡»æ“ä½œã€‚ 123456789101112131415- (id)initWithCoder:(NSCoder *)aDecoder &#123; self = [super initWithCoder:aDecoder]; if (self) &#123; [self setupEvents]; &#125; return self;&#125;- (void)setupEvents &#123; UIGestureRecognizer * tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(userTapGestureDetected:)]; tapRecognizer.delegate = self; [self addGestureRecognizer:tapRecognizer]; self.userInteractionEnabled = YES;&#125; ç„¶åŽå¢žåŠ UITapGestureRecognizerçš„å›žè°ƒå‡½æ•° 123456789101112131415161718192021222324252627282930313233//ç‚¹å‡»Viewæ—¶è°ƒç”¨- (void)userTapGestureDetected:(UIGestureRecognizer *)recognizer &#123; //èŽ·å–ç‚¹å‡»å¤„çš„ä½ç½® CGPoint point = [recognizer locationInView:self]; //éåŽ†imageArrayï¼Œåˆ¤æ–­ç‚¹å‡»å¤„æ˜¯å¦åœ¨å›¾ç‰‡çš„RectèŒƒå›´ä¹‹å†… for (CoreTextImageData * imageData in self.data.imageArray) &#123; // ç¿»è½¬åæ ‡ç³»ï¼Œå› ä¸ºimageDataä¸­çš„åæ ‡æ˜¯CoreTextçš„åæ ‡ç³» CGRect imageRect = imageData.imagePosition; CGPoint imagePosition = imageRect.origin; //æ­¤å¤„ä¸ºè®¡ç®—åœ¨UIKitåæ ‡ç³»ä¸­å›¾ç‰‡åŽŸç‚¹çš„çºµåæ ‡ï¼Œæ¯”è¾ƒæŠ½è±¡ï¼Œå¯ç”»å›¾ç†è§£ä¸‹ imagePosition.y = self.bounds.size.height - imageRect.origin.y - imageRect.size.height; //è¿™ä¸ªRectæ˜¯CoreTextåæ ‡è½¬æ¢åŽçš„UIKitåæ ‡ CGRect rect = CGRectMake(imagePosition.x, imagePosition.y, imageRect.size.width, imageRect.size.height); // æ£€æµ‹ç‚¹å‡»ä½ç½® Point æ˜¯å¦åœ¨rectä¹‹å†… if (CGRectContainsPoint(rect, point)) &#123; NSLog(@&quot;hit image&quot;); // åœ¨è¿™é‡Œå¤„ç†ç‚¹å‡»åŽçš„é€»è¾‘ NSDictionary *userInfo = @&#123; @&quot;imageData&quot;: imageData &#125;; [[NSNotificationCenter defaultCenter] postNotificationName:CTDisplayViewImagePressedNotification object:self userInfo:userInfo]; return; &#125; &#125; //ä»£ç åˆ°æ­¤å¤„è¯´æ˜Žç‚¹å‡»å¤„ä¸åœ¨å›¾ç‰‡ä¸Šï¼Œä¸‹ä¸€æ­¥æ£€æŸ¥æ˜¯å¦åœ¨é“¾æŽ¥ä¸Š //è¿”å›žä¸ºç©ºçš„è¯è¯´æ˜Žä¸åœ¨ï¼Œè¿™é‡Œä¸è¿›è¡Œå¤„ç†ç‚¹å‡»äº‹ä»¶ï¼Œæœ‰è¿”å›žå€¼åˆ™å‘é€é€šçŸ¥æ¶ˆæ¯ç»™Controllerï¼Œæ‰§è¡Œè·³è½¬æ“ä½œ CoreTextLinkData *linkData = [CoreTextUtils touchLinkInView:self atPoint:point data:self.data]; if (linkData) &#123; NSDictionary *userInfo = @&#123; @&quot;linkData&quot;: linkData &#125;; [[NSNotificationCenter defaultCenter] postNotificationName:CTDisplayViewLinkPressedNotification object:self userInfo:userInfo]; return; &#125;&#125; åœ¨ç•Œé¢ä¸Šï¼ŒCTDisplayViewé€šå¸¸åœ¨UIViewçš„æ ‘å½¢å±‚çº§ç»“æž„ä¸­ï¼Œä¸€ä¸ª UIView å¯èƒ½æ˜¯æœ€å¤–å±‚ View Controller çš„ View çš„å­©å­çš„å­©å­çš„å­©å­ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ã€‚åœ¨è¿™ç§å¤šçº§å±‚æ¬¡ç»“æž„ä¸­ï¼Œå¾ˆéš¾é€šè¿‡delegateæ¨¡å¼å°†å›¾ç‰‡ç‚¹å‡»çš„äº‹ä»¶ä¸€å±‚ä¸€å±‚å¾€å¤–å±‚ä¼ é€’ï¼Œæ‰€ä»¥æœ€å¥½ä½¿ç”¨NSNotificationï¼Œæ¥å¤„ç†å›¾ç‰‡ç‚¹å‡»äº‹ä»¶ã€‚ è‡³æ­¤ï¼Œä¸€ä¸ªåŒ…å«äº†ç‰¹æ®Šæ–‡å­—å¤„ç†ã€å›¾ç‰‡ã€é“¾æŽ¥ç‚¹å‡»çš„å›¾æ–‡æ··æŽ’ç¨‹åºå·²ç»åŸºæœ¬å®žçŽ°äº†ã€‚å…¶ä»–ç»†èŠ‚éƒ¨åˆ†æ¯”å¦‚å›¾ç‰‡æµè§ˆå™¨ï¼Œwebæµè§ˆå™¨ã€ç‚¹å‡»å›¾ç‰‡ã€é“¾æŽ¥å¤„ç†è¯¦æƒ…ç­‰éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œå‚è€ƒDemoå®žçŽ°å³å¯ã€‚]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>CoreText</tag>
        <tag>å›¾æ–‡æ··æŽ’</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆè¯†Linux]]></title>
    <url>%2F2018%2F06%2F14%2F%E5%88%9D%E8%AF%86Linux%2F</url>
    <content type="text"><![CDATA[ä¸ºä»€ä¹ˆè¦å­¦Linuxå¦‚æžœä½ æ˜¯ä¸€ä¸ªå‰ç«¯çš„å¼€å‘è€…ï¼Œä¹Ÿè®¸ä½ å’Œæˆ‘æœ‰ç›¸ä¼¼çš„ç»åŽ†ï¼šç»å¸¸è¦å’Œå„ç§ç»ˆç«¯å‘½ä»¤æ‰“äº¤é“ï¼Œæ—¥å¸¸ä»£ç çš„ç‰ˆæœ¬ç®¡ç†ï¼Œè½¯ä»¶å®‰è£…ï¼Œæˆ–è€…æ­å»ºä¸€ä¸ªåšå®¢ç­‰ç­‰ï¼Œå®ƒä»¬çš„å¤§å¤šæ•°çš„æ“ä½œéœ€è¦ç”¨å‘½ä»¤è¡Œæ¥å®Œæˆã€‚ç›¸æ¯”äºŽå„ç§æ“ä½œçš„å›¾å½¢å®¢æˆ·ç«¯ï¼Œç¼ºå°‘äº†ä¸€ç§å¯è§†åŒ–çš„ä¸œè¥¿ï¼Œä½†å¯¹äºŽå·¥ä½œæ•ˆçŽ‡çš„æå‡ç»æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚å°±æ‹¿Gitç‰ˆæœ¬ç®¡ç†å·¥å…·æ¥è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼äºŽSourcetreeæˆ–è€…towerç­‰å›¾å½¢ç•Œé¢çš„ç®¡ç†å·¥å…·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨çœ‹èµ·æ¥æœ‰äº›â€œåŽŸå§‹â€çš„å‘½ä»¤è¡Œï¼Œä½†åŽè€…çš„å¤šæ•°æŒ‡ä»¤æ˜¯å¤šå¹³å°é€šç”¨çš„ï¼ŒçœåŽ»äº†æ¢ä¸€ç§å›¾å½¢å·¥å…·å°±éœ€è¦é‡æ–°å­¦ä¹ çš„éº»çƒ¦ï¼Œå¹¶ä¸”èƒ½å®Œæˆè¾ƒå‰è€…æ›´å¤æ‚çš„æ“ä½œã€‚ å¦‚æžœä½ æ˜¯ä¸€ä¸ªåŽå°å¼€å‘ã€‚ã€‚ã€‚ æ‰€ä»¥ï¼Œå½“å›žæœ›å¤§å­¦æœŸé—´çš„é‚£æ®µè‹¦æ¶©çš„Linuxå­¦ä¹ ç”Ÿæ¶¯ï¼Œä¸å¾—ä¸æ„Ÿå¹ï¼Œè‡ªæˆ‘é©±åŠ¨åŠ ä¸Šç›®çš„æ˜Žç¡®çš„å­¦ä¹ æ–¹å¼ï¼Œè¦æ¯”æ­»è®°ä¹¦æœ¬ä¸ŠèŒ«èŒ«çš„ä»£ç è¦æœ‰æ„ä¹‰ä¸”æ•ˆçŽ‡çš„å¤šã€‚ æ—¢ç„¶ç›®æ ‡æ˜Žç¡®äº†ï¼Œè¿™ç¯‡æ–‡ç« ä»¥ä¸‹çš„éƒ¨åˆ†å°±æ¥ä»Žè®¡ç®—æœºåŸºç¡€éƒ¨åˆ†å¼€å§‹ï¼Œé€æ­¥å±•å¼€Linuxè¾ƒä¸ºç³»ç»Ÿçš„å­¦ä¹ ï¼Œä¾›ä»¥åŽæŸ¥é˜…å‚è€ƒã€‚ æ“ä½œç³»ç»Ÿæ“ä½œç³»ç»Ÿèµ‹å€¼è°ƒç”¨è®¡ç®—æœºæˆ–è€…æ‰‹æœºè®¾å¤‡ï¼ˆç¡¬ä»¶ï¼‰ï¼Œæä¾›å…¶ä»–è½¯ä»¶å¯ä»¥è¿è¡Œçš„çŽ¯å¢ƒã€‚ æ“ä½œç³»ç»Ÿçš„å‘å±•å² Unix 1965å¹´ä¹‹å‰çš„æ—¶å€™ï¼Œç”µè„‘å¹¶ä¸åƒçŽ°åœ¨ä¸€æ ·æ™®éï¼Œå®ƒå¯ä¸æ˜¯ä¸€èˆ¬äººèƒ½ç¢°çš„èµ·çš„ï¼Œé™¤éžæ˜¯å†›äº‹æˆ–è€…å­¦é™¢çš„ç ”ç©¶æœºæž„ï¼Œè€Œä¸”å½“æ—¶å¤§åž‹ä¸»æœºè‡³å¤šèƒ½æä¾›30å°ç»ˆç«¯ï¼ˆ30ä¸ªé”®ç›˜ã€æ˜¾ç¤ºå™¨)ï¼Œè¿žæŽ¥ä¸€å°ç”µè„‘ Minix å› ä¸ºAT&amp;Tçš„æ”¿ç­–æ”¹å˜ï¼Œåœ¨Version 7 UnixæŽ¨å‡ºä¹‹åŽï¼Œå‘å¸ƒæ–°çš„ä½¿ç”¨æ¡æ¬¾ï¼Œå°†**UNIX**æºä»£ç ç§æœ‰åŒ–ï¼Œåœ¨å¤§å­¦ä¸­ä¸å†èƒ½ä½¿ç”¨UNIXæºä»£ç ã€‚Andrew S. Tanenbaum(å¡”èƒ½é²å§†ï¼Œè·å…°äººç¾Žå›½å›½ç±)æ•™æŽˆä¸ºäº†èƒ½åœ¨è¯¾å ‚ä¸Šæ•™æŽˆå­¦ç”Ÿæ“ä½œç³»ç»Ÿè¿ä½œçš„å®žåŠ¡ç»†èŠ‚ï¼Œå†³å®šåœ¨ä¸ä½¿ç”¨ä»»ä½•AT&amp;Tçš„æºä»£ç å‰æä¸‹ï¼Œè‡ªè¡Œå¼€å‘ä¸ŽUNIXå…¼å®¹çš„æ“ä½œç³»ç»Ÿï¼Œä»¥é¿å…ç‰ˆæƒä¸Šçš„äº‰è®®ã€‚ä»–ä»¥å°åž‹UNIXï¼ˆmini-UNIXï¼‰ä¹‹æ„ï¼Œå°†å®ƒç§°ä¸ºMINIXã€‚ Linux 1991å¹´å› ä¸ºMinixåªæ˜¯æ•™å­¦ä½¿ç”¨ï¼Œå› æ­¤åŠŸèƒ½å¹¶ä¸å¼ºï¼Œå› æ­¤Torvaldsï¼ˆæž—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼‰åˆ©ç”¨GNUçš„bashï¼ˆæ˜¯è®¸å¤šLinuxå‘è¡Œç‰ˆçš„é»˜è®¤Shellï¼‰å½“åšå¼€å‘çŽ¯å¢ƒï¼Œgccå½“åšç¼–è¯‘å·¥å…·ï¼Œç¼–å†™äº†Linuxå†…æ ¸-v0.02ï¼Œä½†æ˜¯ä¸€å¼€å§‹Linuxå¹¶ä¸èƒ½å…¼å®¹Unixï¼Œå³Unixä¸Šè·‘çš„åº”ç”¨ç¨‹åºä¸èƒ½åœ¨Linuxä¸Šè·‘ï¼Œå³åº”ç”¨ç¨‹åºä¸Žå†…æ ¸ä¹‹é—´çš„æŽ¥å£ä¸ä¸€è‡´ï¼Œå› ä¸ºUnixæ˜¯éµå¾ªPOSIXè§„èŒƒçš„ï¼Œå› æ­¤Torvaldsï¼ˆæ‰˜ç“¦å°”å…¹ï¼‰ä¿®æ”¹äº†Linuxï¼Œå¹¶éµå¾ªPOSIXï¼ˆPortable Operating System Interfaceï¼Œä»–è§„èŒƒäº†åº”ç”¨ç¨‹åºä¸Žå†…æ ¸çš„æŽ¥å£è§„èŒƒï¼‰ï¼› ä¸€å¼€å§‹Linuxåªé€‚ç”¨äºŽ386ï¼ŒåŽæ¥ç»è¿‡å…¨ä¸–ç•Œçš„ç½‘å‹çš„å¸®åŠ©ï¼Œæœ€ç»ˆèƒ½å¤Ÿå…¼å®¹å¤šç§ç¡¬ä»¶ï¼› æ”¯æŒå¤šä»»åŠ¡ æ‰˜ç“¦å°”å…¹1969å¹´12æœˆ28æ—¥å‡ºç”ŸäºŽèŠ¬å…°èµ«å°”è¾›åŸºå¸‚ï¼Œçˆ¶æ¯éƒ½æ˜¯è®°è€…ã€‚ä»–ä»Žå°å°±å¯¹è®¡ç®—æœºæ„Ÿå…´è¶£ã€‚1988å¹´ä»–è¿›å…¥èµ«å°”è¾›åŸºå¤§å­¦å­¦ä¹ ï¼Œä¸“ä¸šä¸ºè®¡ç®—æœºç§‘å­¦ã€‚1991å¹´ï¼Œä»–è´­ä¹°äº†ä¸€å°å±žäºŽè‡ªå·±çš„PCæœºã€‚èµ«å°”è¾›åŸºå¤§å­¦å½“æ—¶é‡‡ç”¨Unixæ“ä½œç³»ç»Ÿï¼Œæ‰˜ç“¦å°”å…¹è§‰å¾—è¯¥äº§å“æ€§èƒ½ä¸å°½å¦‚äººæ„ï¼ŒäºŽæ˜¯å°±å°è¯•ç€è‡ªå·±ç¼–å†™ä¸€æ¬¾æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œè¿™å°±æ˜¯Linuxæ“ä½œç³»ç»Ÿæ¥æºã€‚1997å¹´è‡³2003å¹´ï¼Œæ‰˜ç“¦å°”å…¹åœ¨ç¾Žå›½åŠ å·žå…¨ç¾Žè¾¾(Transmeta)å…¬å¸å·¥ä½œã€‚2003å¹´7æœˆï¼Œä»–åŠ ç›Ÿâ€œå¼€æ”¾æºä»£ç å¼€å‘å®žéªŒå®¤â€(OSDL)ï¼Œä»¥å…¨åŠ›å¼€å‘Linuxå†…æ ¸ã€‚åŽæ¥OSDLä¸Žâ€œå…è´¹æ ‡å‡†é›†å›¢â€(FSG)åˆå¹¶æˆç«‹äº†LinuxåŸºé‡‘ä¼šã€‚æ‰˜ç“¦å°”å…¹å¦‚ä»Šä»åœ¨LinuxåŸºé‡‘ä¼šå·¥ä½œ æ“ä½œç³»ç»Ÿçš„å‘å±• Ubuntuï¼ˆå‹å¸®æ‹“ã€ä¼˜èˆ¬å›¾ã€ä¹Œç­å›¾ï¼‰æ˜¯ä¸€ä¸ªä»¥æ¡Œé¢åº”ç”¨ä¸ºä¸»çš„å¼€æºGNU/Linuxæ“ä½œç³»ç»Ÿï¼ŒUbuntu æ˜¯åŸºäºŽDebian GNU/Linuxï¼Œæ”¯æŒx86ã€amd64ï¼ˆå³x64ï¼‰å’Œppcæž¶æž„ï¼Œç”±å…¨çƒåŒ–çš„ä¸“ä¸šå¼€å‘å›¢é˜Ÿï¼ˆCanonical Ltdï¼‰æ‰“é€ çš„ã€‚ Red Hatå…¬å¸å‘å¸ƒçš„é¢å‘ä¼ä¸šç”¨æˆ·çš„Linuxæ“ä½œç³»ç»Ÿã€‚ SUSE(å‘éŸ³ /ËˆsuËsÉ™/)æ˜¯æŒ‡SUSE Linux ï¼Œæ˜¯å¾·å›½ SuSE Linux AGå…¬å¸å‘è¡Œç»´æŠ¤çš„Linuxå‘è¡Œç‰ˆï¼Œæ˜¯å±žäºŽæ­¤å…¬å¸çš„æ³¨å†Œå•†æ ‡ã€‚ç¬¬ä¸€ä¸ªç‰ˆæœ¬å‡ºçŽ°åœ¨1994å¹´å¹´åˆã€‚2004å¹´è¿™å®¶å…¬å¸è¢«Novellå…¬å¸æ”¶è´­ã€‚ Fedora æ˜¯ä¸€ä¸ª Linux å‘è¡Œç‰ˆï¼Œæ˜¯ä¸€æ¬¾ç”±å…¨çƒç¤¾åŒºçˆ±å¥½è€…æž„å»ºçš„é¢å‘æ—¥å¸¸åº”ç”¨çš„å¿«é€Ÿã€ç¨³å®šã€å¼ºå¤§çš„æ“ä½œç³»ç»Ÿã€‚å®ƒå…è®¸ä»»ä½•äººè‡ªç”±åœ°ä½¿ç”¨ã€ä¿®æ”¹å’Œé‡å‘å¸ƒï¼Œæ— è®ºçŽ°åœ¨è¿˜æ˜¯å°†æ¥ã€‚å®ƒç”±ä¸€ä¸ªå¼ºå¤§çš„ç¤¾ç¾¤å¼€å‘ï¼Œè¿™ä¸ªç¤¾ç¾¤çš„æˆå‘˜ä»¥è‡ªå·±çš„ä¸æ‡ˆåŠªåŠ›ï¼Œæä¾›å¹¶ç»´æŠ¤è‡ªç”±ã€å¼€æ”¾æºç çš„è½¯ä»¶å’Œå¼€æ”¾çš„æ ‡å‡†ã€‚Fedora é¡¹ç›®ç”± Fedora åŸºé‡‘ä¼šç®¡ç†å’ŒæŽ§åˆ¶ï¼Œå¾—åˆ°äº† Red Hat çš„æ”¯æŒã€‚ Linuxä¸åŒç‰ˆæœ¬åŠåº”ç”¨é¢†åŸŸLinuxå†…æ ¸åŠå‘è¡Œç‰ˆæœ¬ä»‹ç» Linuxå†…æ ¸ç‰ˆæœ¬ å†…æ ¸(kernel)æ˜¯ç³»ç»Ÿçš„å¿ƒè„ï¼Œæ˜¯è¿è¡Œç¨‹åºå’Œç®¡ç†åƒç£ç›˜å’Œæ‰“å°æœºç­‰ç¡¬ä»¶è®¾å¤‡çš„æ ¸å¿ƒç¨‹åºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªåœ¨è£¸è®¾å¤‡ä¸Žåº”ç”¨ç¨‹åºé—´çš„æŠ½è±¡å±‚ã€‚ Linuxå†…æ ¸ç‰ˆæœ¬åˆåˆ†ä¸ºç¨³å®šç‰ˆå’Œå¼€å‘ç‰ˆï¼Œä¸¤ç§ç‰ˆæœ¬æ˜¯ç›¸äº’å…³è”ï¼Œç›¸äº’å¾ªçŽ¯ï¼š ç¨³å®šç‰ˆï¼šå…·æœ‰å·¥ä¸šçº§å¼ºåº¦ï¼Œå¯ä»¥å¹¿æ³›åœ°åº”ç”¨å’Œéƒ¨ç½²ã€‚æ–°çš„ç¨³å®šç‰ˆç›¸å¯¹äºŽè¾ƒæ—§çš„åªæ˜¯ä¿®æ­£ä¸€äº›bugæˆ–åŠ å…¥ä¸€äº›æ–°çš„é©±åŠ¨ç¨‹åºã€‚ å¼€å‘ç‰ˆï¼šç”±äºŽè¦è¯•éªŒå„ç§è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥å˜åŒ–å¾ˆå¿«ã€‚ å†…æ ¸æºç ç½‘å€ï¼šhttp://www.kernel.org æ‰€æœ‰æ¥è‡ªå…¨ä¸–ç•Œçš„å¯¹Linuxæºç çš„ä¿®æ”¹æœ€ç»ˆéƒ½ä¼šæ±‡æ€»åˆ°è¿™ä¸ªç½‘ç«™ï¼Œç”±Linusï¼ˆæž—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼‰é¢†å¯¼çš„å¼€æºç¤¾åŒºå¯¹å…¶è¿›è¡Œç”„åˆ«å’Œä¿®æ”¹æœ€ç»ˆå†³å®šæ˜¯å¦è¿›å…¥åˆ°Linuxä¸»çº¿å†…æ ¸æºç ä¸­ã€‚ Linuxå‘è¡Œç‰ˆæœ¬ Linuxå‘è¡Œç‰ˆ (ä¹Ÿè¢«å«åš GNU/Linux å‘è¡Œç‰ˆ) é€šå¸¸åŒ…å«äº†åŒ…æ‹¬æ¡Œé¢çŽ¯å¢ƒã€åŠžå…¬å¥—ä»¶ã€åª’ä½“æ’­æ”¾å™¨ã€æ•°æ®åº“ç­‰åº”ç”¨è½¯ä»¶ã€‚ GNUè®¡åˆ’ï¼šåˆç§°é©å¥´è®¡åˆ’ï¼Œæ˜¯ç”±Richard Stallmanåœ¨1983å¹´9æœˆ27æ—¥å…¬å¼€å‘èµ·çš„ã€‚å®ƒçš„ç›®æ ‡æ˜¯åˆ›å»ºä¸€å¥—å®Œå…¨è‡ªç”±çš„æ“ä½œç³»ç»Ÿã€‚Richard Stallmanæœ€æ—©æ˜¯åœ¨net.unix-wizardsæ–°é—»ç»„ä¸Šå…¬å¸ƒè¯¥æ¶ˆæ¯ï¼Œå¹¶é™„å¸¦ã€ŠGNUå®£è¨€ã€‹ç­‰è§£é‡Šä¸ºä½•å‘èµ·è¯¥è®¡åˆ’çš„æ–‡ç« ï¼Œå…¶ä¸­ä¸€ä¸ªç†ç”±å°±æ˜¯è¦â€œé‡çŽ°å½“å¹´è½¯ä»¶ç•Œåˆä½œäº’åŠ©çš„å›¢ç»“ç²¾ç¥žâ€ã€‚ä¸ºä¿è¯GNUè½¯ä»¶å¯ä»¥è‡ªç”±åœ°â€œä½¿ç”¨ã€å¤åˆ¶ã€ä¿®æ”¹å’Œå‘å¸ƒâ€ï¼Œæ‰€æœ‰GNUè½¯ä»¶éƒ½æœ‰ä¸€ä»½åœ¨ç¦æ­¢å…¶ä»–äººæ·»åŠ ä»»ä½•é™åˆ¶çš„æƒ…å†µä¸‹æŽˆæƒæ‰€æœ‰æƒåˆ©ç»™ä»»ä½•äººçš„åè®®æ¡æ¬¾ï¼ŒGNUé€šç”¨å…¬å…±è®¸å¯è¯ï¼ˆGNU General Public Licenseï¼ŒGPLï¼‰ã€‚å³â€œåç‰ˆæƒâ€ï¼ˆæˆ–ç§°Copyleftï¼‰æ¦‚å¿µã€‚ åº”ç”¨é¢†åŸŸ ä¸ªäººæ¡Œé¢é¢†åŸŸçš„åº”ç”¨ æ­¤é¢†åŸŸæ˜¯ä¼ ç»Ÿlinuxåº”ç”¨æœ€è–„å¼±çš„çŽ¯èŠ‚ï¼Œä¼ ç»Ÿlinuxç”±äºŽç•Œé¢ç®€å•ã€æ“ä½œå¤æ‚ã€åº”ç”¨è½¯ä»¶å°‘çš„ç¼ºç‚¹ï¼Œä¸€ç›´è¢«windowsæ‰€åŽ‹åˆ¶ï¼Œä½†è¿‘äº›å¹´æ¥éšç€ubuntuã€fedora [fÉªËˆdÉ”:rÉ™] ç­‰ä¼˜ç§€æ¡Œé¢çŽ¯å¢ƒçš„å…´èµ·ï¼ŒåŒæ—¶å„å¤§ç¡¬ä»¶åŽ‚å•†å¯¹å…¶æ”¯æŒçš„åŠ å¤§ï¼Œlinuxåœ¨ä¸ªäººæ¡Œé¢é¢†åŸŸçš„å æœ‰çŽ‡åœ¨é€æ¸çš„æé«˜ å…¸åž‹ä»£è¡¨ï¼šubuntuã€fedora [fÉªâ€™dÉ”ËrÉ™]ã€suse linux åœ¨Ubuntuä¸­çŽ©QQ æœåŠ¡å™¨é¢†åŸŸ linuxåœ¨æœåŠ¡å™¨é¢†åŸŸçš„åº”ç”¨æ˜¯å…¶é‡è¦åˆ†æ”¯ linuxå…è´¹ã€ç¨³å®šã€é«˜æ•ˆç­‰ç‰¹ç‚¹åœ¨è¿™é‡Œå¾—åˆ°äº†å¾ˆå¥½çš„ä½“çŽ°ï¼Œä½†æ—©æœŸå› ä¸ºç»´æŠ¤ã€è¿è¡Œç­‰åŽŸå› åŒæ ·å—åˆ°äº†å¾ˆå¤§çš„é™åˆ¶ï¼Œä½†è¿‘äº›å¹´æ¥linuxæœåŠ¡å™¨å¸‚åœºå¾—åˆ°äº†é£žé€Ÿçš„æå‡ï¼Œå°¤å…¶åœ¨ä¸€äº›é«˜ç«¯é¢†åŸŸå°¤ä¸ºå¹¿æ³› å…¸åž‹ä»£è¡¨ï¼š â€‹ Red Hatå…¬å¸çš„ASç³»åˆ— â€‹ å®Œå…¨å¼€æºçš„debianç³»åˆ— â€‹ suse EnterPrise 11ç³»åˆ—ç­‰ åµŒå…¥å¼é¢†åŸŸ æ™ºèƒ½ç¡¬ä»¶ è¿‘äº›å¹´æ¥linuxåœ¨åµŒå…¥å¼é¢†åŸŸçš„åº”ç”¨å¾—åˆ°äº†é£žé€Ÿçš„æé«˜ linuxè¿è¡Œç¨³å®šã€å¯¹ç½‘ç»œçš„è‰¯å¥½æ”¯æŒæ€§ã€ä½Žæˆæœ¬ï¼Œä¸”å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œè½¯ä»¶è£å‰ªï¼Œå†…æ ¸æœ€å°å¯ä»¥è¾¾åˆ°å‡ ç™¾KBç­‰ç‰¹ç‚¹ï¼Œä½¿å…¶è¿‘äº›å¹´æ¥åœ¨åµŒå…¥å¼é¢†åŸŸçš„åº”ç”¨å¾—åˆ°éžå¸¸å¤§çš„æé«˜ ä¸»è¦åº”ç”¨ï¼šæœºé¡¶ç›’ã€æ•°å­—ç”µè§†ã€ç½‘ç»œç”µè¯ã€ç¨‹æŽ§äº¤æ¢æœºã€æ‰‹æœºã€PDAã€æ™ºèƒ½å®¶å±…ã€æ™ºèƒ½ç¡¬ä»¶ç­‰éƒ½æ˜¯å…¶åº”ç”¨é¢†åŸŸï¼Œå¾—åˆ°äº†æ‘©æ‰˜ç½—æ‹‰ã€ä¸‰æ˜Ÿã€NECã€Googleç­‰å…¬å¸çš„å¤§åŠ›æŽ¨å¹¿ æ–‡ä»¶å’Œç›®å½•åœ¨å¸¸ç”¨çš„Windowså¹³å°ä¸‹ï¼Œæ‰“å¼€è®¡ç®—æœºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤šä¸ªæ ‘å¹¶åˆ—çš„ç›®å½•ç»“æž„ åœ¨ Linux ä¸‹ï¼Œæˆ‘ä»¬æ˜¯çœ‹ä¸åˆ°è¿™äº›é©±åŠ¨å™¨ç›˜ç¬¦ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ˜¯æ–‡ä»¶å¤¹ï¼ˆç›®å½•ï¼‰ï¼š ç±»Unixç³»ç»Ÿç›®å½•ç»“æž„ linuxæ²¡æœ‰ç›˜ç¬¦è¿™ä¸ªæ¦‚å¿µï¼Œåªæœ‰ä¸€ä¸ªæ ¹ç›®å½•/ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨å®ƒä¸‹é¢ æ‰“å¼€æŽ§åˆ¶å°å¿«æ·é”®ï¼šCtrl+Alt+T æŽ§åˆ¶å°æ–‡å­—è°ƒå¤§ï¼šCtrl+Shift++ï¼ˆCtrlé”®åŠ ä¸ŠShiftåŠ è½½+å·ï¼‰ æŽ§åˆ¶å°æ–‡å­—è°ƒå°ï¼šCtrl+-ï¼ˆï¼ˆCtrlé”®åŠ ä¸Šå‡å·ï¼‰ åœ¨ä¸€ä¸ªæŽ§åˆ¶å±‚æ‰“å¼€å¦å¤–ä¸€ä¸ªçª—å£ï¼šCtrl+Shift+T æ‰“å¼€å¤šä¸ªçª—å£å‘½ä»¤ï¼šCtrl+Shift+T åˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªçª—å£ï¼šAlt+1 åˆ‡æ¢åˆ°ç¬¬äºŒä¸ªçª—å£ï¼šAlt+2 åˆ‡æ¢åˆ°ç¬¬ä¸‰ä¸ªçª—å£ï¼šAlt+3 é€€å‡ºçª—å£å‘½ä»¤ï¼šexit Linuxç›®å½•ç®€ä»‹ /ï¼šæ ¹ç›®å½•ï¼Œä¸€èˆ¬æ ¹ç›®å½•ä¸‹åªå­˜æ”¾ç›®å½•ï¼Œåœ¨Linuxä¸‹æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ ¹ç›®å½•ã€‚æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯ä»Žè¿™é‡Œå¼€å§‹ã€‚å½“ä½ åœ¨ç»ˆç«¯é‡Œè¾“å…¥â€œ/homeâ€ï¼Œä½ å…¶å®žæ˜¯åœ¨å‘Šè¯‰ç”µè„‘ï¼Œå…ˆä»Ž/ï¼ˆæ ¹ç›®å½•ï¼‰å¼€å§‹ï¼Œå†è¿›å…¥åˆ°homeç›®å½•ã€‚ /binï¼š/usr/bin: å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç›®å½•ï¼Œç¨‹åºå°±å®‰è£…åœ¨è¿™ä¸ªç›®å½•ï¼Œå¦‚å¸¸ç”¨çš„å‘½ä»¤lsã€tarã€mvã€catç­‰ã€‚ /bootï¼šï¼ˆå¼•å¯¼çš„æ„æ€ï¼‰æ”¾ç½®linuxç³»ç»Ÿå¯åŠ¨æ—¶ç”¨åˆ°çš„ä¸€äº›æ–‡ä»¶ï¼Œå¦‚æžœåˆ é™¤äº†ï¼Œç”µè„‘æœ‰åˆå¯èƒ½å¯åŠ¨ä¸äº†ï¼Œå¦‚Linuxçš„å†…æ ¸æ–‡ä»¶ï¼š/boot/vmlinuzï¼Œç³»ç»Ÿå¼•å¯¼ç®¡ç†å™¨ï¼š/boot/grubã€‚ /devï¼šå­˜æ”¾linuxç³»ç»Ÿä¸‹çš„è®¾å¤‡æ–‡ä»¶ï¼Œè®¿é—®è¯¥ç›®å½•ä¸‹æŸä¸ªæ–‡ä»¶ï¼Œç›¸å½“äºŽè®¿é—®æŸä¸ªè®¾å¤‡ï¼Œå¸¸ç”¨çš„æ˜¯æŒ‚è½½å…‰é©± mount /dev/cdrom /mntã€‚ /etcï¼šç³»ç»Ÿé…ç½®æ–‡ä»¶å­˜æ”¾çš„ç›®å½•ï¼Œä¸å»ºè®®åœ¨æ­¤ç›®å½•ä¸‹å­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‡è¦çš„é…ç½®æ–‡ä»¶æœ‰ /etc/inittabã€/etc/fstabã€/etc/init.dã€/etc/X11ã€/etc/sysconfigã€/etc/xinetd.dã€‚ /homeï¼šç³»ç»Ÿé»˜è®¤çš„ç”¨æˆ·å®¶ç›®å½•ï¼Œæ–°å¢žç”¨æˆ·è´¦å·æ—¶ï¼Œç”¨æˆ·çš„å®¶ç›®å½•éƒ½å­˜æ”¾åœ¨æ­¤ç›®å½•ä¸‹ï¼Œ~è¡¨ç¤ºå½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œ~edu è¡¨ç¤ºç”¨æˆ· edu çš„å®¶ç›®å½•ã€‚æ³¨æ„ï¼Œä»¥åŽä½ è¦åšä»»ä½•äº‹æƒ…å»ºè®®éƒ½åœ¨è¿™é‡Œåšï¼Œå…¶ä»–ç›®å½•ä¸è¦éšä¾¿åˆ é™¤ã€‚ /libã€/usr/libã€/usr/local/libï¼šç³»ç»Ÿä½¿ç”¨çš„å‡½æ•°åº“çš„ç›®å½•ï¼Œç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦è°ƒç”¨ä¸€äº›é¢å¤–çš„å‚æ•°æ—¶éœ€è¦å‡½æ•°åº“çš„ååŠ©ã€‚ /rootï¼šç³»ç»Ÿç®¡ç†å‘˜rootçš„å®¶ç›®å½•ã€‚ /lost+fountï¼šç³»ç»Ÿå¼‚å¸¸äº§ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šå°†ä¸€äº›é—å¤±çš„ç‰‡æ®µæ”¾ç½®äºŽæ­¤ç›®å½•ä¸‹ã€‚ /mnt: /mediaï¼šå…‰ç›˜é»˜è®¤æŒ‚è½½ç‚¹ï¼Œé€šå¸¸å…‰ç›˜æŒ‚è½½äºŽ /mnt/cdrom ä¸‹ï¼Œä¹Ÿä¸ä¸€å®šï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ä½ç½®è¿›è¡ŒæŒ‚è½½ã€‚ /optï¼šç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚ /procï¼šæ­¤ç›®å½•çš„æ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œå¦‚ç³»ç»Ÿæ ¸å¿ƒï¼Œå¤–éƒ¨è®¾å¤‡ï¼Œç½‘ç»œçŠ¶æ€ï¼Œç”±äºŽæ•°æ®éƒ½å­˜æ”¾äºŽå†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œæ¯”è¾ƒé‡è¦çš„ç›®å½•æœ‰ /proc/cpuinfoã€/proc/interruptsã€/proc/dmaã€/proc/ioportsã€/proc/net/ ç­‰ã€‚ /sbinã€/usr/sbinã€/usr/local/sbinï¼šæ”¾ç½®ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„å¯æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚fdiskã€shutdownã€mount ç­‰ã€‚ä¸Ž /bin ä¸åŒçš„æ˜¯ï¼Œè¿™å‡ ä¸ªç›®å½•æ˜¯ç»™ç³»ç»Ÿç®¡ç†å‘˜ rootä½¿ç”¨çš„å‘½ä»¤ï¼Œä¸€èˆ¬ç”¨æˆ·åªèƒ½â€æŸ¥çœ‹â€è€Œä¸èƒ½è®¾ç½®å’Œä½¿ç”¨ã€‚ /tmpï¼šä¸€èˆ¬ç”¨æˆ·æˆ–æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºä¸´æ—¶å­˜æ”¾æ–‡ä»¶çš„ç›®å½•ï¼Œä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ï¼Œé‡è¦æ•°æ®ä¸å¯æ”¾ç½®åœ¨æ­¤ç›®å½•ä¸‹ã€‚ /srvï¼šæœåŠ¡å¯åŠ¨ä¹‹åŽéœ€è¦è®¿é—®çš„æ•°æ®ç›®å½•ï¼Œå¦‚ www æœåŠ¡éœ€è¦è®¿é—®çš„ç½‘é¡µæ•°æ®å­˜æ”¾åœ¨ /srv/www å†…ã€‚ /usrï¼šåº”ç”¨ç¨‹åºå­˜æ”¾ç›®å½•ï¼Œ/usr/bin å­˜æ”¾åº”ç”¨ç¨‹åºï¼Œ/usr/share å­˜æ”¾å…±äº«æ•°æ®ï¼Œ/usr/lib å­˜æ”¾ä¸èƒ½ç›´æŽ¥è¿è¡Œçš„ï¼Œå´æ˜¯è®¸å¤šç¨‹åºè¿è¡Œæ‰€å¿…éœ€çš„ä¸€äº›å‡½æ•°åº“æ–‡ä»¶ã€‚/usr/local: å­˜æ”¾è½¯ä»¶å‡çº§åŒ…ã€‚/usr/share/doc: ç³»ç»Ÿè¯´æ˜Žæ–‡ä»¶å­˜æ”¾ç›®å½•ã€‚/usr/share/man: ç¨‹åºè¯´æ˜Žæ–‡ä»¶å­˜æ”¾ç›®å½•ã€‚ /varï¼šæ”¾ç½®ç³»ç»Ÿæ‰§è¡Œè¿‡ç¨‹ä¸­ç»å¸¸å˜åŒ–çš„æ–‡ä»¶ï¼Œå¦‚éšæ—¶æ›´æ”¹çš„æ—¥å¿—æ–‡ä»¶ /var/logï¼Œ/var/log/messageï¼šæ‰€æœ‰çš„ç™»å½•æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œ/var/spool/mailï¼šé‚®ä»¶å­˜æ”¾çš„ç›®å½•ï¼Œ/var/run:ç¨‹åºæˆ–æœåŠ¡å¯åŠ¨åŽï¼Œå…¶PIDå­˜æ”¾åœ¨è¯¥ç›®å½•ä¸‹ã€‚ ç”¨æˆ·ç›®å½•cdå‘½ä»¤ cdæ˜¯change dir ç®€ç§°ï¼Œç”¨äºŽåˆ‡æ¢ç›®å½• å®¶ç›®å½• ä½äºŽ/home/userï¼Œç§°ä¹‹ä¸ºç”¨æˆ·å·¥ä½œç›®å½•æˆ–å®¶ç›®å½•,è¡¨ç¤ºæ–¹å¼ï¼š æŸ¥çœ‹å½“å‰åœ¨ä¸ªç›®å½•ï¼Œpwd è·³è½¬åˆ°å½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œcd ~ æ–‡ä»¶æƒé™ç†è§£ æ–‡ä»¶æƒé™ æ–‡ä»¶æƒé™å°±æ˜¯æ–‡ä»¶çš„è®¿é—®æŽ§åˆ¶æƒé™ï¼Œå³å“ªäº›ç”¨æˆ·å’Œç»„ç¾¤å¯ä»¥è®¿é—®æ–‡ä»¶ä»¥åŠå¯ä»¥æ‰§è¡Œä»€ä¹ˆæ ·çš„æ“ä½œã€‚ Unix/Linuxç³»ç»Ÿæ˜¯ä¸€ä¸ªå…¸åž‹çš„å¤šç”¨æˆ·ç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·å¤„äºŽä¸åŒçš„åœ°ä½ï¼Œå¯¹æ–‡ä»¶å’Œç›®å½•æœ‰ä¸åŒçš„è®¿é—®æƒé™ã€‚ä¸ºäº†ä¿æŠ¤ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼ŒUnix/Linuxç³»ç»Ÿé™¤äº†å¯¹ç”¨æˆ·æƒé™ä½œäº†ä¸¥æ ¼çš„ç•Œå®šå¤–ï¼Œè¿˜åœ¨ç”¨æˆ·èº«ä»½è®¤è¯ã€è®¿é—®æŽ§åˆ¶ã€ä¼ è¾“å®‰å…¨ã€æ–‡ä»¶è¯»å†™æƒé™ç­‰æ–¹é¢ä½œäº†å‘¨å¯†çš„æŽ§åˆ¶ã€‚ åœ¨ Unix/Linuxä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•éƒ½åŒ…å«æœ‰è®¿é—®æƒé™ï¼Œè¿™äº›è®¿é—®æƒé™å†³å®šäº†è°èƒ½è®¿é—®å’Œå¦‚ä½•è®¿é—®è¿™äº›æ–‡ä»¶å’Œç›®å½•ã€‚ è®¿é—®ç”¨æˆ· é€šè¿‡è®¾å®šæƒé™å¯ä»¥ä»Žä»¥ä¸‹ä¸‰ç§è®¿é—®æ–¹å¼é™åˆ¶è®¿é—®æƒé™ï¼š åªå…è®¸ç”¨æˆ·è‡ªå·±è®¿é—®ï¼ˆæ‰€æœ‰è€…ï¼‰ æ‰€æœ‰è€…å°±æ˜¯åˆ›å»ºæ–‡ä»¶çš„ç”¨æˆ·ï¼Œç”¨æˆ·æ˜¯æ‰€æœ‰ç”¨æˆ·æ‰€åˆ›å»ºæ–‡ä»¶çš„æ‰€æœ‰è€…ï¼Œç”¨æˆ·å¯ä»¥å…è®¸æ‰€åœ¨çš„ç”¨æˆ·ç»„èƒ½è®¿é—®ç”¨æˆ·çš„æ–‡ä»¶ã€‚ å…è®¸ä¸€ä¸ªé¢„å…ˆæŒ‡å®šçš„ç”¨æˆ·ç»„ä¸­çš„ç”¨æˆ·è®¿é—®ï¼ˆç”¨æˆ·ç»„ï¼‰ ç”¨æˆ·éƒ½ç»„åˆæˆç”¨æˆ·ç»„ï¼Œä¾‹å¦‚ï¼ŒæŸä¸€ç±»æˆ–æŸä¸€é¡¹ç›®ä¸­çš„æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½å¤Ÿè¢«ç³»ç»Ÿç®¡ç†å‘˜å½’ä¸ºä¸€ä¸ªç”¨æˆ·ç»„ï¼Œä¸€ä¸ªç”¨æˆ·èƒ½å¤ŸæŽˆäºˆæ‰€åœ¨ç”¨æˆ·ç»„çš„å…¶ä»–æˆå‘˜çš„æ–‡ä»¶è®¿é—®æƒé™ã€‚ å…è®¸ç³»ç»Ÿä¸­çš„ä»»ä½•ç”¨æˆ·è®¿é—®ï¼ˆå…¶ä»–ç”¨æˆ·ï¼‰ ç”¨æˆ·ä¹Ÿå°†è‡ªå·±çš„æ–‡ä»¶å‘ç³»ç»Ÿå†…çš„æ‰€æœ‰ç”¨æˆ·å¼€æ”¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå†…çš„æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½å¤Ÿè®¿é—®ç”¨æˆ·çš„ç›®å½•æˆ–æ–‡ä»¶ã€‚åœ¨è¿™ç§æ„ä¹‰ä¸Šï¼Œç³»ç»Ÿå†…çš„å…¶ä»–æ‰€æœ‰ç”¨æˆ·å°±æ˜¯ other ç”¨æˆ·ç±» è®¿é—®æƒé™ ç”¨æˆ·èƒ½å¤ŸæŽ§åˆ¶ä¸€ä¸ªç»™å®šçš„æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®ç¨‹åº¦ï¼Œä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•å¯èƒ½æœ‰è¯»ã€å†™åŠæ‰§è¡Œæƒé™ï¼š è¯»æƒé™ï¼ˆrï¼‰ å¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰è¯»å–æ–‡ä»¶å†…å®¹çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´ï¼Œå…·æœ‰æµè§ˆç›®å½•çš„æƒé™ã€‚ å†™æƒé™ï¼ˆwï¼‰ å¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰æ–°å¢žã€ä¿®æ”¹æ–‡ä»¶å†…å®¹çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´ï¼Œå…·æœ‰åˆ é™¤ã€ç§»åŠ¨ç›®å½•å†…æ–‡ä»¶çš„æƒé™ã€‚ å¯æ‰§è¡Œæƒé™ï¼ˆxï¼‰ å¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰æ‰§è¡Œæ–‡ä»¶çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´è¯¥ç”¨æˆ·å…·æœ‰è¿›å…¥ç›®å½•çš„æƒé™ã€‚ æ³¨æ„ï¼šé€šå¸¸ï¼ŒUnix/Linuxç³»ç»Ÿåªå…è®¸æ–‡ä»¶çš„å±žä¸»(æ‰€æœ‰è€…)æˆ–è¶…çº§ç”¨æˆ·æ”¹å˜æ–‡ä»¶çš„è¯»å†™æƒé™ã€‚ ç¤ºä¾‹è¯´æ˜Ž ã€ ç¬¬1ä¸ªå­—æ¯ä»£è¡¨æ–‡ä»¶çš„ç±»åž‹ï¼šâ€œdâ€ ä»£è¡¨æ–‡ä»¶å¤¹ã€â€œ-â€ ä»£è¡¨æ™®é€šæ–‡ä»¶ã€â€œcâ€ ä»£è¡¨ç¡¬ä»¶å­—ç¬¦è®¾å¤‡ã€â€œbâ€ ä»£è¡¨ç¡¬ä»¶å—è®¾å¤‡ã€â€œsâ€è¡¨ç¤ºç®¡é“æ–‡ä»¶ã€â€œlâ€ ä»£è¡¨è½¯é“¾æŽ¥æ–‡ä»¶(læ˜¯Lçš„å°å†™)ã€‚ åŽ 9 ä¸ªå­—æ¯åˆ†åˆ«ä»£è¡¨ä¸‰ç»„æƒé™ï¼šæ–‡ä»¶æ‰€æœ‰è€…ã€ç”¨æˆ·è€…ã€å…¶ä»–ç”¨æˆ·æ‹¥æœ‰çš„æƒé™ã€‚ æ¯ä¸€ä¸ªç”¨æˆ·éƒ½æœ‰å®ƒè‡ªèº«çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚ ç¬¬ä¸€ç»„æƒé™æŽ§åˆ¶è®¿é—®è‡ªå·±çš„æ–‡ä»¶æƒé™ï¼Œå³æ‰€æœ‰è€…æƒé™ã€‚ ç¬¬äºŒç»„æƒé™æŽ§åˆ¶ç”¨æˆ·ç»„è®¿é—®å…¶ä¸­ä¸€ä¸ªç”¨æˆ·çš„æ–‡ä»¶çš„æƒé™ã€‚ ç¬¬ä¸‰ç»„æƒé™æŽ§åˆ¶å…¶ä»–æ‰€æœ‰ç”¨æˆ·è®¿é—®ä¸€ä¸ªç”¨æˆ·çš„æ–‡ä»¶çš„æƒé™ã€‚ è¿™ä¸‰ç»„æƒé™èµ‹äºˆç”¨æˆ·ä¸åŒç±»åž‹ï¼ˆå³æ‰€æœ‰è€…ã€ç”¨æˆ·ç»„å’Œå…¶ä»–ç”¨æˆ·ï¼‰çš„è¯»ã€å†™åŠæ‰§è¡Œæƒé™å°±æž„æˆäº†ä¸€ä¸ªæœ‰9ç§ç±»åž‹çš„æƒé™ç»„ã€‚]]></content>
      <categories>
        <category>Linuxå­¦ä¹ æ€»ç»“</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå‘½ä»¤(äºŒ)]]></title>
    <url>%2F2018%2F03%2F03%2FLinux%E5%91%BD%E4%BB%A4(%E4%BA%8C)%2F</url>
    <content type="text"><![CDATA[ç”¨æˆ·ã€ç”¨æˆ·ç»„ã€æ–‡ä»¶ç®¡ç†ç”¨æˆ·æ˜¯Unix/Linuxç³»ç»Ÿå·¥ä½œä¸­é‡è¦çš„ä¸€çŽ¯ï¼Œç”¨æˆ·ç®¡ç†åŒ…æ‹¬ç”¨æˆ·ä¸Žç»„è´¦å·çš„ç®¡ç†ã€‚åœ¨Unix/Linuxç³»ç»Ÿä¸­ï¼Œä¸è®ºæ˜¯ç”±æœ¬æœºæˆ–æ˜¯è¿œç¨‹ç™»å½•ç³»ç»Ÿï¼Œæ¯ä¸ªç³»ç»Ÿéƒ½å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªè´¦å·ï¼Œå¹¶ä¸”å¯¹äºŽä¸åŒçš„ç³»ç»Ÿèµ„æºæ‹¥æœ‰ä¸åŒçš„ä½¿ç”¨æƒé™ã€‚Unix/Linuxç³»ç»Ÿä¸­çš„rootè´¦å·é€šå¸¸ç”¨äºŽç³»ç»Ÿçš„ç»´æŠ¤å’Œç®¡ç†ï¼Œå®ƒå¯¹Unix/Linuxæ“ä½œç³»ç»Ÿçš„æ‰€æœ‰éƒ¨åˆ†å…·æœ‰ä¸å—é™åˆ¶çš„è®¿é—®æƒé™ã€‚åœ¨Unix/Linuxå®‰è£…çš„è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºè®¸å¤šç”¨æˆ·è´¦å·ï¼Œè€Œè¿™äº›é»˜è®¤çš„ç”¨æˆ·å°±ç§°ä¸ºâ€œæ ‡å‡†ç”¨æˆ·â€ã€‚åœ¨å¤§å¤šæ•°ç‰ˆæœ¬çš„Unix/Linuxä¸­ï¼Œéƒ½ä¸æŽ¨èç›´æŽ¥ä½¿ç”¨rootè´¦å·ç™»å½•ç³»ç»Ÿã€‚ ç”¨æˆ·ç®¡ç†æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼šwhowhoamiè¯¥å‘½ä»¤ç”¨æˆ·æŸ¥çœ‹å½“å‰ç³»ç»Ÿå½“å‰è´¦å·çš„ç”¨æˆ·åï¼ŒæŸ¥çœ‹ç™»å½•ç”¨æˆ·ï¼šwhoã€‚å¸¸ç”¨é€‰é¡¹ï¼š é€‰é¡¹ å«ä¹‰ -mæˆ–am I åªæ˜¾ç¤ºè¿è¡Œwhoå‘½ä»¤çš„ç”¨æˆ·åã€ç™»å½•ç»ˆç«¯å’Œç™»å½•æ—¶é—´ -qæˆ–â€“count åªæ˜¾ç¤ºç”¨æˆ·çš„ç™»å½•è´¦å·å’Œç™»å½•ç”¨æˆ·çš„æ•°é‡ -uæˆ–â€“heading æ˜¾ç¤ºåˆ—æ ‡é¢˜ who -u ç¬¬ä¸€åˆ—æ˜¾ç¤ºç”¨æˆ·åç§° ç¬¬äºŒåˆ—æ˜¾ç¤ºç”¨æˆ·è¿žæŽ¥æ–¹å¼ã€‚ttyæ„å‘³ç€ç”¨æˆ·ç›´æŽ¥è¿žæŽ¥åˆ°ç”µè„‘ä¸Šï¼Œè€Œptsæ„å‘³ç€è¿œç¨‹ç™»å½•ã€‚ ç¬¬ä¸‰ã€å››åˆ—åˆ†åˆ«æ˜¾ç¤ºæ—¥æœŸå’Œæ—¶é—´ ç¬¬äº”åˆ—æ˜¾ç¤ºç”¨æˆ·ç™»å½•IPåœ°å€ã€‚ é€šè¿‡cat /etc/passwdæŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ä¿¡æ¯ç”±äºŽç³»ç»Ÿç®¡ç†å‘˜é€šå¸¸éœ€è¦ä½¿ç”¨å¤šç§èº«ä»½ç™»å½•ç³»ç»Ÿï¼Œä¾‹å¦‚é€šå¸¸ä½¿ç”¨æ™®é€šç”¨æˆ·ç™»å½•ç³»ç»Ÿï¼Œç„¶åŽå†ä»¥suå‘½ä»¤åˆ‡æ¢åˆ°rootèº«ä»½å¯¹ä¼ ç»Ÿè¿›è¡Œç®¡ç†ã€‚è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨whoamiæ¥æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„èº«ä»½ã€‚ é€šè¿‡cat /etc/group æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·ç»„ä¿¡æ¯æ·»åŠ ç”¨æˆ·è´¦å·ï¼šuseraddåœ¨Unix/Linuxä¸­æ·»åŠ ç”¨æˆ·è´¦å·å¯ä»¥ä½¿ç”¨adduseræˆ–useraddå‘½ä»¤ï¼Œå› ä¸ºadduserå‘½ä»¤æ˜¯æŒ‡å‘useraddå‘½ä»¤çš„ä¸€ä¸ªé“¾æŽ¥ï¼Œå› æ­¤ï¼Œè¿™ä¸¤ä¸ªå‘½ä»¤çš„ä½¿ç”¨æ ¼å¼å®Œå…¨ä¸€æ ·ã€‚useraddå‘½ä»¤çš„ä½¿ç”¨æ ¼å¼å¦‚ä¸‹ï¼š useradd [å‚æ•°] æ–°å»ºç”¨æˆ·è´¦å· å‚æ•° å«ä¹‰ -d æŒ‡å®šç”¨æˆ·ç™»å½•ç³»ç»Ÿæ—¶çš„ä¸»ç›®å½•ï¼Œå¦‚æžœä¸ä½¿ç”¨è¯¥å‚æ•°ï¼Œç³»ç»Ÿè‡ªåŠ¨åœ¨/homeç›®å½•ä¸‹å»ºç«‹ä¸Žç”¨æˆ·ååŒåç›®å½•ä¸ºä¸»ç›®å½• -m è‡ªåŠ¨å»ºç«‹ç›®å½• -g æŒ‡å®šç»„åç§° ç›¸å…³è¯´æ˜Žï¼š Linuxæ¯ä¸ªç”¨æˆ·éƒ½è¦æœ‰ä¸€ä¸ªä¸»ç›®å½•ï¼Œä¸»ç›®å½•å°±æ˜¯ç¬¬ä¸€æ¬¡ç™»é™†ç³»ç»Ÿï¼Œç”¨æˆ·çš„é»˜è®¤å½“å‰ç›®å½•(/home/ç”¨æˆ·)ï¼›æ¯ä¸€ä¸ªç”¨æˆ·å¿…é¡»æœ‰ä¸€ä¸ªä¸»ç›®å½•ï¼Œæ‰€ä»¥ç”¨useraddåˆ›å»ºç”¨æˆ·çš„æ—¶å€™ï¼Œä¸€å®šç»™ç”¨æˆ·æŒ‡å®šä¸€ä¸ªä¸»ç›®å½•ï¼›ç”¨æˆ·çš„ä¸»ç›®å½•ä¸€èˆ¬è¦æ”¾åˆ°æ ¹ç›®å½•çš„homeç›®å½•ä¸‹ï¼Œç”¨æˆ·çš„ä¸»ç›®å½•å’Œç”¨æˆ·åæ˜¯ç›¸åŒçš„ï¼›å¦‚æžœåˆ›å»ºç”¨æˆ·çš„æ—¶å€™ï¼Œä¸æŒ‡å®šç»„åï¼Œé‚£ä¹ˆç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå’Œç”¨æˆ·åä¸€æ ·çš„ç»„å; æ¡ˆä¾‹ å‘½ä»¤ å«ä¹‰ useradd test -m åˆ›å»ºtestç”¨æˆ·ï¼Œå¦‚æžœ/home/testä¸å­˜åœ¨ï¼Œå°±è‡ªåŠ¨åˆ›å»º,ä¸æŒ‡å®šé»˜è®¤ä¹Ÿæ˜¯å±žäºŽabcç”¨æˆ·ç»„ useradd -d /home/abc abc -m åˆ›å»ºabcç”¨æˆ·ï¼Œå¦‚æžœ/home/abcç›®å½•ä¸å­˜åœ¨ï¼Œå°±è‡ªåŠ¨åˆ›å»ºè¿™ä¸ªç›®å½•ï¼ŒåŒæ—¶ç”¨æˆ·å±žäºŽabcç»„ useradd -d /home/a a -g test -m åˆ›å»ºä¸€ä¸ªç”¨æˆ·åå­—å«aï¼Œä¸»ç›®å½•åœ¨/home/aï¼Œå¦‚æžœä¸»ç›®å½•ä¸å­˜åœ¨ï¼Œå°±è‡ªåŠ¨åˆ›å»ºä¸»ç›®å½•ï¼ŒåŒæ—¶ç”¨æˆ·å±žäºŽtestç»„ cat /etc/passwd æŸ¥çœ‹ç³»ç»Ÿå½“å‰ç”¨æˆ·å è®¾ç½®å’Œä¿®æ”¹ç”¨æˆ·å¯†ç ï¼špasswdåœ¨Unix/Linuxä¸­ï¼Œè¶…çº§ç”¨æˆ·å¯ä»¥ä½¿ç”¨passwdå‘½ä»¤ä¸ºæ™®é€šç”¨æˆ·è®¾ç½®æˆ–ä¿®æ”¹ç”¨æˆ·å£ä»¤ã€‚ç”¨æˆ·ä¹Ÿå¯ä»¥ç›´æŽ¥ä½¿ç”¨è¯¥å‘½ä»¤æ¥ä¿®æ”¹è‡ªå·±çš„å£ä»¤ï¼Œè€Œæ— éœ€åœ¨å‘½ä»¤åŽé¢ä½¿ç”¨ç”¨æˆ·åã€‚ åˆ é™¤ç”¨æˆ·ï¼šuserdelä½¿ç”¨userdelåˆ é™¤ç”¨æˆ· userdel abc(ç”¨æˆ·å) åˆ é™¤abcç”¨æˆ·ï¼Œä½†ä¸ä¼šè‡ªåŠ¨åˆ é™¤ç”¨æˆ·çš„ä¸»ç›®å½• userdel -r abc(ç”¨æˆ·å) åˆ é™¤ç”¨æˆ·ï¼ŒåŒæ—¶åˆ é™¤ç”¨æˆ·çš„ä¸»ç›®å½• åˆ‡æ¢ç”¨æˆ·ï¼šsuå¯ä»¥é€šè¿‡suå‘½ä»¤åˆ‡æ¢ç”¨æˆ·ï¼ŒsuåŽé¢å¯ä»¥åŠ â€œ-â€ã€‚suå’Œsu â€“å‘½ä»¤ä¸åŒä¹‹å¤„åœ¨äºŽï¼Œsu -åˆ‡æ¢åˆ°å¯¹åº”çš„ç”¨æˆ·æ—¶ä¼šå°†å½“å‰çš„å·¥ä½œç›®å½•è‡ªåŠ¨è½¬æ¢åˆ°åˆ‡æ¢åŽçš„ç”¨æˆ·ä¸»ç›®å½•ï¼š å‘½ä»¤ å«ä¹‰ su åˆ‡æ¢åˆ°rootç”¨æˆ· su root åˆ‡æ¢åˆ°rootç”¨æˆ· su - åˆ‡æ¢åˆ°rootç”¨æˆ·ï¼ŒåŒæ—¶åˆ‡æ¢ç›®å½•åˆ°/root su - root åˆ‡æ¢åˆ°rootç”¨æˆ·ï¼ŒåŒæ—¶åˆ‡æ¢ç›®å½•åˆ°/root su æ™®é€šç”¨æˆ· åˆ‡æ¢åˆ°æ™®é€šç”¨æˆ· su - æ™®é€šç”¨æˆ· åˆ‡æ¢åˆ°æ™®é€šç”¨æˆ·ï¼ŒåŒæ—¶åˆ‡æ¢æ™®é€šç”¨æˆ·æ‰€åœ¨çš„ç›®å½• sudoçš„ä½œç”¨ æ³¨æ„ï¼šå¦‚æžœæ˜¯ubuntuå¹³å°ï¼Œéœ€è¦åœ¨å‘½ä»¤å‰åŠ â€œsudoâ€ï¼Œå¦‚æžœåœ¨æŸäº›æ“ä½œéœ€è¦ç®¡ç†å‘˜æ‰èƒ½æ“ä½œï¼Œubuntuæ— éœ€åˆ‡æ¢åˆ°rootç”¨æˆ·å³å¯æ“ä½œï¼Œåªéœ€åŠ â€œsudoâ€å³å¯ã€‚sudoæ˜¯ubuntuå¹³å°ä¸‹å…è®¸ç³»ç»Ÿç®¡ç†å‘˜è®©æ™®é€šç”¨æˆ·æ‰§è¡Œä¸€äº›æˆ–è€…å…¨éƒ¨çš„rootå‘½ä»¤çš„ä¸€ä¸ªå·¥å…·ï¼Œå‡å°‘äº†root ç”¨æˆ·çš„ç™»é™†å’Œç®¡ç†æ—¶é—´ï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚ $ä»£è¡¨æ™®é€šç”¨æˆ·ï¼Œ#è¡¨ç¤ºrootç”¨æˆ·ï¼Œé€€å‡ºç™»å½•è´¦æˆ·ï¼š exitï¼Œå¦‚æžœæ˜¯å›¾å½¢ç•Œé¢ï¼Œé€€å‡ºå½“å‰ç»ˆç«¯ï¼Œå¦‚æžœæ˜¯ä½¿ç”¨sshè¿œç¨‹ç™»å½•ï¼Œé€€å‡ºç™»é™†è´¦æˆ·ï¼Œå¦‚æžœæ˜¯åˆ‡æ¢åŽçš„ç™»é™†ç”¨æˆ·ï¼Œé€€å‡ºåˆ™è¿”å›žä¸Šä¸€ä¸ªç™»é™†è´¦å·ã€‚ ç”¨æˆ·ç»„ç®¡ç†æŸ¥çœ‹æœ‰å“ªäº›ç”¨æˆ·ç»„ï¼š cat /etc/grpup groupmod + ä¸‰æ¬¡tab æ·»åŠ ã€åˆ é™¤ç»„ï¼šgroupaddã€groupdelã€‚cat /etc/group æŸ¥çœ‹ç”¨æˆ·ç»„ ã€‚æŸ¥çœ‹abcç”¨æˆ·åœ¨å“ªä¸ªç”¨æˆ·ç»„ä¸‹ï¼šgroups abcã€‚ä¿®æ”¹ç”¨æˆ·æ‰€åœ¨çš„ç»„ï¼šusermod -g ç”¨æˆ·ç»„ ç”¨æˆ·åã€‚æ¯”å¦‚æŠŠtestè´¦å·ä»Žtestç»„ä¿®æ”¹æˆabcç»„ï¼š 1sudo usermod -g abc test é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–°åˆ›å»ºçš„ç”¨æˆ·ä¸èƒ½sudoï¼Œéœ€è¦è¿›è¡Œè¿›ä¸€æ­¥æ“ä½œ 12sudo usermod -a -G adm ç”¨æˆ·åsudo usermod -a -G sudo ç”¨æˆ·å usermod -g ä¸Ž -Gçš„åŒºåˆ«ï¼š-gç”¨æ¥åˆ¶å®šè¿™ä¸ªç”¨æˆ·é»˜è®¤çš„ç”¨æˆ·ç»„ ï¼Œ-Gä¸€èˆ¬é…åˆâ€™-aâ€™æ¥å®Œæˆå‘å…¶å®ƒç»„æ·»åŠ  æ–‡ä»¶ç®¡ç†ä¿®æ”¹æ–‡ä»¶æ‰€å±žç»„ï¼šchgrpæŠŠ1.txtæ–‡ä»¶æ‰€å±žç»„ä¿®æ”¹æˆtestè¿™ä¸ªç»„ï¼šsudo chgrp test 1.txt ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…ï¼šchownæŠŠ1.txtæ‰€æœ‰è€…æ”¹æˆabcï¼šsudo chown abc 1.txt ä¿®æ”¹æ–‡ä»¶æƒé™ï¼šchmodchmod ä¿®æ”¹æ–‡ä»¶æƒé™æœ‰ä¸¤ç§ä½¿ç”¨æ ¼å¼ï¼šå­—æ¯æ³•ä¸Žæ•°å­—æ³•ã€‚ç›®å½•ï¼šrï¼ˆå¯ä»¥æŸ¥çœ‹ç›®å½•å†…æœ‰å¤šå°‘ä¸œè¥¿ï¼‰wï¼ˆå¯æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹ç›®å½•å†…ä¸œè¥¿ï¼‰xï¼ˆå¯æ‰“å¼€ç›®å½•ï¼‰æ–‡ä»¶ï¼šrï¼ˆå¯ä»¥æŸ¥çœ‹æ–‡ä»¶çš„å…·ä½“å†…å®¹ï¼‰wï¼ˆå¯ä»¥æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹æ–‡ä»¶çš„å…·ä½“å†…å®¹ï¼Œä½†ä¸èƒ½åˆ é™¤æ–‡ä»¶æœ¬èº«ï¼‰xï¼ˆå¯è¿è¡Œæ–‡ä»¶ï¼Œä¸€èˆ¬éƒ½ç”¨äºŽå¯æ‰§è¡Œæ–‡ä»¶ï¼‰ å­—æ¯æ³• [ u/g/o/a ] å«ä¹‰ u user è¡¨ç¤ºè¯¥æ–‡ä»¶çš„æ‰€æœ‰è€… g group è¡¨ç¤ºä¸Žè¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…å±žäºŽåŒä¸€ç»„( group )è€…ï¼Œå³ç”¨æˆ·ç»„ o other è¡¨ç¤ºå…¶ä»–ä»¥å¤–çš„äºº a all è¡¨ç¤ºè¿™ä¸‰è€…çš†æ˜¯ [ +-= ] å«ä¹‰ + å¢žåŠ æƒé™ - æ’¤é”€æƒé™ = è®¾å®šæƒé™ rwx å«ä¹‰ r read è¡¨ç¤ºå¯è¯»å–ï¼Œå¯¹äºŽä¸€ä¸ªç›®å½•ï¼Œå¦‚æžœæ²¡æœ‰ræƒé™ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ä¸èƒ½é€šè¿‡lsæŸ¥çœ‹è¿™ä¸ªç›®å½•çš„å†…å®¹ã€‚ w write è¡¨ç¤ºå¯å†™å…¥ï¼Œå¯¹äºŽä¸€ä¸ªç›®å½•ï¼Œå¦‚æžœæ²¡æœ‰wæƒé™ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ä¸èƒ½åœ¨ç›®å½•ä¸‹åˆ›å»ºæ–°çš„æ–‡ä»¶ã€‚ x excute è¡¨ç¤ºå¯æ‰§è¡Œï¼Œå¯¹äºŽä¸€ä¸ªç›®å½•ï¼Œå¦‚æžœæ²¡æœ‰xæƒé™ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€ä¸èƒ½é€šè¿‡cdè¿›å…¥è¿™ä¸ªç›®å½•ã€‚ ç¤ºä¾‹ï¼š æ–‡ä»¶æ‰€æœ‰è€…æ·»åŠ æ‰§è¡Œæƒé™ 12chmod u=rwx test.txt chmod u+x test.txt åŒç»„è€…å‡åŽ»å†™æƒé™ 12345chmod g=rwx test.txt //ç»™æ–‡ä»¶æ‰€åœ¨çš„ç»„æ·»åŠ æ‰§è¡Œæƒé™chmod g= test.txt //æŠŠæ–‡ä»¶æ‰€åœ¨ç»„çš„æƒé™å…¨éƒ¨åˆ é™¤chmod g+x test.txt //ç»™æ–‡ä»¶æ‰€åœ¨çš„ç»„æ·»åŠ æ‰§è¡Œæƒé™chmod g+w+r+x test.txtchmod g-w test.txt //åŒç»„è€…å‡åŽ»å†™æƒé™ ç»™ä»–äººæ·»åŠ æƒé™ 1chmod o+w test.txt åŒæ—¶è¿›è¡Œè®¾å®šæ‹¥æœ‰è€…ã€åŒç»„è€…ä»¥åŠå…¶ä»–äººçš„æƒé™ 12chmod u=w,g=w,o=r test.txtchmod u=wx,g=rw,o=rw test.txt æ•°å­—æ³• å­—æ¯ è¯´æ˜Ž r è¯»å–æƒé™ï¼Œæ•°å­—ä»£å·ä¸º â€œ4â€ w å†™å…¥æƒé™ï¼Œæ•°å­—ä»£å·ä¸º â€œ2â€ x æ‰§è¡Œæƒé™ï¼Œæ•°å­—ä»£å·ä¸º â€œ1â€ - ä¸å…·ä»»ä½•æƒé™ï¼Œæ•°å­—ä»£å·ä¸º â€œ0â€ æ‰§è¡Œï¼šchmod u=rwx,g=rx,o=r filename å°±ç­‰åŒäºŽï¼šchmod 754 filename æ„æ€æ˜¯ï¼šæ–‡ä»¶æ‰€æœ‰è€…ï¼šè¯»ã€å†™ã€æ‰§è¡Œæƒé™ï¼ŒåŒç»„ç”¨æˆ·ï¼šè¯»ã€æ‰§è¡Œçš„æƒé™ï¼Œå…¶å®ƒç”¨æˆ·ï¼šè¯»æƒé™ æ³¨æ„ï¼šå¦‚æžœæƒ³é€’å½’æ‰€æœ‰ç›®å½•åŠ ä¸Šç›¸åŒæƒé™ï¼Œéœ€è¦åŠ ä¸Šå‚æ•°â€œ -R â€ã€‚ å¦‚ï¼šchmod 777 test/ -R é€’å½’ test ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åŠ  777 æƒé™]]></content>
      <categories>
        <category>Linuxå­¦ä¹ æ€»ç»“</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå‘½ä»¤(ä¸€)]]></title>
    <url>%2F2018%2F02%2F25%2FLinux%E5%91%BD%E4%BB%A4(%E4%B8%80)%2F</url>
    <content type="text"><![CDATA[Linuxå‘½ä»¤çš„æ¦‚è¿°å¾ˆå¤šäººå¯èƒ½åœ¨ç”µè§†æˆ–ç”µå½±ä¸­çœ‹åˆ°è¿‡ç±»ä¼¼çš„åœºæ™¯ï¼Œé»‘å®¢é¢å¯¹ä¸€ä¸ªé»‘è‰²çš„å±å¹•ï¼Œä¸Šé¢é£˜ç€å¯†å¯†éº»éº»çš„å­—ç¬¦ï¼Œæ¢†æ¢†ä¸€é¡¿æ•²ï¼Œå°±å®Œæˆäº†çªƒå–èµ„æ–™çš„ä»»åŠ¡ã€‚ Linux åˆšå‡ºä¸–æ—¶æ²¡æœ‰ä»€ä¹ˆå›¾å½¢ç•Œé¢ï¼Œæ‰€æœ‰çš„æ“ä½œå…¨é å‘½ä»¤å®Œæˆï¼Œå°±å¦‚åŒç”µè§†é‡Œçš„é»‘å®¢é‚£æ ·ï¼Œå……æ»¡äº†ç¥žç§˜ä¸Žæ™¦æ¶©ã€‚ è¿‘å‡ å¹´æ¥ï¼Œå°½ç®¡ Linux å‘å±•å¾—éžå¸¸è¿…é€Ÿï¼Œå›¾å½¢ç•Œé¢è¶Šæ¥è¶Šå‹å¥½ï¼Œä½†æ˜¯åœ¨çœŸæ­£çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒLinux å‘½ä»¤è¡Œçš„åº”ç”¨è¿˜æ˜¯å æœ‰éžå¸¸é‡è¦çš„å¸­ä½ï¼Œè€Œä¸”è®¸å¤šLinuxåŠŸèƒ½åœ¨å‘½ä»¤è¡Œç•Œé¢è¦æ¯”å›¾å½¢åŒ–ç•Œé¢ä¸‹è¿è¡Œçš„å¿«ã€‚å¯ä»¥è¯´ä¸ä¼šå‘½ä»¤è¡Œï¼Œå°±ä¸ç®—ä¼š Linuxã€‚ Linux æä¾›äº†å¤§é‡çš„å‘½ä»¤ï¼Œåˆ©ç”¨å®ƒå¯ä»¥æœ‰æ•ˆåœ°å®Œæˆå¤§é‡çš„å·¥ä½œï¼Œå¦‚ç£ç›˜æ“ä½œã€æ–‡ä»¶å­˜å–ã€ç›®å½•æ“ä½œã€è¿›ç¨‹ç®¡ç†ã€æ–‡ä»¶æƒé™è®¾å®šç­‰ã€‚Linux å‘è¡Œç‰ˆæœ¬æœ€å°‘çš„å‘½ä»¤ä¹Ÿæœ‰ 200 å¤šä¸ªï¼Œè¿™é‡Œåªä»‹ç»æ¯”è¾ƒé‡è¦å’Œä½¿ç”¨é¢‘çŽ‡æœ€å¤šçš„å‘½ä»¤ã€‚ å‘½ä»¤ä½¿ç”¨æ–¹æ³•Linuxå‘½ä»¤æ ¼å¼: 12command [-options] [parameter1] â€¦ls -ahl /home/hexo è¯´æ˜Žï¼š command: å‘½ä»¤å,ç›¸åº”åŠŸèƒ½çš„è‹±æ–‡å•è¯æˆ–å•è¯çš„ç¼©å†™ [-options]ï¼šé€‰é¡¹,å¯ç”¨æ¥å¯¹å‘½ä»¤è¿›è¡ŒæŽ§åˆ¶ï¼Œä¹Ÿå¯ä»¥çœç•¥ï¼Œ[]ä»£è¡¨å¯é€‰ parameter1 â€¦ï¼šä¼ ç»™å‘½ä»¤çš„å‚æ•°ï¼šå¯ä»¥æ˜¯é›¶ä¸ªä¸€ä¸ªæˆ–å¤šä¸ªã€‚ ä¾‹ï¼š pwd: æŸ¥çœ‹å½“å‰æ‰€åœ¨ç›®å½• lsï¼šæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ cd.. :è·³è½¬åˆ°ä¸Šä¸€çº§ç›®å½• ç»å¯¹è·¯å¾„ï¼šcd /bin åˆ›å»ºæ–‡ä»¶æˆ–è€…ç›®å½• åˆ›å»ºéšè—æ–‡ä»¶ï¼štouch .123.txt åˆ›å»ºéšè—ç›®å½•ï¼šmkdir .test æ–‡ä»¶ä»¥ . å¼€å¤´çš„æ˜¯éšè—æ–‡ä»¶æˆ–è€…éšè—ç›®å½• clearæ¸…ç©ºå±å¹• ctrl + lä¹Ÿèƒ½æ¸…å± ï¼ˆmacOSä¸‹ä¸ºcmd + kï¼‰ æ³¨æ„å¹¶ä¸æ˜¯çœŸæ­£çš„æ¸…é™¤å‘½ä»¤ï¼Œè€Œæ˜¯æŠŠä¹‹å‰çš„å‘½ä»¤éšè—åˆ°ä¸Šé¢åŽ» åŽ†å²å‘½ä»¤history å½“ç³»ç»Ÿæ‰§è¡Œè¿‡ä¸€äº›å‘½ä»¤åŽï¼Œå¯æŒ‰ä¸Šä¸‹é”®ç¿»çœ‹ä»¥å‰çš„å‘½ä»¤ï¼Œhistoryå°†æ‰§è¡Œè¿‡çš„å‘½ä»¤åˆ—ä¸¾å‡ºæ¥ æ‰§è¡ŒæŸè¡Œçš„å‘½ä»¤ï¼Œä¾‹å¦‚æ‰§è¡Œ393è¡Œçš„å‘½ä»¤ï¼š!393 é”®ç›˜tabé”®è‡ªåŠ¨è¡¥å…¨ åœ¨æ•²å‡ºå‘½ä»¤çš„å‰å‡ ä¸ªå­—æ¯çš„åŒæ—¶ï¼ŒæŒ‰ä¸‹tabé”®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è¡¥å…¨å‘½ä»¤ ä¾‹å¦‚ï¼š å¦‚æžœå½“å‰ç›®å½•ä¸‹æœ‰ï¼šDesktop Downloads Documents cd De è®¾ä¸ªæ—¶å€™æŒ‰ä¸‹tabé”®å°†ä¼šè¡¥å…¨æˆcd Desktop/ ä½¿ç”¨geditæ‰“å¼€æ–‡æœ¬ï¼šgedit æ–‡ä»¶å æŸ¥çœ‹æ–‡æœ¬å‘½ä»¤ï¼šcat æ–‡ä»¶å å¸®åŠ©æ–‡æ¡£ æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ â€“help ä¸€èˆ¬æ˜¯linuxå‘½ä»¤è‡ªå¸¦çš„å¸®åŠ©ä¿¡æ¯ å¦‚ï¼šls â€“help man(æ‰‹å†Œï¼Œmanual) manæ˜¯linuxæä¾›çš„ä¸€ä¸ªæ‰‹å†Œï¼ŒåŒ…å«äº†ç»å¤§éƒ¨åˆ†çš„å‘½ä»¤ã€å‡½æ•°ä½¿ç”¨è¯´æ˜Ž è¯¥æ‰‹å†Œåˆ†æˆå¾ˆå¤šç« èŠ‚ï¼ˆsectionï¼‰ï¼Œä½¿ç”¨manæ—¶å¯ä»¥æŒ‡å®šä¸åŒçš„ç« èŠ‚æ¥æµè§ˆã€‚ ä¾‹ï¼šman ls ; man printf manä¸­å„ä¸ªsectionæ„ä¹‰å¦‚ä¸‹ï¼š Standard commandsï¼ˆæ ‡å‡†å‘½ä»¤ï¼‰ System callsï¼ˆç³»ç»Ÿè°ƒç”¨ï¼Œå¦‚open,writeï¼‰ Library functionsï¼ˆåº“å‡½æ•°ï¼Œå¦‚printf,fopenï¼‰ Special devicesï¼ˆè®¾å¤‡æ–‡ä»¶çš„è¯´æ˜Žï¼Œ/devä¸‹å„ç§è®¾å¤‡ï¼‰ File formatsï¼ˆæ–‡ä»¶æ ¼å¼ï¼Œå¦‚passwdï¼‰ Games and toysï¼ˆæ¸¸æˆå’Œå¨±ä¹ï¼‰ Miscellaneousï¼ˆæ‚é¡¹ã€æƒ¯ä¾‹ä¸Žåå®šç­‰ï¼Œä¾‹å¦‚Linuxæ¡£æ¡ˆç³»ç»Ÿã€ç½‘ç»œåå®šã€ASCII ç ï¼›environå…¨å±€å˜é‡ï¼‰ Administrative Commandsï¼ˆç®¡ç†å‘˜å‘½ä»¤ï¼Œå¦‚ifconfigï¼‰ manæ˜¯æŒ‰ç…§æ‰‹å†Œçš„ç« èŠ‚å·çš„é¡ºåºè¿›è¡Œæœç´¢çš„ã€‚ manè®¾ç½®äº†å¦‚ä¸‹çš„åŠŸèƒ½é”®ï¼š åŠŸèƒ½é”® åŠŸèƒ½ ç©ºæ ¼é”® æ˜¾ç¤ºæ‰‹å†Œé¡µçš„ä¸‹ä¸€å± Enteré”® ä¸€æ¬¡æ»šåŠ¨æ‰‹å†Œé¡µçš„ä¸€è¡Œ b å›žæ»šä¸€å± f å‰æ»šä¸€å± q é€€å‡ºmanå‘½ä»¤ h åˆ—å‡ºæ‰€æœ‰åŠŸèƒ½é”® /word æœç´¢wordå­—ç¬¦ä¸² æ–‡ä»¶&amp;ç£ç›˜ç®¡ç†touchåˆ›å»ºæ–‡ä»¶åˆ›å»ºåä¸ºtext.txtçš„æ–‡ä»¶ touch text.txt æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ï¼šlslsæ˜¯è‹±æ–‡å•è¯listçš„ç®€å†™ï¼Œå…¶åŠŸèƒ½ä¸ºåˆ—å‡ºç›®å½•çš„å†…å®¹ï¼Œæ˜¯ç”¨æˆ·æœ€å¸¸ç”¨çš„å‘½ä»¤ä¹‹ä¸€ï¼Œå®ƒç±»ä¼¼äºŽDOSä¸‹çš„dirå‘½ä»¤ã€‚ Linuxæ–‡ä»¶æˆ–è€…ç›®å½•åç§°æœ€é•¿å¯ä»¥æœ‰265ä¸ªå­—ç¬¦ï¼Œâ€œ.â€ä»£è¡¨å½“å‰ç›®å½•ï¼Œâ€œ..â€ä»£è¡¨ä¸Šä¸€çº§ç›®å½•ï¼Œä»¥â€œ.â€å¼€å¤´çš„æ–‡ä»¶ä¸ºéšè—æ–‡ä»¶ï¼Œéœ€è¦ç”¨ -a å‚æ•°æ‰èƒ½æ˜¾ç¤ºã€‚ lså¸¸ç”¨å‚æ•°ï¼š å‚æ•° å«ä¹‰ -a æ˜¾ç¤ºæŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰å­ç›®å½•ä¸Žæ–‡ä»¶ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ -l ä»¥åˆ—è¡¨æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ -h é…åˆ -l ä»¥äººæ€§åŒ–çš„æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å¤§å° ä¾‹å¦‚ï¼š ls -a æŠŠæ‰€æœ‰æ–‡ä»¶å’Œç›®å½•åˆ—å‡ºæ¥ï¼ŒåŒ…å«éšè—çš„æ–‡ä»¶å’Œç›®å½•ã€‚ ls -l æŠŠæ–‡ä»¶å’Œæ–‡ä»¶å¤¹åˆ—è¡¨æ–¹å¼åˆ—å‡º; ls -lhæˆ–è€…ls -l -h æŠŠæŠŠæ–‡ä»¶å’Œæ–‡ä»¶å¤¹åˆ—è¡¨æ–¹å¼åˆ—å‡ºï¼Œå¹¶ä¸”æ˜¾ç¤ºå¤§å°ï¼› ls -lhaæˆ–è€…ls -l -h -a æŠŠæ‰€æœ‰æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—çš„ï¼‰åˆ—è¡¨æ–¹å¼åˆ—å‡ºï¼Œå¹¶ä¸”åŒ…å«å¤§å°ï¼› é€šé…ç¬¦å¯ä»¥ä»£è¡¨å¤šä¸ªæˆ–è€…ä¸€ä¸ªï¼Œè¿™å°±æ˜¯é€šé…ç¬¦,å…¶å®žå°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚ é€šé…ç¬¦ å«ä¹‰ * æ–‡ä»¶ä»£è¡¨æ–‡ä»¶åä¸­æ‰€æœ‰å­—ç¬¦ ls te* æŸ¥æ‰¾ä»¥teå¼€å¤´çš„æ–‡ä»¶ ls *html æŸ¥æ‰¾ç»“å°¾ä¸ºhtmlçš„æ–‡ä»¶ ï¼Ÿ ä»£è¡¨æ–‡ä»¶åä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦ ls ?.c åªæ‰¾ç¬¬ä¸€ä¸ªå­—ç¬¦ä»»æ„ï¼ŒåŽç¼€ä¸º.cçš„æ–‡ä»¶ ls a.? åªæ‰¾åªæœ‰3ä¸ªå­—ç¬¦ï¼Œå‰2å­—ç¬¦ä¸ºa.ï¼Œæœ€åŽä¸€ä¸ªå­—ç¬¦ä»»æ„çš„æ–‡ä»¶ [] [â€å’Œâ€œ]â€å°†å­—ç¬¦ç»„æ‹¬èµ·æ¥ï¼Œè¡¨ç¤ºå¯ä»¥åŒ¹é…å­—ç¬¦ç»„ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚â€œ-â€ç”¨äºŽè¡¨ç¤ºå­—ç¬¦èŒƒå›´ã€‚ [abc] åŒ¹é…aã€bã€cä¸­çš„ä»»æ„ä¸€ä¸ª [a-f] åŒ¹é…ä»Žaåˆ°fèŒƒå›´å†…çš„çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ ls [a-f]* æ‰¾åˆ°ä»Žaåˆ°fèŒƒå›´å†…çš„çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦å¼€å¤´çš„æ–‡ä»¶ ls a-f æŸ¥æ‰¾æ–‡ä»¶åä¸ºa-fçš„æ–‡ä»¶,å½“â€œ-â€å¤„äºŽæ–¹æ‹¬å·ä¹‹å¤–å¤±åŽ»é€šé…ç¬¦çš„ä½œç”¨ \ å¦‚æžœè¦ä½¿é€šé…ç¬¦ä½œä¸ºæ™®é€šå­—ç¬¦ä½¿ç”¨ï¼Œå¯ä»¥åœ¨å…¶å‰é¢åŠ ä¸Šè½¬ä¹‰å­—ç¬¦ã€‚â€œ?â€å’Œâ€œ*â€å¤„äºŽæ–¹æ‹¬å·å†…æ—¶ä¸ç”¨ä½¿ç”¨è½¬ä¹‰å­—ç¬¦å°±å¤±åŽ»é€šé…ç¬¦çš„ä½œç”¨ã€‚ ls *a æŸ¥æ‰¾æ–‡ä»¶åä¸º*açš„æ–‡ä»¶ ç¤ºä¾‹ï¼šè¿›å…¥æŸä¸ªç›®å½•åˆ›å»ºæ–‡ä»¶åå¦‚ä¸‹ï¼š test.txt 122.txt 1.txt 2.txt qq.exe hello.c 133.txt 183.txt 1444.txt 1553.txt åˆ›å»ºæ–‡ä»¶å‘½ä»¤ touch 123.txt æŸ¥çœ‹1å¼€å¤´çš„æ–‡ä»¶å‘½ä»¤ï¼šls 1* åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ï¼ˆå’Œæ²¡æœ‰å†™ä¸€æ ·ï¼‰ï¼š ls åˆ—å‡ºä»¥.cç»“å°¾çš„æ–‡ä»¶ï¼šls *.c åˆ—å‡º1å¼€å¤´ï¼Œä»¥3.txtç»“å°¾çš„ä¸¤ç§æ–¹å¼ï¼šls 1*3.txt åˆ—å‡ºä»¥hå¼€å¤´å¹¶ä¸”ä»¥.cç»“å°¾çš„æ–‡ä»¶ï¼š ls h*.c åˆ—å‡ºå¼€å¤´æ˜¯1ä¸­é—´æ˜¯2æˆ–è€…3æˆ–è€…8æœ«å°¾æ˜¯3çš„åŽç¼€ä¸º.txtçš„æ–‡ä»¶ï¼š ls 1[238]3.txtæˆ–è€…ls 1[1-8]3.txt è¾“å‡ºé‡å®šå‘ï¼š&gt;Linuxå…è®¸å°†å‘½ä»¤æ‰§è¡Œç»“æžœé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ¬åº”æ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šçš„å†…å®¹ä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ã€‚ å¦‚ï¼šls &gt; test.txt ( test.txt å¦‚æžœä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™è¦†ç›–å…¶å†…å®¹ ) è¾“å‡ºé‡å®šå‘ä¼šè¦†ç›–åŽŸæ¥çš„å†…å®¹ï¼Œ&gt;&gt;è¾“å‡ºé‡å®šå‘åˆ™ä¼šè¿½åŠ åˆ°æ–‡ä»¶çš„å°¾éƒ¨ã€‚ åˆ†å±æ˜¾ï¼šmoreæŸ¥çœ‹å†…å®¹æ—¶ï¼Œåœ¨ä¿¡æ¯è¿‡é•¿æ— æ³•åœ¨ä¸€å±ä¸Šæ˜¾ç¤ºæ—¶ï¼Œä¼šå‡ºçŽ°å¿«é€Ÿæ»šå±ï¼Œä½¿å¾—ç”¨æˆ·æ— æ³•çœ‹æ¸…æ–‡ä»¶çš„å†…å®¹ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨moreå‘½ä»¤ï¼Œæ¯æ¬¡åªæ˜¾ç¤ºä¸€é¡µï¼ŒæŒ‰ä¸‹ç©ºæ ¼é”®å¯ä»¥æ˜¾ç¤ºä¸‹ä¸€é¡µï¼ŒæŒ‰ä¸‹qé”®é€€å‡ºæ˜¾ç¤ºï¼ŒæŒ‰ä¸‹hé”®å¯ä»¥èŽ·å–å¸®åŠ©,bè¿”å›žä¸Šä¸€é¡µï¼Œfæ˜¾ç¤ºä¸‹ä¸€é¡µã€‚ catæ˜¯å…¨éƒ¨æ˜¾ç¤º ä½¿ç”¨geditç¼–è¾‘å·¥å…·æ˜¾ç¤ºï¼šgedit test.txt ç®¡é“ï¼š|ç®¡é“ï¼šä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºå¯ä»¥é€šè¿‡ç®¡é“åšä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ã€‚ ç®¡é“æˆ‘ä»¬å¯ä»¥ç†è§£çŽ°å®žç”Ÿæ´»ä¸­çš„ç®¡å­ï¼Œç®¡å­çš„ä¸€å¤´å¡žä¸œè¥¿è¿›åŽ»ï¼Œå¦ä¸€å¤´å–å‡ºæ¥ï¼Œè¿™é‡Œâ€œ | â€çš„å·¦å³åˆ†ä¸ºä¸¤ç«¯ï¼Œå·¦ç«¯å¡žä¸œè¥¿(å†™)ï¼Œå³ç«¯å–ä¸œè¥¿(è¯»)ã€‚ å‘½ä»¤å¦‚ä¸‹ï¼šls -lah | more å¤šä¸ªå‘½ä»¤é—´éš”ç”¨;éš”å¼€ä¾‹å¦‚å‘½ä»¤ï¼šls;ls -lah æ¸…å±æ“ä½œclearä½œç”¨ä¸ºæ¸…é™¤ç»ˆç«¯ä¸Šçš„æ˜¾ç¤º(ç±»ä¼¼äºŽDOSçš„clsæ¸…å±åŠŸèƒ½)ï¼Œä¹Ÿå¯ä½¿ç”¨å¿«æ·é”®ï¼šCtrl + l ( â€œlâ€ ä¸ºå­—æ¯ )ã€‚ macOSä½¿ç”¨ cmd + k åˆ‡æ¢å·¥ä½œç›®å½•ï¼šcdåœ¨ä½¿ç”¨Unix/Linuxçš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦æ›´æ¢å·¥ä½œç›®å½•ã€‚cdå‘½ä»¤å¯ä»¥å¸®åŠ©ç”¨æˆ·åˆ‡æ¢å·¥ä½œç›®å½•ã€‚Linuxæ‰€æœ‰çš„ç›®å½•å’Œæ–‡ä»¶åå¤§å°å†™æ•æ„Ÿ cdåŽé¢å¯è·Ÿç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥è·Ÿç›¸å¯¹è·¯å¾„ã€‚å¦‚æžœçœç•¥ç›®å½•ï¼Œåˆ™é»˜è®¤åˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚ å‘½ä»¤ å«ä¹‰ cd åˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•(/home/ç”¨æˆ·ç›®å½•)ï¼Œç”¨æˆ·ç™»é™†çš„æ—¶å€™ï¼Œé»˜è®¤çš„ç›®å½•å°±æ˜¯ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚ cd ~ åˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•(/home/ç”¨æˆ·ç›®å½•) cd . åˆ‡æ¢åˆ°å½“å‰ç›®å½• cd .. åˆ‡æ¢åˆ°ä¸Šçº§ç›®å½• cd - å¯è¿›å…¥ä¸Šæ¬¡æ‰€åœ¨çš„ç›®å½• æ³¨æ„ï¼š å¦‚æžœè·¯å¾„æ˜¯ä»Žæ ¹è·¯å¾„å¼€å§‹çš„ï¼Œåˆ™è·¯å¾„çš„å‰é¢éœ€è¦åŠ ä¸Š â€œ / â€ï¼Œå¦‚ â€œ /mnt â€ï¼Œé€šå¸¸è¿›å…¥æŸä¸ªç›®å½•é‡Œçš„æ–‡ä»¶å¤¹ï¼Œå‰é¢ä¸ç”¨åŠ  â€œ / â€ã€‚ å½“ä½¿ç”¨cdå‘½ä»¤è¦åˆ‡æ¢å¯¹åº”ç›®å½•æ—¶ï¼Œå¿˜è®°äº†æœ‰å“ªäº›ç›®å½•å¯ä»¥æ•²ä¸¤æ¬¡tabé”®æç¤ºã€‚ ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ç»å¯¹è·¯å¾„ ä»Ž/ç›®å½•å¼€å§‹æè¿°çš„è·¯å¾„ä¸ºç»å¯¹è·¯å¾„ï¼Œå¦‚ï¼š 12cd /homels /usr ç›¸å¯¹è·¯å¾„ ä»Žå½“å‰ä½ç½®å¼€å§‹æè¿°çš„è·¯å¾„ä¸ºç›¸å¯¹è·¯å¾„ï¼Œå¦‚ï¼š 12cd ../../ls abc/def .å’Œ.. æ¯ä¸ªç›®å½•ä¸‹éƒ½æœ‰.å’Œ.. . è¡¨ç¤ºå½“å‰ç›®å½• .. è¡¨ç¤ºä¸Šä¸€çº§ç›®å½•ï¼Œå³çˆ¶ç›®å½• æ ¹ç›®å½•ä¸‹çš„.å’Œ..éƒ½è¡¨ç¤ºå½“å‰ç›®å½• å¦‚æžœè°ƒçš„è·¯å¾„æ¯”è¾ƒæ·±ç”¨ç»å¯¹è·¯å¾„ã€‚ å¼ºåˆ¶ç»“æŸç¨‹åºï¼šctrl + cCtrl-Cé€SIGINTä¿¡å·ï¼Œé»˜è®¤è¿›ç¨‹ä¼šç»“æŸï¼Œä½†æ˜¯è¿›ç¨‹è‡ªå·±å¯ä»¥é‡å®šä¹‰æ”¶åˆ°è¿™ä¸ªä¿¡å·çš„è¡Œä¸ºã€‚ Ctrl-Zé€SIGSTOPä¿¡å·ï¼Œè¿›ç¨‹åªæ˜¯è¢«åœæ­¢ï¼Œå†é€SIGCONTä¿¡å·ï¼Œè¿›ç¨‹ç»§ç»­è¿è¡Œ ç›®å½•å’Œæ–‡ä»¶çš„åˆ›å»ºå’Œåˆ é™¤åˆ›å»ºæ–‡ä»¶å¤¹ï¼šmkdiré€šè¿‡mkdirå‘½ä»¤å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•ã€‚å‚æ•°-på¯é€’å½’åˆ›å»ºç›®å½•ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯æ–°å»ºç›®å½•çš„åç§°ä¸èƒ½ä¸Žå½“å‰ç›®å½•ä¸­å·²æœ‰çš„ç›®å½•æˆ–æ–‡ä»¶åŒåï¼Œå¹¶ä¸”ç›®å½•åˆ›å»ºè€…å¿…é¡»å¯¹å½“å‰ç›®å½•å…·æœ‰å†™æƒé™ã€‚ ä»¥ç›®å½•æ ‘çš„æ–¹å¼æ˜¾ç¤ºï¼štreeåˆ é™¤ç›®å½•ï¼šrmdirå¯ä½¿ç”¨rmdirå‘½ä»¤åˆ é™¤ä¸€ä¸ªç›®å½•ã€‚å¿…é¡»ç¦»å¼€ç›®å½•ï¼Œå¹¶ä¸”ç›®å½•å¿…é¡»ä¸ºç©ºç›®å½•ï¼Œä¸ç„¶æç¤ºåˆ é™¤å¤±è´¥ã€‚ å½“å‰ç›®å½•ä¸‹é€’å½’åˆ é™¤æ–‡ä»¶å¤¹a/b/c/eçš„å‘½ä»¤ï¼šrmdir a/b/c/e -p macOSä¸‹åˆ é™¤ä¸ºrm -r [file] åˆ é™¤æ–‡ä»¶ï¼šrmå¯é€šè¿‡rmåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚ä½¿ç”¨rmå‘½ä»¤è¦å°å¿ƒï¼Œå› ä¸ºæ–‡ä»¶åˆ é™¤åŽä¸èƒ½æ¢å¤ã€‚ä¸ºäº†é˜²æ­¢æ–‡ä»¶è¯¯åˆ ï¼Œå¯ä»¥åœ¨rmåŽä½¿ç”¨-iå‚æ•°ä»¥é€ä¸ªç¡®è®¤è¦åˆ é™¤çš„æ–‡ä»¶ã€‚ å¸¸ç”¨å‚æ•°åŠå«ä¹‰å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š å‚æ•° å«ä¹‰ -i ä»¥è¿›è¡Œäº¤äº’å¼æ–¹å¼æ‰§è¡Œ -f å¼ºåˆ¶åˆ é™¤ï¼Œå¿½ç•¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œæ— éœ€æç¤º -r é€’å½’åœ°åˆ é™¤ç›®å½•ä¸‹çš„å†…å®¹ï¼Œåˆ é™¤æ–‡ä»¶å¤¹æ—¶å¿…é¡»åŠ æ­¤å‚æ•° å»ºç«‹é“¾æŽ¥æ–‡ä»¶ï¼šlnLinuxé“¾æŽ¥æ–‡ä»¶ç±»ä¼¼äºŽWindowsä¸‹çš„å¿«æ·æ–¹å¼ã€‚ é“¾æŽ¥æ–‡ä»¶åˆ†ä¸ºè½¯é“¾æŽ¥å’Œç¡¬é“¾æŽ¥ã€‚ è½¯é“¾æŽ¥ï¼šè½¯é“¾æŽ¥ä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œæºæ–‡ä»¶åˆ é™¤åˆ™è½¯é“¾æŽ¥å¤±æ•ˆã€‚ ç¡¬é“¾æŽ¥ï¼šç¡¬é“¾æŽ¥åªèƒ½é“¾æŽ¥æ™®é€šæ–‡ä»¶ï¼Œä¸èƒ½é“¾æŽ¥ç›®å½•ã€‚ ä½¿ç”¨æ ¼å¼ï¼š 12ln æºæ–‡ä»¶ é“¾æŽ¥æ–‡ä»¶ln -s æºæ–‡ä»¶ é“¾æŽ¥æ–‡ä»¶ å¦‚æžœæ²¡æœ‰-sé€‰é¡¹ä»£è¡¨å»ºç«‹ä¸€ä¸ªç¡¬é“¾æŽ¥æ–‡ä»¶ï¼Œä¸¤ä¸ªæ–‡ä»¶å ç”¨ç›¸åŒå¤§å°çš„ç¡¬ç›˜ç©ºé—´ï¼Œå³ä½¿åˆ é™¤äº†æºæ–‡ä»¶ï¼Œé“¾æŽ¥æ–‡ä»¶è¿˜æ˜¯å­˜åœ¨ï¼Œæ‰€ä»¥-sé€‰é¡¹æ˜¯æ›´å¸¸è§çš„å½¢å¼ã€‚ æ³¨æ„ï¼šå¦‚æžœè½¯é“¾æŽ¥æ–‡ä»¶å’Œæºæ–‡ä»¶ä¸åœ¨åŒä¸€ä¸ªç›®å½•ï¼Œæºæ–‡ä»¶è¦ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œä¸èƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„ã€‚ åˆ›å»ºè½¯è¿žæŽ¥ åˆ›å»ºç¡¬è¿žæŽ¥ æºæ–‡ä»¶&amp;è½¯è¿žæŽ¥&amp;ç¡¬è¿žæŽ¥ä¹‹é—´å…³ç³» è½¯è¿žæŽ¥æ‰¾æ–‡ä»¶çš„æ—¶å€™æ˜¯æ ¹æ®åå­—åŽ»æ‰¾ã€‚ å¦‚æžœåˆ›å»ºäº†2ä¸ªç¡¬è¿žæŽ¥å»ºä¼šæœ‰3ä¸ªé“¾æŽ¥æ•°ã€‚ åˆ é™¤è½¯è¿žç¡¬æŽ¥è¿žæŽ¥æ•°ä¸å˜ã€‚ è·ŸiOSé‡Œé¢çš„æ·±æ‹·è´å’Œæµ…æ‹·è´ç±»ä¼¼ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºŽï¼Œç¡¬è¿žæŽ¥æ”¹å˜çš„æ—¶å€™ï¼Œæºæ–‡ä»¶ä¹Ÿä¼šè·Ÿç€æ”¹å˜ æŸ¥çœ‹æˆ–è€…åˆå¹¶æ–‡ä»¶å†…å®¹ï¼šcat ä½¿ç”¨catç»“åˆè¾“å‡ºé‡å®šå‘å‘½ä»¤ç”Ÿæˆæ–°æ–‡ä»¶ æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ï¼šcat /etc/passwd æŸ¥çœ‹ç”¨æˆ·ç»„ä¿¡æ¯ï¼šcat /etc/group æ–‡æœ¬ä¸­æœç´¢ï¼šgrepLinuxç³»ç»Ÿä¸­grepå‘½ä»¤æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œgrepå…è®¸å¯¹æ–‡æœ¬æ–‡ä»¶è¿›è¡Œæ¨¡å¼æŸ¥æ‰¾ã€‚å¦‚æžœæ‰¾åˆ°åŒ¹é…æ¨¡å¼ï¼Œ grepæ‰“å°åŒ…å«æ¨¡å¼çš„æ‰€æœ‰è¡Œã€‚ grep [-é€‰é¡¹] â€˜æœç´¢å†…å®¹ä¸²â€™ æ–‡ä»¶å åœ¨grepå‘½ä»¤ä¸­è¾“å…¥å­—ç¬¦ä¸²å‚æ•°æ—¶ï¼Œæœ€å¥½å¼•å·æˆ–åŒå¼•å·æ‹¬èµ·æ¥ã€‚ä¾‹å¦‚ï¼šgrep â€˜a â€™ 1.txtã€‚ å¸¸ç”¨é€‰é¡¹è¯´æ˜Žï¼š é€‰é¡¹ å«ä¹‰ -v æ˜¾ç¤ºä¸åŒ…å«åŒ¹é…æ–‡æœ¬çš„æ‰€æœ‰è¡Œï¼ˆç›¸å½“äºŽæ±‚åï¼‰ -n æ˜¾ç¤ºåŒ¹é…è¡ŒåŠè¡Œå· -i å¿½ç•¥å¤§å°å†™ grepæœç´¢å†…å®¹ä¸²å¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚ æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¯¹å­—ç¬¦ä¸²æ“ä½œçš„ä¸€ç§é€»è¾‘å…¬å¼ï¼Œå°±æ˜¯ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ã€åŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ï¼Œè¿™ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ç”¨æ¥è¡¨è¾¾å¯¹å­—ç¬¦ä¸²çš„ä¸€ç§è¿‡æ»¤é€»è¾‘ã€‚ grepå¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼š å‚æ•° å«ä¹‰ ^a è¡Œé¦–,æœå¯»ä»¥ a å¼€å¤´çš„è¡Œï¼›grep -n â€˜^aâ€™ 1.txt ke$ è¡Œå°¾,æœå¯»ä»¥ ke ç»“æŸçš„è¡Œï¼›grep -n â€˜ke$â€™ 1.txt [Ss]igna[Ll] åŒ¹é… [] é‡Œä¸­ä¸€ç³»åˆ—å­—ç¬¦ä¸­çš„ä¸€ä¸ªï¼›æœå¯»åŒ¹é…å•è¯signalã€signaLã€Signalã€SignaLçš„è¡Œï¼›grep -n â€˜[Ss]igna[Ll]â€™ 1.txt . (ç‚¹)åŒ¹é…ä¸€ä¸ªéžæ¢è¡Œç¬¦çš„å­—ç¬¦ï¼›åŒ¹é… e å’Œ e ä¹‹é—´æœ‰ä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œå¯ä»¥åŒ¹é… eeeï¼Œeaeï¼Œeveï¼Œä½†æ˜¯ä¸åŒ¹é… eeï¼Œeaaeï¼›grep -n â€˜e.eâ€™ 1.txt ç¤ºä¾‹ï¼šæœç´¢ä»¥â€œntfsâ€å¼€å¤´çš„å†…å®¹ æŠŠbinç›®å½•ä¸‹çš„ç¨‹åºåä¿å­˜åˆ°text.txtæ–‡ä»¶ä¸­ï¼šls /bin &gt; text.txt æœç´¢ä»¥â€™ntfsâ€™å¼€å¤´çš„å†…å®¹:grep â€˜^ntfâ€™ test.txt æ–‡ä»¶æ‹·è´ï¼šcpcpå‘½ä»¤çš„åŠŸèƒ½æ˜¯å°†ç»™å‡ºçš„æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ä¸­ï¼Œç›¸å½“äºŽDOSä¸‹çš„copyå‘½ä»¤ã€‚ å¦‚æžœè¦æ‹·è´åˆ°çš„æ–‡ä»¶æˆ–è€…ç›®å½•ä¸å­˜åœ¨å°±åˆ›å»ºï¼Œä¾‹å¦‚ä»Žtest1ç›®å½•æ‹·è´åˆ°test2ç›®å½•ï¼Œå¦‚æžœä¸å­˜åœ¨test2åˆ™åˆ›å»º å¸¸ç”¨é€‰é¡¹è¯´æ˜Žï¼š é€‰é¡¹ å«ä¹‰ -a è¯¥é€‰é¡¹é€šå¸¸åœ¨å¤åˆ¶ç›®å½•æ—¶ä½¿ç”¨ï¼Œå®ƒä¿ç•™é“¾æŽ¥ã€æ–‡ä»¶å±žæ€§ï¼Œå¹¶é€’å½’åœ°å¤åˆ¶ç›®å½•ï¼Œç®€å•è€Œè¨€ï¼Œä¿æŒæ–‡ä»¶åŽŸæœ‰å±žæ€§ã€‚ -f å·²ç»å­˜åœ¨çš„ç›®æ ‡æ–‡ä»¶è€Œä¸æç¤º -i äº¤äº’å¼å¤åˆ¶ï¼Œåœ¨è¦†ç›–ç›®æ ‡æ–‡ä»¶ä¹‹å‰å°†ç»™å‡ºæç¤ºè¦æ±‚ç”¨æˆ·ç¡®è®¤ -r è‹¥ç»™å‡ºçš„æºæ–‡ä»¶æ˜¯ç›®å½•æ–‡ä»¶ï¼Œåˆ™cpå°†é€’å½’å¤åˆ¶è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶ï¼Œç›®æ ‡æ–‡ä»¶å¿…é¡»ä¸ºä¸€ä¸ªç›®å½•åã€‚ -v æ˜¾ç¤ºæ‹·è´è¿›åº¦ é€šå¸¸-ivrè¿žç”¨çš„æƒ…å†µè¾ƒå¤š ç¤ºä¾‹ï¼šå°†test1ç›®å½•ä¸‹çš„hahaæ–‡ä»¶æ‹·è´åˆ°test2 cp test1/haha.txt test2 -ivr æ–‡ä»¶ç§»åŠ¨ï¼šmvç”¨æˆ·å¯ä»¥ä½¿ç”¨mvå‘½ä»¤æ¥ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¹Ÿå¯ä»¥ç»™æ–‡ä»¶æˆ–ç›®å½•é‡å‘½åã€‚ å¸¸ç”¨é€‰é¡¹è¯´æ˜Žï¼š é€‰é¡¹ å«ä¹‰ -f ç¦æ­¢äº¤äº’å¼æ“ä½œï¼Œå¦‚æœ‰è¦†ç›–ä¹Ÿä¸ä¼šç»™å‡ºæç¤º -i ç¡®è®¤äº¤äº’æ–¹å¼æ“ä½œï¼Œå¦‚æžœmvæ“ä½œå°†å¯¼è‡´å¯¹å·²å­˜åœ¨çš„ç›®æ ‡æ–‡ä»¶çš„è¦†ç›–ï¼Œç³»ç»Ÿä¼šè¯¢é—®æ˜¯å¦é‡å†™ï¼Œè¦æ±‚ç”¨æˆ·å›žç­”ä»¥é¿å…è¯¯è¦†ç›–æ–‡ä»¶ -v æ˜¾ç¤ºç§»åŠ¨è¿›åº¦ ç¤ºä¾‹ï¼šå°†hahaæ–‡ä»¶ç§»åŠ¨åˆ°test1ç›®å½•ä¸‹ mv haha.txt test1 æ­¤æ—¶å¦‚æžœtest1ä¸å­˜åœ¨åˆ™ä¼šåˆ›å»ºtest1ï¼Œå¦‚æžœhahaæ˜¯ç›®å½•çš„è¯åˆ™ä¼šé‡å‘½åä¸ºtest1 æ–‡ä»¶æŸ¥æ‰¾ï¼šfindfindå‘½ä»¤åŠŸèƒ½éžå¸¸å¼ºå¤§ï¼Œé€šå¸¸ç”¨æ¥åœ¨ç‰¹å®šçš„ç›®å½•ä¸‹æœç´¢ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥æœç´¢ç‰¹å®šç”¨æˆ·å±žä¸»çš„æ–‡ä»¶ã€‚ å¸¸ç”¨ç”¨æ³•ï¼š å‘½ä»¤ å«ä¹‰ find ./ -name test.sh æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰åä¸ºtest.shçš„æ–‡ä»¶ find ./ -name â€˜*.shâ€™ æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰åŽç¼€ä¸º.shçš„æ–‡ä»¶ find ./ -name â€œ[A-Z]*â€ æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„æ–‡ä»¶ find /tmp -size 2M æŸ¥æ‰¾åœ¨/tmp ç›®å½•ä¸‹ç­‰äºŽ2Mçš„æ–‡ä»¶ find /tmp -size +2M æŸ¥æ‰¾åœ¨/tmp ç›®å½•ä¸‹å¤§äºŽ2Mçš„æ–‡ä»¶ find /tmp -size -2M æŸ¥æ‰¾åœ¨/tmp ç›®å½•ä¸‹å°äºŽ2Mçš„æ–‡ä»¶ find ./ -size +4k -size -5M æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹å¤§äºŽ4kï¼Œå°äºŽ5Mçš„æ–‡ä»¶ find ./ -perm 0777 æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æƒé™ä¸º 777 çš„æ–‡ä»¶æˆ–ç›®å½• è¯´æ˜Žï¼š777æƒé™æŒ‡çš„æ˜¯å½“å‰ç”¨æˆ·å¯ä»¥å¯¹ç›¸åº”çš„æ–‡ä»¶è¿›è¡Œè¯»å–ã€å†™å…¥å’Œæ‰§è¡Œçš„æ“ä½œ å½’æ¡£ç®¡ç†ï¼štarä¸»è¦æ˜¯.tar.gzå’Œ.tar.bz2 ç»“å°¾åŽ‹ç¼©åŒ…çš„æ‰“åŒ…å’Œè§£åŽ‹ã€‚ è®¡ç®—æœºä¸­çš„æ•°æ®ç»å¸¸éœ€è¦å¤‡ä»½ï¼Œtaræ˜¯Unix/Linuxä¸­æœ€å¸¸ç”¨çš„å¤‡ä»½å·¥å…·ï¼Œæ­¤å‘½ä»¤å¯ä»¥æŠŠä¸€ç³»åˆ—æ–‡ä»¶å½’æ¡£åˆ°ä¸€ä¸ªå¤§æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥æŠŠæ¡£æ¡ˆæ–‡ä»¶è§£å¼€ä»¥æ¢å¤æ•°æ®ã€‚ tarä½¿ç”¨æ ¼å¼ tar [å‚æ•°] æ‰“åŒ…æ–‡ä»¶å æ–‡ä»¶ tarå‘½ä»¤å¾ˆç‰¹æ®Šï¼Œå…¶å‚æ•°å‰é¢å¯ä»¥ä½¿ç”¨â€œ-â€ï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ã€‚ å‚æ•° å«ä¹‰ -c ç”Ÿæˆæ¡£æ¡ˆæ–‡ä»¶ï¼Œåˆ›å»ºæ‰“åŒ…æ–‡ä»¶ -v åˆ—å‡ºå½’æ¡£è§£æ¡£çš„è¯¦ç»†è¿‡ç¨‹ï¼Œæ˜¾ç¤ºè¿›åº¦ -f æŒ‡å®šæ¡£æ¡ˆæ–‡ä»¶åç§°ï¼ŒfåŽé¢ä¸€å®šæ˜¯.taræ–‡ä»¶ï¼Œæ‰€ä»¥å¿…é¡»æ”¾é€‰é¡¹æœ€åŽ -t åˆ—å‡ºæ¡£æ¡ˆä¸­åŒ…å«çš„æ–‡ä»¶ -x è§£å¼€æ¡£æ¡ˆæ–‡ä»¶ æ³¨æ„ï¼šé™¤äº†féœ€è¦æ”¾åœ¨å‚æ•°çš„æœ€åŽï¼Œå…¶å®ƒå‚æ•°çš„é¡ºåºä»»æ„ã€‚ .taræ‰“åŒ…å’Œè§£åŽ‹æ‰“åŒ…æ–‡ä»¶æˆ.taråŽç¼€ï¼štar -cvf test.tar * æŠŠå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åŽ‹ç¼©åˆ°test.taråŒ…ä¸­å‘½ä»¤ï¼štar -cvf test.tar * è§£åŽ‹.taræ–‡ä»¶ï¼štar -xvf test.tar .tar.gzæ‰“åŒ…å’Œè§£åŽ‹æ‰“åŒ…ä¸”åŽ‹ç¼©æ–‡ä»¶æˆ.tar.gzåŽç¼€æ–‡ä»¶ æŠŠåŽç¼€æ˜¯.txtæ–‡ä»¶åŽ‹ç¼©æˆxxx.tar.gzå‘½ä»¤ï¼š tar -zcvf xxx.tar.gz *.txt è§£åŽ‹.tar.gzåŽç¼€æ–‡ä»¶ æŠŠxxx.tar.gzæ–‡ä»¶è§£åŽ‹å‘½ä»¤ï¼štar -zxvf xxx.tar.gz .tar.bz2åŽç¼€æ‰“åŒ…å’Œè§£åŽ‹æŠŠåŽç¼€.txtæ‰€æœ‰æ–‡ä»¶æ‰“åŒ…åŽ‹ç¼©æˆ test.tar.bz2å‘½ä»¤ï¼š tar -jcvf test.tar.bz2 *.txt è§£åŽ‹.tar.bz2åŽç¼€æ–‡ä»¶ æŠŠåŽç¼€test.tar.bz2æ–‡ä»¶è§£åŽ‹å‘½ä»¤ï¼štar -jxvf test.tar.bz2 è§£åŽ‹åˆ°æŒ‡å®šç›®å½•ï¼š-Cï¼ˆå¤§å†™å­—æ¯â€œCâ€ æŠŠtest.tar.bz2è§£åŽ‹åˆ°test2ç›®å½•ä¸‹å‘½ä»¤ï¼š tar -jxvf test.tar.bz2 -C test2 æ–‡ä»¶åŽ‹ç¼©è§£åŽ‹ï¼šgziptarä¸Žgzipå‘½ä»¤ç»“åˆä½¿ç”¨å®žçŽ°æ–‡ä»¶æ‰“åŒ…ã€åŽ‹ç¼©ã€‚ taråªè´Ÿè´£æ‰“åŒ…æ–‡ä»¶ï¼Œä½†ä¸åŽ‹ç¼©ï¼Œç”¨gzipåŽ‹ç¼©taræ‰“åŒ…åŽçš„æ–‡ä»¶ï¼Œå…¶æ‰©å±•åä¸€èˆ¬ç”¨xxxx.tar.gzã€‚gzipä½¿ç”¨æ ¼å¼å¦‚ä¸‹ï¼š gzip [é€‰é¡¹] è¢«åŽ‹ç¼©æ–‡ä»¶ å¸¸ç”¨é€‰é¡¹ï¼š é€‰é¡¹ å«ä¹‰ -d è§£åŽ‹ -r åŽ‹ç¼©æ‰€æœ‰å­ç›®å½• æŠŠ.taråŽç¼€çš„åŽ‹ç¼©: ä½¿ç”¨gzipè§£åŽ‹.tar.gz: æ–‡ä»¶åŽ‹ç¼©è§£åŽ‹ï¼šzipã€unzipé€šè¿‡zipåŽ‹ç¼©æ–‡ä»¶çš„ç›®æ ‡æ–‡ä»¶ä¸éœ€è¦æŒ‡å®šæ‰©å±•åï¼Œé»˜è®¤æ‰©å±•åä¸ºzipã€‚åŽ‹ç¼©æ–‡ä»¶ï¼šzip [-r] ç›®æ ‡æ–‡ä»¶(æ²¡æœ‰æ‰©å±•å) æºæ–‡ä»¶: è§£åŽ‹æ–‡ä»¶ï¼šunzip -d è§£åŽ‹: æŸ¥çœ‹å‘½ä»¤ä½ç½®ï¼šwhich ç³»ç»Ÿç®¡ç†è¿›ç¨‹ç®¡ç†æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯ï¼špspsé»˜è®¤æ˜¯å½“å‰ç»ˆç«¯å¼€çš„è¿›ç¨‹æ•°é‡ è¿›ç¨‹æ˜¯ä¸€ä¸ªå…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºï¼Œå®ƒæ˜¯æ“ä½œç³»ç»ŸåŠ¨æ€æ‰§è¡Œçš„åŸºæœ¬å•å…ƒã€‚ pså‘½ä»¤å¯ä»¥æŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†çŠ¶å†µï¼Œå¸¸ç”¨é€‰é¡¹(é€‰é¡¹å¯ä»¥ä¸åŠ â€œ-â€)å¦‚ä¸‹ï¼š é€‰é¡¹ å«ä¹‰ -a æ˜¾ç¤ºç»ˆç«¯ä¸Šçš„æ‰€æœ‰è¿›ç¨‹ï¼ŒåŒ…æ‹¬å…¶ä»–ç”¨æˆ·çš„è¿›ç¨‹ -u æ˜¾ç¤ºè¿›ç¨‹çš„è¯¦ç»†çŠ¶æ€ -x æ˜¾ç¤ºæ²¡æœ‰æŽ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹ -w æ˜¾ç¤ºåŠ å®½ï¼Œä»¥ä¾¿æ˜¾ç¤ºæ›´å¤šçš„ä¿¡æ¯ -r åªæ˜¾ç¤ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ åŠ¨æ€æ˜¾ç¤ºè¿›ç¨‹ï¼štoptopå‘½ä»¤ç”¨æ¥åŠ¨æ€æ˜¾ç¤ºè¿è¡Œä¸­çš„è¿›ç¨‹ã€‚topå‘½ä»¤èƒ½å¤Ÿåœ¨è¿è¡ŒåŽï¼Œåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”æ›´æ–°æ˜¾ç¤ºä¿¡æ¯ã€‚å¯ä»¥åœ¨ä½¿ç”¨topå‘½ä»¤æ—¶åŠ ä¸Š-d æ¥æŒ‡å®šæ˜¾ç¤ºä¿¡æ¯æ›´æ–°çš„æ—¶é—´é—´éš”ã€‚æ—¶é—´å•ä½æ˜¯ç§’ 12ä¸¤ç§’æ›´æ–°ä¸€æ¬¡top -d 2 åœ¨topå‘½ä»¤æ‰§è¡ŒåŽï¼Œå¯ä»¥æŒ‰ä¸‹æŒ‰é”®å¾—åˆ°å¯¹æ˜¾ç¤ºçš„ç»“æžœè¿›è¡ŒæŽ’åºï¼š æŒ‰é”® å«ä¹‰ M æ ¹æ®å†…å­˜ä½¿ç”¨é‡æ¥æŽ’åº P æ ¹æ®CPUå æœ‰çŽ‡æ¥æŽ’åº T æ ¹æ®è¿›ç¨‹è¿è¡Œæ—¶é—´çš„é•¿çŸ­æ¥æŽ’åº U å¯ä»¥æ ¹æ®åŽé¢è¾“å…¥çš„ç”¨æˆ·åæ¥ç­›é€‰è¿›ç¨‹ K å¯ä»¥æ ¹æ®åŽé¢è¾“å…¥çš„PIDæ¥æ€æ­»è¿›ç¨‹ã€‚ q é€€å‡º h èŽ·å¾—å¸®åŠ© åŠ¨æ€æ˜¾ç¤ºè¿›ç¨‹ï¼šhtopswapå°±æ˜¯å†…å­˜äº¤æ¢ç©ºé—´ï¼Œç”¨äºŽåœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œäº¤æ¢ä¸€éƒ¨åˆ†ä¸å¸¸ç”¨çš„é¡µåˆ°ç£ç›˜ä¸Šæ¥ï¼Œè…¾å‡ºç‰©ç†å†…å­˜æ¥ï¼ŒåŒæ ·æ”¯æŒMæŒ‰ç…§å†…å­˜å ç”¨æŽ’åºï¼ŒPå®‰è£…cpuå æœ‰æŽ’åº ç»ˆæ­¢è¿›ç¨‹ï¼škillkillå‘½ä»¤æŒ‡å®šè¿›ç¨‹å·çš„è¿›ç¨‹ï¼Œéœ€è¦é…åˆ ps ä½¿ç”¨ã€‚ 12åˆ—å‡ºæ‰€æœ‰çš„è¿›ç¨‹ï¼šps -aux ä½¿ç”¨æ ¼å¼ï¼š kill [-signal] pid ä¿¡å·å€¼ä»Ž0åˆ°15ï¼Œå…¶ä¸­9ä¸ºç»å¯¹ç»ˆæ­¢ï¼Œå¯ä»¥å¤„ç†ä¸€èˆ¬ä¿¡å·æ— æ³•ç»ˆæ­¢çš„è¿›ç¨‹ã€‚Kill -9 9133 å¼ºåˆ¶æ€æ­»è¿›ç¨‹å·ä¸º9133çš„è¿›ç¨‹kill 9133 ï¼š9133 ä¸ºåº”ç”¨ç¨‹åºæ‰€å¯¹åº”çš„è¿›ç¨‹å· æœ‰äº›è¿›ç¨‹ä¸èƒ½ç›´æŽ¥æ€æ­»ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ªå‚æ•°â€œ -9 â€ï¼Œâ€œ -9 â€ ä»£è¡¨å¼ºåˆ¶ç»“æŸ å…³æœºé‡å¯ å‘½ä»¤ å«ä¹‰ reboot é‡æ–°å¯åŠ¨æ“ä½œç³»ç»Ÿ shutdown â€“r now é‡æ–°å¯åŠ¨æ“ä½œç³»ç»Ÿï¼Œshutdownä¼šç»™åˆ«çš„ç”¨æˆ·æç¤º shutdown -h now ç«‹åˆ»å…³æœºï¼Œå…¶ä¸­nowç›¸å½“äºŽæ—¶é—´ä¸º0çš„çŠ¶æ€ shutdown -h 20:25 ç³»ç»Ÿåœ¨ä»Šå¤©çš„20:25 ä¼šå…³æœº shutdown -h +10 ç³»ç»Ÿå†è¿‡ååˆ†é’ŸåŽè‡ªåŠ¨å…³æœº init 0 å…³æœº init 6 é‡å¯ ç£ç›˜æŸ¥çœ‹æ£€æµ‹ç£ç›˜ç©ºé—´ï¼šdfdfå‘½ä»¤ç”¨äºŽæ£€æµ‹æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´å ç”¨å’Œç©ºä½™æƒ…å†µï¼Œå¯ä»¥æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿå¯¹èŠ‚ç‚¹å’Œç£ç›˜å—çš„ä½¿ç”¨æƒ…å†µã€‚ é€‰é¡¹ å«ä¹‰ -a æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨æƒ…å†µ -m ä»¥1024å­—èŠ‚ä¸ºå•ä½æ˜¾ç¤º -t æ˜¾ç¤ºå„æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µ -T æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿ æ£€æµ‹ç›®å½•æ‰€å ç£ç›˜ç©ºé—´ï¼šduduå‘½ä»¤ç”¨äºŽç»Ÿè®¡ç›®å½•æˆ–æ–‡ä»¶æ‰€å ç£ç›˜ç©ºé—´çš„å¤§å°ï¼Œè¯¥å‘½ä»¤çš„æ‰§è¡Œç»“æžœä¸Ždfç±»ä¼¼ï¼Œduæ›´ä¾§é‡äºŽç£ç›˜çš„ä½¿ç”¨çŠ¶å†µã€‚duå‘½ä»¤çš„ä½¿ç”¨æ ¼å¼å¦‚ä¸‹ï¼š du [é€‰é¡¹] ç›®å½•æˆ–æ–‡ä»¶å é€‰é¡¹ å«ä¹‰ -a é€’å½’æ˜¾ç¤ºæŒ‡å®šç›®å½•ä¸­å„æ–‡ä»¶å’Œå­ç›®å½•ä¸­æ–‡ä»¶å ç”¨çš„æ•°æ®å— -s æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•å ç”¨çš„æ•°æ®å— -b ä»¥å­—èŠ‚ä¸ºå•ä½æ˜¾ç¤ºç£ç›˜å ç”¨æƒ…å†µ -l è®¡ç®—æ‰€æœ‰æ–‡ä»¶å¤§å°ï¼Œå¯¹ç¡¬é“¾æŽ¥æ–‡ä»¶è®¡ç®—å¤šæ¬¡ -hè½¬æ¢å•ä½æŸ¥çœ‹å½“å‰ç›®å½•æ‰€å çš„ç©ºé—´å¤§å°ï¼šdu -h æŸ¥çœ‹æˆ–é…ç½®ç½‘å¡ä¿¡æ¯ï¼šifconfigå¦‚æžœï¼Œæˆ‘ä»¬åªæ˜¯æ•²ï¼šifconfigï¼Œå®ƒä¼šæ˜¾ç¤ºæ‰€æœ‰ç½‘å¡çš„ä¿¡æ¯ï¼š loæ˜¯Loopbackçº¯è½¯ä»¶ç½‘ç»œè®¾å¤‡æŽ¥å£ï¼Œloæ˜¯è™šæ‹Ÿå‡ºæ¥çš„ï¼Œç”¨äºŽæ£€æŸ¥ç½‘ç»œæ˜¯å¦æ­£å¸¸ã€‚ ä½¿ç”¨ä¿®æ”¹ipåœ°å€ä¿®æ”¹ipåœ°å€å‘½ä»¤ ï¼šsudo ifconfig ens33 192.168.1.108ï¼Œç½‘ç»œæ–­å¼€ï¼Œåœ¨è¿žæŽ¥ï¼Œå¦‚æžœæœ‰å¤–ç½‘å°±å¯ä»¥è¿žæŽ¥å¤–ç½‘äº†ã€‚ æœ¬åœ°çŽ¯å›žåœ°å€ï¼Œä¸€èˆ¬ç”¨äºŽæµ‹è¯•ç½‘ç»œåŠŸèƒ½æ˜¯å¦å¥½ç”¨ æµ‹è¯•è¿œç¨‹ä¸»æœºè¿žé€šæ€§ï¼šping æŸ¥çœ‹ç³»ç»Ÿæ—¥åŽ†å’Œæ—¶é—´æŸ¥çœ‹å½“å‰æ—¥åŽ†ï¼šcalcalå‘½ä»¤ç”¨äºŽæŸ¥çœ‹å½“å‰æ—¥åŽ†ï¼Œ-yæ˜¾ç¤ºæ•´å¹´æ—¥åŽ†ï¼š æŸ¥çœ‹2009å¹´çš„æ—¥åŽ† cal -y 2009 æ˜¾ç¤ºæˆ–è®¾ç½®æ—¶é—´ï¼šdateè®¾ç½®æ—¶é—´æ ¼å¼ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ï¼š date [MMDDhhmm[[CC]YY][.ss]] +format CCä¸ºå¹´å‰ä¸¤ä½yyä¸ºå¹´çš„åŽä¸¤ä½ï¼Œå‰ä¸¤ä½çš„mmä¸ºæœˆï¼ŒåŽä¸¤ä½çš„mmä¸ºåˆ†é’Ÿï¼Œddä¸ºå¤©ï¼Œhhä¸ºå°æ—¶ï¼Œssä¸ºç§’ã€‚å¦‚ï¼š date 010203042016.55ã€‚ æ˜¾ç¤ºæ—¶é—´æ ¼å¼ï¼ˆdate â€˜+%y,%m,%d,%H,%M,%Sâ€™ï¼‰ï¼š formatæ ¼å¼ å«ä¹‰ %Yï¼Œ%y å¹´ %m æœˆ %d æ—¥ %H æ—¶ %M åˆ† %S ç§’ æ—¶é—´æ˜¯å’Œäº’è”ç½‘åŒæ­¥çš„ã€‚æ ¹æ®ntp(ç½‘ç»œæ—¶é—´åè®®)]]></content>
      <categories>
        <category>Linuxå­¦ä¹ æ€»ç»“</category>
      </categories>
      <tags>
        <tag>Linuxå‘½ä»¤</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxå­¦ä¹ æ€»ç»“]]></title>
    <url>%2F2018%2F02%2F21%2FLinux%2F</url>
    <content type="text"><![CDATA[Linuxå­¦ä¹ æ€»ç»“åˆè¯†Linuxä¸ºä»€ä¹ˆè¦å­¦Linuxå¦‚æžœä½ æ˜¯ä¸€ä¸ªå‰ç«¯çš„å¼€å‘è€…ï¼Œä¹Ÿè®¸ä½ å’Œæˆ‘æœ‰ç›¸ä¼¼çš„ç»åŽ†ï¼šç»å¸¸è¦å’Œå„ç§ç»ˆç«¯å‘½ä»¤æ‰“äº¤é“ï¼Œæ—¥å¸¸ä»£ç çš„ç‰ˆæœ¬ç®¡ç†ï¼Œè½¯ä»¶å®‰è£…ï¼Œæˆ–è€…æ­å»ºä¸€ä¸ªåšå®¢ç­‰ç­‰ï¼Œå®ƒä»¬çš„å¤§å¤šæ•°çš„æ“ä½œéœ€è¦ç”¨å‘½ä»¤è¡Œæ¥å®Œæˆã€‚ç›¸æ¯”äºŽå„ç§æ“ä½œçš„å›¾å½¢å®¢æˆ·ç«¯ï¼Œç¼ºå°‘äº†ä¸€ç§å¯è§†åŒ–çš„ä¸œè¥¿ï¼Œä½†å¯¹äºŽå·¥ä½œæ•ˆçŽ‡çš„æå‡ç»æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚å°±æ‹¿Gitç‰ˆæœ¬ç®¡ç†å·¥å…·æ¥è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨ç±»ä¼¼äºŽSourcetreeæˆ–è€…towerç­‰å›¾å½¢ç•Œé¢çš„ç®¡ç†å·¥å…·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨çœ‹èµ·æ¥æœ‰äº›â€œåŽŸå§‹â€çš„å‘½ä»¤è¡Œï¼Œä½†åŽè€…çš„å¤šæ•°æŒ‡ä»¤æ˜¯å¤šå¹³å°é€šç”¨çš„ï¼ŒçœåŽ»äº†æ¢ä¸€ç§å›¾å½¢å·¥å…·å°±éœ€è¦é‡æ–°å­¦ä¹ çš„éº»çƒ¦ï¼Œå¹¶ä¸”èƒ½å®Œæˆè¾ƒå‰è€…æ›´å¤æ‚çš„æ“ä½œã€‚ å¦‚æžœä½ æ˜¯ä¸€ä¸ªåŽå°å¼€å‘ã€‚ã€‚ã€‚ æ‰€ä»¥ï¼Œå½“å›žæœ›å¤§å­¦æœŸé—´çš„é‚£æ®µè‹¦æ¶©çš„Linuxå­¦ä¹ ç”Ÿæ¶¯ï¼Œä¸å¾—ä¸æ„Ÿå¹ï¼Œè‡ªæˆ‘é©±åŠ¨åŠ ä¸Šç›®çš„æ˜Žç¡®çš„å­¦ä¹ æ–¹å¼ï¼Œè¦æ¯”æ­»è®°ä¹¦æœ¬ä¸ŠèŒ«èŒ«çš„ä»£ç è¦æœ‰æ„ä¹‰ä¸”æ•ˆçŽ‡çš„å¤šã€‚ æ—¢ç„¶ç›®æ ‡æ˜Žç¡®äº†ï¼Œè¿™ç¯‡æ–‡ç« ä»¥ä¸‹çš„éƒ¨åˆ†å°±æ¥ä»Žè®¡ç®—æœºåŸºç¡€éƒ¨åˆ†å¼€å§‹ï¼Œé€æ­¥å±•å¼€Linuxè¾ƒä¸ºç³»ç»Ÿçš„å­¦ä¹ ï¼Œä¾›ä»¥åŽæŸ¥é˜…å‚è€ƒ æ“ä½œç³»ç»Ÿæ“ä½œç³»ç»Ÿèµ‹å€¼è°ƒç”¨è®¡ç®—æœºæˆ–è€…æ‰‹æœºè®¾å¤‡ï¼ˆç¡¬ä»¶ï¼‰ï¼Œæä¾›å…¶ä»–è½¯ä»¶å¯ä»¥è¿è¡Œçš„çŽ¯å¢ƒã€‚ æ“ä½œç³»ç»Ÿçš„å‘å±•å² Unix 1965å¹´ä¹‹å‰çš„æ—¶å€™ï¼Œç”µè„‘å¹¶ä¸åƒçŽ°åœ¨ä¸€æ ·æ™®éï¼Œå®ƒå¯ä¸æ˜¯ä¸€èˆ¬äººèƒ½ç¢°çš„èµ·çš„ï¼Œé™¤éžæ˜¯å†›äº‹æˆ–è€…å­¦é™¢çš„ç ”ç©¶æœºæž„ï¼Œè€Œä¸”å½“æ—¶å¤§åž‹ä¸»æœºè‡³å¤šèƒ½æä¾›30å°ç»ˆç«¯ï¼ˆ30ä¸ªé”®ç›˜ã€æ˜¾ç¤ºå™¨)ï¼Œè¿žæŽ¥ä¸€å°ç”µè„‘ Minix å› ä¸ºAT&amp;Tçš„æ”¿ç­–æ”¹å˜ï¼Œåœ¨Version 7 UnixæŽ¨å‡ºä¹‹åŽï¼Œå‘å¸ƒæ–°çš„ä½¿ç”¨æ¡æ¬¾ï¼Œå°†**UNIX**æºä»£ç ç§æœ‰åŒ–ï¼Œåœ¨å¤§å­¦ä¸­ä¸å†èƒ½ä½¿ç”¨UNIXæºä»£ç ã€‚Andrew S. Tanenbaum(å¡”èƒ½é²å§†ï¼Œè·å…°äººç¾Žå›½å›½ç±)æ•™æŽˆä¸ºäº†èƒ½åœ¨è¯¾å ‚ä¸Šæ•™æŽˆå­¦ç”Ÿæ“ä½œç³»ç»Ÿè¿ä½œçš„å®žåŠ¡ç»†èŠ‚ï¼Œå†³å®šåœ¨ä¸ä½¿ç”¨ä»»ä½•AT&amp;Tçš„æºä»£ç å‰æä¸‹ï¼Œè‡ªè¡Œå¼€å‘ä¸ŽUNIXå…¼å®¹çš„æ“ä½œç³»ç»Ÿï¼Œä»¥é¿å…ç‰ˆæƒä¸Šçš„äº‰è®®ã€‚ä»–ä»¥å°åž‹UNIXï¼ˆmini-UNIXï¼‰ä¹‹æ„ï¼Œå°†å®ƒç§°ä¸ºMINIXã€‚ Linux 1991å¹´å› ä¸ºMinixåªæ˜¯æ•™å­¦ä½¿ç”¨ï¼Œå› æ­¤åŠŸèƒ½å¹¶ä¸å¼ºï¼Œå› æ­¤Torvaldsï¼ˆæž—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼‰åˆ©ç”¨GNUçš„bashï¼ˆæ˜¯è®¸å¤šLinuxå‘è¡Œç‰ˆçš„é»˜è®¤Shellï¼‰å½“åšå¼€å‘çŽ¯å¢ƒï¼Œgccå½“åšç¼–è¯‘å·¥å…·ï¼Œç¼–å†™äº†Linuxå†…æ ¸-v0.02ï¼Œä½†æ˜¯ä¸€å¼€å§‹Linuxå¹¶ä¸èƒ½å…¼å®¹Unixï¼Œå³Unixä¸Šè·‘çš„åº”ç”¨ç¨‹åºä¸èƒ½åœ¨Linuxä¸Šè·‘ï¼Œå³åº”ç”¨ç¨‹åºä¸Žå†…æ ¸ä¹‹é—´çš„æŽ¥å£ä¸ä¸€è‡´ï¼Œå› ä¸ºUnixæ˜¯éµå¾ªPOSIXè§„èŒƒçš„ï¼Œå› æ­¤Torvaldsï¼ˆæ‰˜ç“¦å°”å…¹ï¼‰ä¿®æ”¹äº†Linuxï¼Œå¹¶éµå¾ªPOSIXï¼ˆPortable Operating System Interfaceï¼Œä»–è§„èŒƒäº†åº”ç”¨ç¨‹åºä¸Žå†…æ ¸çš„æŽ¥å£è§„èŒƒï¼‰ï¼› ä¸€å¼€å§‹Linuxåªé€‚ç”¨äºŽ386ï¼ŒåŽæ¥ç»è¿‡å…¨ä¸–ç•Œçš„ç½‘å‹çš„å¸®åŠ©ï¼Œæœ€ç»ˆèƒ½å¤Ÿå…¼å®¹å¤šç§ç¡¬ä»¶ï¼› æ”¯æŒå¤šä»»åŠ¡ æ‰˜ç“¦å°”å…¹1969å¹´12æœˆ28æ—¥å‡ºç”ŸäºŽèŠ¬å…°èµ«å°”è¾›åŸºå¸‚ï¼Œçˆ¶æ¯éƒ½æ˜¯è®°è€…ã€‚ä»–ä»Žå°å°±å¯¹è®¡ç®—æœºæ„Ÿå…´è¶£ã€‚1988å¹´ä»–è¿›å…¥èµ«å°”è¾›åŸºå¤§å­¦å­¦ä¹ ï¼Œä¸“ä¸šä¸ºè®¡ç®—æœºç§‘å­¦ã€‚1991å¹´ï¼Œä»–è´­ä¹°äº†ä¸€å°å±žäºŽè‡ªå·±çš„PCæœºã€‚èµ«å°”è¾›åŸºå¤§å­¦å½“æ—¶é‡‡ç”¨Unixæ“ä½œç³»ç»Ÿï¼Œæ‰˜ç“¦å°”å…¹è§‰å¾—è¯¥äº§å“æ€§èƒ½ä¸å°½å¦‚äººæ„ï¼ŒäºŽæ˜¯å°±å°è¯•ç€è‡ªå·±ç¼–å†™ä¸€æ¬¾æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œè¿™å°±æ˜¯Linuxæ“ä½œç³»ç»Ÿæ¥æºã€‚1997å¹´è‡³2003å¹´ï¼Œæ‰˜ç“¦å°”å…¹åœ¨ç¾Žå›½åŠ å·žå…¨ç¾Žè¾¾(Transmeta)å…¬å¸å·¥ä½œã€‚2003å¹´7æœˆï¼Œä»–åŠ ç›Ÿâ€œå¼€æ”¾æºä»£ç å¼€å‘å®žéªŒå®¤â€(OSDL)ï¼Œä»¥å…¨åŠ›å¼€å‘Linuxå†…æ ¸ã€‚åŽæ¥OSDLä¸Žâ€œå…è´¹æ ‡å‡†é›†å›¢â€(FSG)åˆå¹¶æˆç«‹äº†LinuxåŸºé‡‘ä¼šã€‚æ‰˜ç“¦å°”å…¹å¦‚ä»Šä»åœ¨LinuxåŸºé‡‘ä¼šå·¥ä½œ æ“ä½œç³»ç»Ÿçš„å‘å±• Ubuntuï¼ˆå‹å¸®æ‹“ã€ä¼˜èˆ¬å›¾ã€ä¹Œç­å›¾ï¼‰æ˜¯ä¸€ä¸ªä»¥æ¡Œé¢åº”ç”¨ä¸ºä¸»çš„å¼€æºGNU/Linuxæ“ä½œç³»ç»Ÿï¼ŒUbuntu æ˜¯åŸºäºŽDebian GNU/Linuxï¼Œæ”¯æŒx86ã€amd64ï¼ˆå³x64ï¼‰å’Œppcæž¶æž„ï¼Œç”±å…¨çƒåŒ–çš„ä¸“ä¸šå¼€å‘å›¢é˜Ÿï¼ˆCanonical Ltdï¼‰æ‰“é€ çš„ã€‚ Red Hatå…¬å¸å‘å¸ƒçš„é¢å‘ä¼ä¸šç”¨æˆ·çš„Linuxæ“ä½œç³»ç»Ÿã€‚ SUSE(å‘éŸ³ /ËˆsuËsÉ™/)æ˜¯æŒ‡SUSE Linux ï¼Œæ˜¯å¾·å›½ SuSE Linux AGå…¬å¸å‘è¡Œç»´æŠ¤çš„Linuxå‘è¡Œç‰ˆï¼Œæ˜¯å±žäºŽæ­¤å…¬å¸çš„æ³¨å†Œå•†æ ‡ã€‚ç¬¬ä¸€ä¸ªç‰ˆæœ¬å‡ºçŽ°åœ¨1994å¹´å¹´åˆã€‚2004å¹´è¿™å®¶å…¬å¸è¢«Novellå…¬å¸æ”¶è´­ã€‚ Fedora æ˜¯ä¸€ä¸ª Linux å‘è¡Œç‰ˆï¼Œæ˜¯ä¸€æ¬¾ç”±å…¨çƒç¤¾åŒºçˆ±å¥½è€…æž„å»ºçš„é¢å‘æ—¥å¸¸åº”ç”¨çš„å¿«é€Ÿã€ç¨³å®šã€å¼ºå¤§çš„æ“ä½œç³»ç»Ÿã€‚å®ƒå…è®¸ä»»ä½•äººè‡ªç”±åœ°ä½¿ç”¨ã€ä¿®æ”¹å’Œé‡å‘å¸ƒï¼Œæ— è®ºçŽ°åœ¨è¿˜æ˜¯å°†æ¥ã€‚å®ƒç”±ä¸€ä¸ªå¼ºå¤§çš„ç¤¾ç¾¤å¼€å‘ï¼Œè¿™ä¸ªç¤¾ç¾¤çš„æˆå‘˜ä»¥è‡ªå·±çš„ä¸æ‡ˆåŠªåŠ›ï¼Œæä¾›å¹¶ç»´æŠ¤è‡ªç”±ã€å¼€æ”¾æºç çš„è½¯ä»¶å’Œå¼€æ”¾çš„æ ‡å‡†ã€‚Fedora é¡¹ç›®ç”± Fedora åŸºé‡‘ä¼šç®¡ç†å’ŒæŽ§åˆ¶ï¼Œå¾—åˆ°äº† Red Hat çš„æ”¯æŒã€‚ Linuxä¸åŒç‰ˆæœ¬åŠåº”ç”¨é¢†åŸŸLinuxå†…æ ¸åŠå‘è¡Œç‰ˆæœ¬ä»‹ç» Linuxå†…æ ¸ç‰ˆæœ¬ å†…æ ¸(kernel)æ˜¯ç³»ç»Ÿçš„å¿ƒè„ï¼Œæ˜¯è¿è¡Œç¨‹åºå’Œç®¡ç†åƒç£ç›˜å’Œæ‰“å°æœºç­‰ç¡¬ä»¶è®¾å¤‡çš„æ ¸å¿ƒç¨‹åºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªåœ¨è£¸è®¾å¤‡ä¸Žåº”ç”¨ç¨‹åºé—´çš„æŠ½è±¡å±‚ã€‚ Linuxå†…æ ¸ç‰ˆæœ¬åˆåˆ†ä¸ºç¨³å®šç‰ˆå’Œå¼€å‘ç‰ˆï¼Œä¸¤ç§ç‰ˆæœ¬æ˜¯ç›¸äº’å…³è”ï¼Œç›¸äº’å¾ªçŽ¯ï¼š ç¨³å®šç‰ˆï¼šå…·æœ‰å·¥ä¸šçº§å¼ºåº¦ï¼Œå¯ä»¥å¹¿æ³›åœ°åº”ç”¨å’Œéƒ¨ç½²ã€‚æ–°çš„ç¨³å®šç‰ˆç›¸å¯¹äºŽè¾ƒæ—§çš„åªæ˜¯ä¿®æ­£ä¸€äº›bugæˆ–åŠ å…¥ä¸€äº›æ–°çš„é©±åŠ¨ç¨‹åºã€‚ å¼€å‘ç‰ˆï¼šç”±äºŽè¦è¯•éªŒå„ç§è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥å˜åŒ–å¾ˆå¿«ã€‚ å†…æ ¸æºç ç½‘å€ï¼šhttp://www.kernel.org æ‰€æœ‰æ¥è‡ªå…¨ä¸–ç•Œçš„å¯¹Linuxæºç çš„ä¿®æ”¹æœ€ç»ˆéƒ½ä¼šæ±‡æ€»åˆ°è¿™ä¸ªç½‘ç«™ï¼Œç”±Linusï¼ˆæž—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼‰é¢†å¯¼çš„å¼€æºç¤¾åŒºå¯¹å…¶è¿›è¡Œç”„åˆ«å’Œä¿®æ”¹æœ€ç»ˆå†³å®šæ˜¯å¦è¿›å…¥åˆ°Linuxä¸»çº¿å†…æ ¸æºç ä¸­ã€‚ Linuxå‘è¡Œç‰ˆæœ¬ Linuxå‘è¡Œç‰ˆ (ä¹Ÿè¢«å«åš GNU/Linux å‘è¡Œç‰ˆ) é€šå¸¸åŒ…å«äº†åŒ…æ‹¬æ¡Œé¢çŽ¯å¢ƒã€åŠžå…¬å¥—ä»¶ã€åª’ä½“æ’­æ”¾å™¨ã€æ•°æ®åº“ç­‰åº”ç”¨è½¯ä»¶ã€‚ GNUè®¡åˆ’ï¼šåˆç§°é©å¥´è®¡åˆ’ï¼Œæ˜¯ç”±Richard Stallmanåœ¨1983å¹´9æœˆ27æ—¥å…¬å¼€å‘èµ·çš„ã€‚å®ƒçš„ç›®æ ‡æ˜¯åˆ›å»ºä¸€å¥—å®Œå…¨è‡ªç”±çš„æ“ä½œç³»ç»Ÿã€‚Richard Stallmanæœ€æ—©æ˜¯åœ¨net.unix-wizardsæ–°é—»ç»„ä¸Šå…¬å¸ƒè¯¥æ¶ˆæ¯ï¼Œå¹¶é™„å¸¦ã€ŠGNUå®£è¨€ã€‹ç­‰è§£é‡Šä¸ºä½•å‘èµ·è¯¥è®¡åˆ’çš„æ–‡ç« ï¼Œå…¶ä¸­ä¸€ä¸ªç†ç”±å°±æ˜¯è¦â€œé‡çŽ°å½“å¹´è½¯ä»¶ç•Œåˆä½œäº’åŠ©çš„å›¢ç»“ç²¾ç¥žâ€ã€‚ä¸ºä¿è¯GNUè½¯ä»¶å¯ä»¥è‡ªç”±åœ°â€œä½¿ç”¨ã€å¤åˆ¶ã€ä¿®æ”¹å’Œå‘å¸ƒâ€ï¼Œæ‰€æœ‰GNUè½¯ä»¶éƒ½æœ‰ä¸€ä»½åœ¨ç¦æ­¢å…¶ä»–äººæ·»åŠ ä»»ä½•é™åˆ¶çš„æƒ…å†µä¸‹æŽˆæƒæ‰€æœ‰æƒåˆ©ç»™ä»»ä½•äººçš„åè®®æ¡æ¬¾ï¼ŒGNUé€šç”¨å…¬å…±è®¸å¯è¯ï¼ˆGNU General Public Licenseï¼ŒGPLï¼‰ã€‚å³â€œåç‰ˆæƒâ€ï¼ˆæˆ–ç§°Copyleftï¼‰æ¦‚å¿µã€‚ åº”ç”¨é¢†åŸŸ ä¸ªäººæ¡Œé¢é¢†åŸŸçš„åº”ç”¨ æ­¤é¢†åŸŸæ˜¯ä¼ ç»Ÿlinuxåº”ç”¨æœ€è–„å¼±çš„çŽ¯èŠ‚ï¼Œä¼ ç»Ÿlinuxç”±äºŽç•Œé¢ç®€å•ã€æ“ä½œå¤æ‚ã€åº”ç”¨è½¯ä»¶å°‘çš„ç¼ºç‚¹ï¼Œä¸€ç›´è¢«windowsæ‰€åŽ‹åˆ¶ï¼Œä½†è¿‘äº›å¹´æ¥éšç€ubuntuã€fedora [fÉªËˆdÉ”:rÉ™] ç­‰ä¼˜ç§€æ¡Œé¢çŽ¯å¢ƒçš„å…´èµ·ï¼ŒåŒæ—¶å„å¤§ç¡¬ä»¶åŽ‚å•†å¯¹å…¶æ”¯æŒçš„åŠ å¤§ï¼Œlinuxåœ¨ä¸ªäººæ¡Œé¢é¢†åŸŸçš„å æœ‰çŽ‡åœ¨é€æ¸çš„æé«˜ å…¸åž‹ä»£è¡¨ï¼šubuntuã€fedora [fÉªâ€™dÉ”ËrÉ™]ã€suse linux åœ¨Ubuntuä¸­çŽ©QQ æœåŠ¡å™¨é¢†åŸŸ linuxåœ¨æœåŠ¡å™¨é¢†åŸŸçš„åº”ç”¨æ˜¯å…¶é‡è¦åˆ†æ”¯ linuxå…è´¹ã€ç¨³å®šã€é«˜æ•ˆç­‰ç‰¹ç‚¹åœ¨è¿™é‡Œå¾—åˆ°äº†å¾ˆå¥½çš„ä½“çŽ°ï¼Œä½†æ—©æœŸå› ä¸ºç»´æŠ¤ã€è¿è¡Œç­‰åŽŸå› åŒæ ·å—åˆ°äº†å¾ˆå¤§çš„é™åˆ¶ï¼Œä½†è¿‘äº›å¹´æ¥linuxæœåŠ¡å™¨å¸‚åœºå¾—åˆ°äº†é£žé€Ÿçš„æå‡ï¼Œå°¤å…¶åœ¨ä¸€äº›é«˜ç«¯é¢†åŸŸå°¤ä¸ºå¹¿æ³› å…¸åž‹ä»£è¡¨ï¼š â€‹ Red Hatå…¬å¸çš„ASç³»åˆ— â€‹ å®Œå…¨å¼€æºçš„debianç³»åˆ— â€‹ suse EnterPrise 11ç³»åˆ—ç­‰ åµŒå…¥å¼é¢†åŸŸ æ™ºèƒ½ç¡¬ä»¶ è¿‘äº›å¹´æ¥linuxåœ¨åµŒå…¥å¼é¢†åŸŸçš„åº”ç”¨å¾—åˆ°äº†é£žé€Ÿçš„æé«˜ linuxè¿è¡Œç¨³å®šã€å¯¹ç½‘ç»œçš„è‰¯å¥½æ”¯æŒæ€§ã€ä½Žæˆæœ¬ï¼Œä¸”å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œè½¯ä»¶è£å‰ªï¼Œå†…æ ¸æœ€å°å¯ä»¥è¾¾åˆ°å‡ ç™¾KBç­‰ç‰¹ç‚¹ï¼Œä½¿å…¶è¿‘äº›å¹´æ¥åœ¨åµŒå…¥å¼é¢†åŸŸçš„åº”ç”¨å¾—åˆ°éžå¸¸å¤§çš„æé«˜ ä¸»è¦åº”ç”¨ï¼šæœºé¡¶ç›’ã€æ•°å­—ç”µè§†ã€ç½‘ç»œç”µè¯ã€ç¨‹æŽ§äº¤æ¢æœºã€æ‰‹æœºã€PDAã€æ™ºèƒ½å®¶å±…ã€æ™ºèƒ½ç¡¬ä»¶ç­‰éƒ½æ˜¯å…¶åº”ç”¨é¢†åŸŸï¼Œå¾—åˆ°äº†æ‘©æ‰˜ç½—æ‹‰ã€ä¸‰æ˜Ÿã€NECã€Googleç­‰å…¬å¸çš„å¤§åŠ›æŽ¨å¹¿ æ–‡ä»¶å’Œç›®å½•åœ¨å¸¸ç”¨çš„Windowså¹³å°ä¸‹ï¼Œæ‰“å¼€è®¡ç®—æœºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¤šä¸ªæ ‘å¹¶åˆ—çš„ç›®å½•ç»“æž„ åœ¨ Linux ä¸‹ï¼Œæˆ‘ä»¬æ˜¯çœ‹ä¸åˆ°è¿™äº›é©±åŠ¨å™¨ç›˜ç¬¦ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ˜¯æ–‡ä»¶å¤¹ï¼ˆç›®å½•ï¼‰ï¼š ç±»Unixç³»ç»Ÿç›®å½•ç»“æž„ linuxæ²¡æœ‰ç›˜ç¬¦è¿™ä¸ªæ¦‚å¿µï¼Œåªæœ‰ä¸€ä¸ªæ ¹ç›®å½•/ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨å®ƒä¸‹é¢ æ‰“å¼€æŽ§åˆ¶å°å¿«æ·é”®ï¼šCtrl+Alt+T æŽ§åˆ¶å°æ–‡å­—è°ƒå¤§ï¼šCtrl+Shift++ï¼ˆCtrlé”®åŠ ä¸ŠShiftåŠ è½½+å·ï¼‰ æŽ§åˆ¶å°æ–‡å­—è°ƒå°ï¼šCtrl+-ï¼ˆï¼ˆCtrlé”®åŠ ä¸Šå‡å·ï¼‰ åœ¨ä¸€ä¸ªæŽ§åˆ¶å±‚æ‰“å¼€å¦å¤–ä¸€ä¸ªçª—å£ï¼šCtrl+Shift+T æ‰“å¼€å¤šä¸ªçª—å£å‘½ä»¤ï¼šCtrl+Shift+T åˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªçª—å£ï¼šAlt+1 åˆ‡æ¢åˆ°ç¬¬äºŒä¸ªçª—å£ï¼šAlt+2 åˆ‡æ¢åˆ°ç¬¬ä¸‰ä¸ªçª—å£ï¼šAlt+3 é€€å‡ºçª—å£å‘½ä»¤ï¼šexit Linuxç›®å½•ç®€ä»‹ /ï¼šæ ¹ç›®å½•ï¼Œä¸€èˆ¬æ ¹ç›®å½•ä¸‹åªå­˜æ”¾ç›®å½•ï¼Œåœ¨Linuxä¸‹æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ ¹ç›®å½•ã€‚æ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯ä»Žè¿™é‡Œå¼€å§‹ã€‚å½“ä½ åœ¨ç»ˆç«¯é‡Œè¾“å…¥â€œ/homeâ€ï¼Œä½ å…¶å®žæ˜¯åœ¨å‘Šè¯‰ç”µè„‘ï¼Œå…ˆä»Ž/ï¼ˆæ ¹ç›®å½•ï¼‰å¼€å§‹ï¼Œå†è¿›å…¥åˆ°homeç›®å½•ã€‚ /binï¼š/usr/bin: å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç›®å½•ï¼Œç¨‹åºå°±å®‰è£…åœ¨è¿™ä¸ªç›®å½•ï¼Œå¦‚å¸¸ç”¨çš„å‘½ä»¤lsã€tarã€mvã€catç­‰ã€‚ /bootï¼šï¼ˆå¼•å¯¼çš„æ„æ€ï¼‰æ”¾ç½®linuxç³»ç»Ÿå¯åŠ¨æ—¶ç”¨åˆ°çš„ä¸€äº›æ–‡ä»¶ï¼Œå¦‚æžœåˆ é™¤äº†ï¼Œç”µè„‘æœ‰åˆå¯èƒ½å¯åŠ¨ä¸äº†ï¼Œå¦‚Linuxçš„å†…æ ¸æ–‡ä»¶ï¼š/boot/vmlinuzï¼Œç³»ç»Ÿå¼•å¯¼ç®¡ç†å™¨ï¼š/boot/grubã€‚ /devï¼šå­˜æ”¾linuxç³»ç»Ÿä¸‹çš„è®¾å¤‡æ–‡ä»¶ï¼Œè®¿é—®è¯¥ç›®å½•ä¸‹æŸä¸ªæ–‡ä»¶ï¼Œç›¸å½“äºŽè®¿é—®æŸä¸ªè®¾å¤‡ï¼Œå¸¸ç”¨çš„æ˜¯æŒ‚è½½å…‰é©± mount /dev/cdrom /mntã€‚ /etcï¼šç³»ç»Ÿé…ç½®æ–‡ä»¶å­˜æ”¾çš„ç›®å½•ï¼Œä¸å»ºè®®åœ¨æ­¤ç›®å½•ä¸‹å­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‡è¦çš„é…ç½®æ–‡ä»¶æœ‰ /etc/inittabã€/etc/fstabã€/etc/init.dã€/etc/X11ã€/etc/sysconfigã€/etc/xinetd.dã€‚ /homeï¼šç³»ç»Ÿé»˜è®¤çš„ç”¨æˆ·å®¶ç›®å½•ï¼Œæ–°å¢žç”¨æˆ·è´¦å·æ—¶ï¼Œç”¨æˆ·çš„å®¶ç›®å½•éƒ½å­˜æ”¾åœ¨æ­¤ç›®å½•ä¸‹ï¼Œ~è¡¨ç¤ºå½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œ~edu è¡¨ç¤ºç”¨æˆ· edu çš„å®¶ç›®å½•ã€‚æ³¨æ„ï¼Œä»¥åŽä½ è¦åšä»»ä½•äº‹æƒ…å»ºè®®éƒ½åœ¨è¿™é‡Œåšï¼Œå…¶ä»–ç›®å½•ä¸è¦éšä¾¿åˆ é™¤ã€‚ /libã€/usr/libã€/usr/local/libï¼šç³»ç»Ÿä½¿ç”¨çš„å‡½æ•°åº“çš„ç›®å½•ï¼Œç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦è°ƒç”¨ä¸€äº›é¢å¤–çš„å‚æ•°æ—¶éœ€è¦å‡½æ•°åº“çš„ååŠ©ã€‚ /rootï¼šç³»ç»Ÿç®¡ç†å‘˜rootçš„å®¶ç›®å½•ã€‚ /lost+fountï¼šç³»ç»Ÿå¼‚å¸¸äº§ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šå°†ä¸€äº›é—å¤±çš„ç‰‡æ®µæ”¾ç½®äºŽæ­¤ç›®å½•ä¸‹ã€‚ /mnt: /mediaï¼šå…‰ç›˜é»˜è®¤æŒ‚è½½ç‚¹ï¼Œé€šå¸¸å…‰ç›˜æŒ‚è½½äºŽ /mnt/cdrom ä¸‹ï¼Œä¹Ÿä¸ä¸€å®šï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ä½ç½®è¿›è¡ŒæŒ‚è½½ã€‚ /optï¼šç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½•ã€‚ /procï¼šæ­¤ç›®å½•çš„æ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œå¦‚ç³»ç»Ÿæ ¸å¿ƒï¼Œå¤–éƒ¨è®¾å¤‡ï¼Œç½‘ç»œçŠ¶æ€ï¼Œç”±äºŽæ•°æ®éƒ½å­˜æ”¾äºŽå†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œæ¯”è¾ƒé‡è¦çš„ç›®å½•æœ‰ /proc/cpuinfoã€/proc/interruptsã€/proc/dmaã€/proc/ioportsã€/proc/net/ ç­‰ã€‚ /sbinã€/usr/sbinã€/usr/local/sbinï¼šæ”¾ç½®ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„å¯æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚fdiskã€shutdownã€mount ç­‰ã€‚ä¸Ž /bin ä¸åŒçš„æ˜¯ï¼Œè¿™å‡ ä¸ªç›®å½•æ˜¯ç»™ç³»ç»Ÿç®¡ç†å‘˜ rootä½¿ç”¨çš„å‘½ä»¤ï¼Œä¸€èˆ¬ç”¨æˆ·åªèƒ½â€æŸ¥çœ‹â€è€Œä¸èƒ½è®¾ç½®å’Œä½¿ç”¨ã€‚ /tmpï¼šä¸€èˆ¬ç”¨æˆ·æˆ–æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºä¸´æ—¶å­˜æ”¾æ–‡ä»¶çš„ç›®å½•ï¼Œä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ï¼Œé‡è¦æ•°æ®ä¸å¯æ”¾ç½®åœ¨æ­¤ç›®å½•ä¸‹ã€‚ /srvï¼šæœåŠ¡å¯åŠ¨ä¹‹åŽéœ€è¦è®¿é—®çš„æ•°æ®ç›®å½•ï¼Œå¦‚ www æœåŠ¡éœ€è¦è®¿é—®çš„ç½‘é¡µæ•°æ®å­˜æ”¾åœ¨ /srv/www å†…ã€‚ /usrï¼šåº”ç”¨ç¨‹åºå­˜æ”¾ç›®å½•ï¼Œ/usr/bin å­˜æ”¾åº”ç”¨ç¨‹åºï¼Œ/usr/share å­˜æ”¾å…±äº«æ•°æ®ï¼Œ/usr/lib å­˜æ”¾ä¸èƒ½ç›´æŽ¥è¿è¡Œçš„ï¼Œå´æ˜¯è®¸å¤šç¨‹åºè¿è¡Œæ‰€å¿…éœ€çš„ä¸€äº›å‡½æ•°åº“æ–‡ä»¶ã€‚/usr/local: å­˜æ”¾è½¯ä»¶å‡çº§åŒ…ã€‚/usr/share/doc: ç³»ç»Ÿè¯´æ˜Žæ–‡ä»¶å­˜æ”¾ç›®å½•ã€‚/usr/share/man: ç¨‹åºè¯´æ˜Žæ–‡ä»¶å­˜æ”¾ç›®å½•ã€‚ /varï¼šæ”¾ç½®ç³»ç»Ÿæ‰§è¡Œè¿‡ç¨‹ä¸­ç»å¸¸å˜åŒ–çš„æ–‡ä»¶ï¼Œå¦‚éšæ—¶æ›´æ”¹çš„æ—¥å¿—æ–‡ä»¶ /var/logï¼Œ/var/log/messageï¼šæ‰€æœ‰çš„ç™»å½•æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œ/var/spool/mailï¼šé‚®ä»¶å­˜æ”¾çš„ç›®å½•ï¼Œ/var/run:ç¨‹åºæˆ–æœåŠ¡å¯åŠ¨åŽï¼Œå…¶PIDå­˜æ”¾åœ¨è¯¥ç›®å½•ä¸‹ã€‚ ç”¨æˆ·ç›®å½•cdå‘½ä»¤ cdæ˜¯change dir ç®€ç§°ï¼Œç”¨äºŽåˆ‡æ¢ç›®å½• å®¶ç›®å½• ä½äºŽ/home/userï¼Œç§°ä¹‹ä¸ºç”¨æˆ·å·¥ä½œç›®å½•æˆ–å®¶ç›®å½•,è¡¨ç¤ºæ–¹å¼ï¼š æŸ¥çœ‹å½“å‰åœ¨ä¸ªç›®å½•ï¼Œpwd è·³è½¬åˆ°å½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œcd ~ æ–‡ä»¶æƒé™ç†è§£ æ–‡ä»¶æƒé™ æ–‡ä»¶æƒé™å°±æ˜¯æ–‡ä»¶çš„è®¿é—®æŽ§åˆ¶æƒé™ï¼Œå³å“ªäº›ç”¨æˆ·å’Œç»„ç¾¤å¯ä»¥è®¿é—®æ–‡ä»¶ä»¥åŠå¯ä»¥æ‰§è¡Œä»€ä¹ˆæ ·çš„æ“ä½œã€‚ Unix/Linuxç³»ç»Ÿæ˜¯ä¸€ä¸ªå…¸åž‹çš„å¤šç”¨æˆ·ç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·å¤„äºŽä¸åŒçš„åœ°ä½ï¼Œå¯¹æ–‡ä»¶å’Œç›®å½•æœ‰ä¸åŒçš„è®¿é—®æƒé™ã€‚ä¸ºäº†ä¿æŠ¤ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼ŒUnix/Linuxç³»ç»Ÿé™¤äº†å¯¹ç”¨æˆ·æƒé™ä½œäº†ä¸¥æ ¼çš„ç•Œå®šå¤–ï¼Œè¿˜åœ¨ç”¨æˆ·èº«ä»½è®¤è¯ã€è®¿é—®æŽ§åˆ¶ã€ä¼ è¾“å®‰å…¨ã€æ–‡ä»¶è¯»å†™æƒé™ç­‰æ–¹é¢ä½œäº†å‘¨å¯†çš„æŽ§åˆ¶ã€‚ åœ¨ Unix/Linuxä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•éƒ½åŒ…å«æœ‰è®¿é—®æƒé™ï¼Œè¿™äº›è®¿é—®æƒé™å†³å®šäº†è°èƒ½è®¿é—®å’Œå¦‚ä½•è®¿é—®è¿™äº›æ–‡ä»¶å’Œç›®å½•ã€‚ è®¿é—®ç”¨æˆ· é€šè¿‡è®¾å®šæƒé™å¯ä»¥ä»Žä»¥ä¸‹ä¸‰ç§è®¿é—®æ–¹å¼é™åˆ¶è®¿é—®æƒé™ï¼š åªå…è®¸ç”¨æˆ·è‡ªå·±è®¿é—®ï¼ˆæ‰€æœ‰è€…ï¼‰ æ‰€æœ‰è€…å°±æ˜¯åˆ›å»ºæ–‡ä»¶çš„ç”¨æˆ·ï¼Œç”¨æˆ·æ˜¯æ‰€æœ‰ç”¨æˆ·æ‰€åˆ›å»ºæ–‡ä»¶çš„æ‰€æœ‰è€…ï¼Œç”¨æˆ·å¯ä»¥å…è®¸æ‰€åœ¨çš„ç”¨æˆ·ç»„èƒ½è®¿é—®ç”¨æˆ·çš„æ–‡ä»¶ã€‚ å…è®¸ä¸€ä¸ªé¢„å…ˆæŒ‡å®šçš„ç”¨æˆ·ç»„ä¸­çš„ç”¨æˆ·è®¿é—®ï¼ˆç”¨æˆ·ç»„ï¼‰ ç”¨æˆ·éƒ½ç»„åˆæˆç”¨æˆ·ç»„ï¼Œä¾‹å¦‚ï¼ŒæŸä¸€ç±»æˆ–æŸä¸€é¡¹ç›®ä¸­çš„æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½å¤Ÿè¢«ç³»ç»Ÿç®¡ç†å‘˜å½’ä¸ºä¸€ä¸ªç”¨æˆ·ç»„ï¼Œä¸€ä¸ªç”¨æˆ·èƒ½å¤ŸæŽˆäºˆæ‰€åœ¨ç”¨æˆ·ç»„çš„å…¶ä»–æˆå‘˜çš„æ–‡ä»¶è®¿é—®æƒé™ã€‚ å…è®¸ç³»ç»Ÿä¸­çš„ä»»ä½•ç”¨æˆ·è®¿é—®ï¼ˆå…¶ä»–ç”¨æˆ·ï¼‰ ç”¨æˆ·ä¹Ÿå°†è‡ªå·±çš„æ–‡ä»¶å‘ç³»ç»Ÿå†…çš„æ‰€æœ‰ç”¨æˆ·å¼€æ”¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå†…çš„æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½å¤Ÿè®¿é—®ç”¨æˆ·çš„ç›®å½•æˆ–æ–‡ä»¶ã€‚åœ¨è¿™ç§æ„ä¹‰ä¸Šï¼Œç³»ç»Ÿå†…çš„å…¶ä»–æ‰€æœ‰ç”¨æˆ·å°±æ˜¯ other ç”¨æˆ·ç±» è®¿é—®æƒé™ ç”¨æˆ·èƒ½å¤ŸæŽ§åˆ¶ä¸€ä¸ªç»™å®šçš„æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®ç¨‹åº¦ï¼Œä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•å¯èƒ½æœ‰è¯»ã€å†™åŠæ‰§è¡Œæƒé™ï¼š è¯»æƒé™ï¼ˆrï¼‰ å¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰è¯»å–æ–‡ä»¶å†…å®¹çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´ï¼Œå…·æœ‰æµè§ˆç›®å½•çš„æƒé™ã€‚ å†™æƒé™ï¼ˆwï¼‰ å¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰æ–°å¢žã€ä¿®æ”¹æ–‡ä»¶å†…å®¹çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´ï¼Œå…·æœ‰åˆ é™¤ã€ç§»åŠ¨ç›®å½•å†…æ–‡ä»¶çš„æƒé™ã€‚ å¯æ‰§è¡Œæƒé™ï¼ˆxï¼‰ å¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰æ‰§è¡Œæ–‡ä»¶çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´è¯¥ç”¨æˆ·å…·æœ‰è¿›å…¥ç›®å½•çš„æƒé™ã€‚ æ³¨æ„ï¼šé€šå¸¸ï¼ŒUnix/Linuxç³»ç»Ÿåªå…è®¸æ–‡ä»¶çš„å±žä¸»(æ‰€æœ‰è€…)æˆ–è¶…çº§ç”¨æˆ·æ”¹å˜æ–‡ä»¶çš„è¯»å†™æƒé™ã€‚ ç¤ºä¾‹è¯´æ˜Ž ã€ ç¬¬1ä¸ªå­—æ¯ä»£è¡¨æ–‡ä»¶çš„ç±»åž‹ï¼šâ€œdâ€ ä»£è¡¨æ–‡ä»¶å¤¹ã€â€œ-â€ ä»£è¡¨æ™®é€šæ–‡ä»¶ã€â€œcâ€ ä»£è¡¨ç¡¬ä»¶å­—ç¬¦è®¾å¤‡ã€â€œbâ€ ä»£è¡¨ç¡¬ä»¶å—è®¾å¤‡ã€â€œsâ€è¡¨ç¤ºç®¡é“æ–‡ä»¶ã€â€œlâ€ ä»£è¡¨è½¯é“¾æŽ¥æ–‡ä»¶(læ˜¯Lçš„å°å†™)ã€‚ åŽ 9 ä¸ªå­—æ¯åˆ†åˆ«ä»£è¡¨ä¸‰ç»„æƒé™ï¼šæ–‡ä»¶æ‰€æœ‰è€…ã€ç”¨æˆ·è€…ã€å…¶ä»–ç”¨æˆ·æ‹¥æœ‰çš„æƒé™ã€‚ æ¯ä¸€ä¸ªç”¨æˆ·éƒ½æœ‰å®ƒè‡ªèº«çš„è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚ ç¬¬ä¸€ç»„æƒé™æŽ§åˆ¶è®¿é—®è‡ªå·±çš„æ–‡ä»¶æƒé™ï¼Œå³æ‰€æœ‰è€…æƒé™ã€‚ ç¬¬äºŒç»„æƒé™æŽ§åˆ¶ç”¨æˆ·ç»„è®¿é—®å…¶ä¸­ä¸€ä¸ªç”¨æˆ·çš„æ–‡ä»¶çš„æƒé™ã€‚ ç¬¬ä¸‰ç»„æƒé™æŽ§åˆ¶å…¶ä»–æ‰€æœ‰ç”¨æˆ·è®¿é—®ä¸€ä¸ªç”¨æˆ·çš„æ–‡ä»¶çš„æƒé™ã€‚ è¿™ä¸‰ç»„æƒé™èµ‹äºˆç”¨æˆ·ä¸åŒç±»åž‹ï¼ˆå³æ‰€æœ‰è€…ã€ç”¨æˆ·ç»„å’Œå…¶ä»–ç”¨æˆ·ï¼‰çš„è¯»ã€å†™åŠæ‰§è¡Œæƒé™å°±æž„æˆäº†ä¸€ä¸ªæœ‰9ç§ç±»åž‹çš„æƒé™ç»„ã€‚]]></content>
      <categories>
        <category>Linuxå­¦ä¹ æ€»ç»“</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[UIStackView]]></title>
    <url>%2F2017%2F10%2F25%2FUIStackView%2F</url>
    <content type="text"><![CDATA[UIStackViewUIStackViewæ˜¯ä»€ä¹ˆ A streamlined interface for laying out a collection of views in either a column or a row.ä¸€ä¸ªé«˜æ•ˆçš„æŽ¥å£ç”¨äºŽå¹³é“ºä¸€è¡Œæˆ–ä¸€åˆ—çš„è§†å›¾ç»„åˆiOS9ä¸­ï¼Œè‹¹æžœåœ¨UIKitæ¡†æž¶ä¸­å¼•å…¥äº†ä¸€ä¸ªæ–°çš„è§†å›¾ç±»UIStackViewã€‚UIStackViewå†…éƒ¨ç®¡ç†è€…ä¸€ä¸ªarrangedSubviewsï¼Œè¿™äº›arrangedSubviewsä¼šæ ¹æ®å®ƒä»¬åœ¨æ•°ç»„ä¸­çš„é¡ºåºï¼ŒæŒ‰ç…§UIStackViewå®šä¹‰çš„è½´å‘â€œaxisâ€é¡ºåºæŽ’åˆ—ã€‚å¯¹äºŽåµŒå…¥å…¶ä¸­çš„å­è§†å›¾æ¥è®²ï¼Œä½ æ— é¡»åŽ»æ·»åŠ çº¦æŸï¼Œstack viewä¼šè‡ªåŠ¨å¤„ç†å¥½å¸ƒå±€ã€‚ UIStackViewçš„ä½œç”¨ä»Žä¸€ä¸ªç®€å•å¸ƒå±€ç¤ºä¾‹è¯´èµ·ï¼šåœ¨è®¤è¯†stack view ä¹‹å‰ï¼Œæˆ‘ä»¬èƒ½æƒ³åˆ°çš„æœ€æœ‰æ•ˆçš„æ–¹å¼æ˜¯ä½¿ç”¨AutoLayoutè¿›è¡Œå¸ƒå±€ï¼Œå¯¹å…¶ä¸­çš„æ¯ä¸€ä¸ªViewå„è‡ªæ·»åŠ çº¦æŸã€‚äº†è§£Masonryæ¡†æž¶çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å…¶ ç­‰é—´è·å¸ƒå±€çš„æ–¹å¼ç®€åŒ–æ“ä½œæµç¨‹ã€‚ å¦‚æžœä½¿ç”¨UIStackViewï¼Œå…¶å®žçŽ°ä»£ç å¦‚ä¸‹ï¼š 123456containerView = [[UIStackView alloc] initWithFrame:CGRectMake(0, 100, ScreenWidth, 200)];containerView.axis = UILayoutConstraintAxisHorizontal;containerView.distribution = UIStackViewDistributionFillEqually;containerView.spacing = 10;containerView.alignment = UIStackViewAlignmentFill; ç®€æ´æ˜Žäº†ã€‚ UIStackViewçš„å¸¸ç”¨å±žæ€§å’Œæ–¹æ³• axis ï¼šå­æŽ§ä»¶çš„å¸ƒå±€æ–¹å‘ï¼Œæ°´å¹³æˆ–åž‚ç›´ã€‚ 1234typedef enum UILayoutConstraintAxis : NSInteger &#123; UILayoutConstraintAxisHorizontal = 0, UILayoutConstraintAxisVertical = 1&#125; UILayoutConstraintAxis; spacingï¼šä¹‹æ‰€ä»¥è¯´æ˜¯æœ€å°é—´è·ï¼Œå› ä¸ºstackViewä¼šæ ¹æ®ä¸€å®šçš„è§„åˆ™å¯¹å†…éƒ¨ç©ºé—´å¸ƒå±€ï¼Œæœ‰çš„æ—¶å€™ä¸èƒ½æ»¡è¶³æ‰€æœ‰è¦æ±‚ï¼Œæ¯”å¦‚stackView æœ¬èº«å®½åº¦100ï¼Œå†…éƒ¨ä¸¤ä¸ªæŽ§ä»¶ï¼Œå®½åº¦éƒ½ä¸º50ï¼Œ50+50+10å°±è¶…è¿‡äº†æœ¬èº«å®½åº¦ï¼Œ è¿™æ—¶ä¼šåŽ‹ç¼©å…¶ä¸­ä¸€ä¸ªå­æŽ§ä»¶çš„å®½åº¦æ¥æ»¡è¶³æœ€å°é—´è·ã€‚ åœ¨å¼„æ‡‚åŽ‹ç¼©çš„ä¼˜å…ˆçº§é—®é¢˜ä¹‹å‰ï¼Œæœ‰å¿…è¦äº†è§£è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Intrinsic Content Sizeã€‚æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨AutoLayoutçº¦æŸä¸€ä¸ªUILabelã€UIImageViewã€æˆ–è€…UIButtonçš„æ—¶å€™ï¼Œç»å¸¸åªç»™å®šä»–ä»¬çš„ä½ç½®ï¼ˆoriginï¼‰ï¼ŒæŽ§ä»¶å†…éƒ¨çš„Sizeä¼šè‡ªåŠ¨è®¡ç®—å‡ºæ¥â€œæ’‘å¼€â€æŽ§ä»¶ã€‚è¿™ä¸ªæ’‘å¼€çš„å°ºå¯¸å°±æ˜¯ Intrinsic Content Sizeï¼ˆå›ºæœ‰å°ºå¯¸ï¼‰ã€‚UIStackViewå­æŽ§ä»¶å¸ƒå±€å°±æ˜¯æ ¹æ®å›ºæœ‰å°ºå¯¸æ¥ç¡®å®šçš„ï¼Œå¦‚æžœå­æŽ§ä»¶çš„å›ºæœ‰å°ºå¯¸åŠ ä¸Šspacingçš„å€¼å¤§äºŽäº†UIStackViewçš„å®½åº¦ï¼ˆå¦‚æžœåž‚ç›´å¸ƒå±€åˆ™ä¸ºé«˜åº¦ï¼‰ï¼Œå°±ä¼šåŽ‹ç¼©å…¶ä¸­çš„ä¸€ä¸ªå­æŽ§ä»¶ï¼Œå…·ä½“æ¥è®²åŽ‹ç¼© CompressionResistanceå€¼è¾ƒä½Žçš„é‚£ä¸ªã€‚è¯¦æƒ…å‚è€ƒ Hugging &amp; CompressionResistance distributionï¼šå­æŽ§ä»¶ä¾æ®ä½•ç§è§„åˆ™å¸ƒå±€, UIStackViewDistributionæžšä¸¾å®šä¹‰å¦‚ä¸‹ï¼š 12345678910111213typedef enum UIStackViewDistribution : NSInteger &#123; UIStackViewDistributionFill = 0, UIStackViewDistributionFillEqually, UIStackViewDistributionFillProportionally, UIStackViewDistributionEqualSpacing, UIStackViewDistributionEqualCentering&#125; UIStackViewDistribution; UIStackViewDistributionFillï¼šå®ƒå°±æ˜¯å°† arrangedSubviews å¡«å……æ»¡æ•´ä¸ª StackView ï¼Œå¦‚æžœè®¾ç½®äº†spacingï¼Œé‚£ä¹ˆè¿™äº› arrangedSubviews ä¹‹é—´çš„é—´è·å°±æ˜¯spacingã€‚å¦‚æžœå‡åŽ»æ‰€æœ‰çš„spacingï¼Œæ‰€æœ‰çš„ arrangedSubview çš„å›ºæœ‰å°ºå¯¸( intrinsicContentSize )ä¸èƒ½å¡«æ»¡æˆ–è€…è¶…å‡º StackView çš„å°ºå¯¸ï¼Œé‚£å°±ä¼šæŒ‰ç…§ Hugging æˆ–è€… CompressionResistance çš„ä¼˜å…ˆçº§æ¥æ‹‰ä¼¸æˆ–åŽ‹ç¼©ä¸€äº› arrangedSubview ã€‚å¦‚æžœå‡ºçŽ°ä¼˜å…ˆçº§ç›¸åŒçš„æƒ…å†µï¼Œå°±æŒ‰æŽ’åˆ—é¡ºåºæ¥æ‹‰ä¼¸æˆ–åŽ‹ç¼©ã€‚ â€‹ UIStackViewDistributionFillEquallyï¼šè¿™ç§å°±æ˜¯ StackView çš„å°ºå¯¸å‡åŽ»æ‰€æœ‰çš„spacingä¹‹åŽå‡åˆ†ç»™ arrangedSubviews ï¼Œæ¯ä¸ª arrangedSubview çš„å°ºå¯¸æ˜¯ç›¸åŒçš„ã€‚ â€‹ UIStackViewDistributionFillProportionallyï¼šè¿™ç§è·ŸFillEquallyå·®ä¸å¤šï¼Œåªä¸è¿‡è¿™ä¸ªä¸æ˜¯è®²å°ºå¯¸å‡åˆ†ç»™ arrangedSubviews ï¼Œè€Œæ˜¯æ ¹æ® arrangedSubviews çš„ intrinsicContentSize æŒ‰æ¯”ä¾‹åˆ†é…ã€‚ â€‹ UIStackViewDistributionEqualSpacingï¼šè¿™ç§æ˜¯ä½¿ arrangedSubview ä¹‹é—´çš„spacingç›¸ç­‰ï¼Œä½†æ˜¯è¿™ä¸ªspacingæ˜¯æœ‰å¯èƒ½å¤§äºŽ StackView æ‰€è®¾ç½®çš„spacingï¼Œä½†æ˜¯ç»å¯¹ä¸ä¼šå°äºŽã€‚è¿™ä¸ªç±»åž‹çš„å¸ƒå±€å¯ä»¥è¿™æ ·ç†è§£ï¼Œå…ˆæŒ‰æ‰€æœ‰çš„ arrangedSubview çš„ intrinsicContentSize å¸ƒå±€ï¼Œç„¶åŽä½™ä¸‹çš„ç©ºé—´å‡åˆ†ä¸ºspacingï¼Œå¦‚æžœå¤§çº¦ StackView è®¾ç½®çš„spacingé‚£è¿™æ ·å°±OKäº†ï¼Œå¦‚æžœå°äºŽå°±æŒ‰ç…§ StackView è®¾ç½®çš„spacingï¼Œç„¶åŽæŒ‰ç…§ CompressionResistance çš„ä¼˜å…ˆçº§æ¥åŽ‹ç¼©ä¸€ä¸ª arrangedSubview â€‹ UIStackViewDistributionEqualCenteringï¼šè¿™ç§æ˜¯ä½¿ arrangedSubview çš„ä¸­å¿ƒç‚¹ä¹‹é—´çš„è·ç¦»ç›¸ç­‰ï¼Œè¿™æ ·æ²¡ä¸¤ä¸ª arrangedSubview ä¹‹é—´çš„spacingå°±æœ‰å¯èƒ½ä¸æ˜¯ç›¸ç­‰çš„ï¼Œä½†æ˜¯è¿™ä¸ªspacingä»ç„¶æ˜¯å¤§äºŽç­‰äºŽ StackView è®¾ç½®çš„spacingçš„ï¼Œä¸ä¼šæ˜¯å°äºŽã€‚è¿™ä¸ªç±»åž‹å¸ƒå±€ä»ç„¶æ˜¯å¦‚æžœ StackView æœ‰å¤šä½™çš„ç©ºé—´ä¼šå‡åˆ†ç»™ arrangedSubviews ä¹‹é—´çš„spacingï¼Œå¦‚æžœç©ºé—´ä¸å¤Ÿé‚£å°±æŒ‰ç…§ CompressionResistance çš„ä¼˜å…ˆçº§åŽ‹ç¼© arrangedSubview alignmentï¼šå­æŽ§ä»¶å¯¹å…¶æ–¹å¼ï¼Œç±»ä¼¼UIlabelçš„textAlignmentï¼Œæ˜¯ä¸€ä¸ªæžšä¸¾å€¼ã€‚ 12345678910typedef enum UIStackViewAlignment : NSInteger &#123; UIStackViewAlignmentFill, UIStackViewAlignmentLeading, UIStackViewAlignmentTop = UIStackViewAlignmentLeading, UIStackViewAlignmentFirstBaseline, UIStackViewAlignmentCenter, UIStackViewAlignmentTrailing, UIStackViewAlignmentBottom = UIStackViewAlignmentTrailing, UIStackViewAlignmentLastBaseline&#125; UIStackViewAlignment; UIStackViewAlignmentFillï¼šé»˜è®¤æ–¹å¼ï¼Œ å¦‚æžœå­æŽ§ä»¶æ°´å¹³å¸ƒå±€, åˆ™æŒ‡å­æŽ§ä»¶çš„åž‚ç›´æ–¹å‘å¡«å……æ»¡stackView. åä¹‹äº¦ç„¶ UIStackViewAlignmentLeadingï¼šå¦‚æžœå­æŽ§ä»¶ç«–ç›´å¸ƒå±€, åˆ™æŒ‡å­æŽ§ä»¶å·¦è¾¹å¯¹é½stackViewå·¦è¾¹. åä¹‹äº¦ç„¶, å³ UIStackViewAlignmentTop = UIStackViewAlignmentLeadingã€‚ UIStackViewAlignmentTop = UIStackViewAlignmentLeading â€‹ UIStackViewAlignmentFirstBaselineï¼šæ ¹æ®ä¸Šæ–¹åŸºçº¿å¸ƒå±€æ‰€æœ‰å­è§†å›¾çš„yå€¼ â€‹ UIStackViewAlignmentCenterï¼šä¸­å¿ƒå¯¹é½ â€‹ UIStackViewAlignmentTrailingï¼šå¦‚æžœå­æŽ§ä»¶ç«–ç›´å¸ƒå±€, åˆ™æŒ‡å­æŽ§ä»¶å·¦è¾¹å¯¹é½stackViewå³è¾¹. åä¹‹äº¦ç„¶, å³UIStackViewAlignmentBottom = UIStackViewAlignmentTrailing â€‹ UIStackViewAlignmentBottom = UIStackViewAlignmentTrailing â€‹ UIStackViewAlignmentLastBaselineï¼šæ ¹æ®ä¸‹æ–¹åŸºçº¿å¸ƒå±€æ‰€æœ‰å­è§†å›¾çš„yå€¼]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>UIæ–°ç‰¹æ€§</tag>
        <tag>UIStackView</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS11æ–°ç‰¹æ€§]]></title>
    <url>%2F2017%2F10%2F21%2FiOS%E6%96%B0%E7%89%B9%E6%80%A7%E5%8F%8A%E9%80%82%E9%85%8D%2F</url>
    <content type="text"><![CDATA[iOS 11.0 æ–°ç‰¹æ€§1.UIViewController 2.UIScrollView 3.UINavigationBar 4.UITableViewå‚è€ƒè¿žæŽ¥ 1 å‚è€ƒè¿žæŽ¥ 2 iOS 11.0 é€‚é…å‚è€ƒè¿žæŽ¥ 1 å‚è€ƒè¿žæŽ¥ 2 iPhone X é€‚é… iOS 10.0 æ–°ç‰¹æ€§å’Œé€‚é…å‚è€ƒè¿žæŽ¥ 1 iOS 9.0 æ–°ç‰¹æ€§å’Œé€‚é…iOS9.0é€‚é…å‚è€ƒ]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>æ–°ç‰¹æ€§</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[iOS 9æ–°ç‰¹æ€§åŠç›¸å…³å˜åŒ–]]></title>
    <url>%2F2017%2F06%2F21%2FiOS%209%E3%80%8110%E3%80%8111%E6%96%B0%E7%89%B9%E6%80%A7%2F</url>
    <content type="text"><![CDATA[1.iOS 9æ–°ç‰¹æ€§åŠç›¸å…³å˜åŒ–æ–°æ·»åŠ 1.1 Contactsã€ContactsUI iOS9ä¹‹å‰ï¼š AddressBookUI.frameworkï¼šæä¾›äº†è”ç³»äººåˆ—è¡¨ç•Œé¢ã€è”ç³»äººè¯¦æƒ…ç•Œé¢ã€æ·»åŠ è”ç³»äººç•Œé¢ç­‰ ä¸€èˆ¬ç”¨äºŽé€‰æ‹©è”ç³»äºº AddressBook.frameworkï¼šçº¯Cè¯­è¨€çš„API,ä»…ä»…æ˜¯èŽ·å¾—è”ç³»äººæ•°æ®æ²¡æœ‰æä¾›UIç•Œé¢å±•ç¤º,éœ€è¦è‡ªå·±æ­å»ºè”ç³»äººå±•ç¤ºç•Œé¢ iOS9ä¹‹åŽï¼š Contacts.frameworkå’ŒContactsUI.frameworkè¿™2ä¸ªæ–°çš„é¢å‘å¯¹è±¡çš„åº“å–ä»£äº†ä¹‹å‰çš„Address Bookä¸ŽAddress Book UI frameworksæ¥å¯¹é€šè®¯å½•è¿›è¡Œç›¸å…³æ“ä½œã€‚ 1.2 CoreSpotlight åœ¨iOS9ä¹‹å‰ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡Spotlightä¸­è¾“å…¥å…³é”®å­—æ¥æŸ¥æ‰¾Appã€‚åœ¨iOS9ä¸­Appleéšä¹‹å‘å¸ƒäº†ä¸€å¥—å…¨æ–°çš„iOS9 Search APIsä¹‹åŽï¼Œå¼€å‘è€…ä¸ä½†å¯ä»¥è‡ªç”±çš„å°†Appçš„éƒ¨åˆ†å†…å®¹å»ºç«‹ç´¢å¼•ï¼Œè¿˜èƒ½å¯¹Spotlightä¸Šçš„æœç´¢ç»“æžœä»¥åŠç‚¹å‡»ä¸åŒçš„ç»“æžœæ˜¾ç¤ºçš„å†…å®¹è¿›è¡Œè®¾ç½®ã€‚ 1.3 GameplayKitæ¸¸æˆå¼€å‘ç›¸å…³ï¼šGamePlayKitæ˜¯ä¸€ä¸ªå¸®åŠ©æ–°æ‰‹å¼€å‘è€…ä»¬åœ¨OS Xå’ŒiOSå¹³å°åˆ›ä½œæ¸¸æˆçš„åŸºç¡€å·¥å…·å’ŒæŠ€æœ¯æ¡†æž¶ï¼Œå¯æä¾›æ¸¸æˆèµ„æºã€æ¨¡å—ã€çŽ©æ³•è®¾è®¡ä»¥åŠç³»ç»Ÿè§„åˆ™æ–¹é¢çš„å†…å®¹ã€‚ 1.4 MetalKitAppleä¸ºæ¸¸æˆå¼€å‘è€…æŽ¨å‡ºäº†æ–°çš„å¹³å°æŠ€æœ¯ Metalï¼Œè¯¥æŠ€æœ¯èƒ½å¤Ÿä¸º 3D å›¾åƒæé«˜ 10 å€çš„æ¸²æŸ“æ€§èƒ½ï¼Œå¹¶æ”¯æŒå¤§å®¶ç†Ÿæ‚‰çš„æ¸¸æˆå¼•æ“ŽåŠå…¬å¸ã€‚ 1.5 MetalPerformanceShadersMetalPerformanceShadersæ˜¯appleæŽ¨å‡ºçš„ä¸€å¥—é€šè¿‡metalæ¥åœ¨iosä¸Šå®žçŽ°æ·±åº¦å­¦ä¹ çš„å·¥å…·ã€‚ 1.6 ModelIOModel I/Oæ˜¯ç”¨å¤„ç†3Dèµ„æºå’Œæ•°æ®çš„æ¡†æž¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Model I/Oå¿«é€Ÿåœ°åŠ è½½å’Œå¯¼å‡º3Dèµ„æºæ–‡ä»¶ã€‚å®ƒé›†æˆåœ¨Xcodeé‡Œé¢å¹¶ä¸”å’Œå¯ä»¥éžå¸¸å®¹æ˜“åœ°ä¸ŽGameKit APIé…åˆã€‚ 1.7 ReplayKitæä¾›å½•å±åŠŸèƒ½çš„ä¸€å¥—å…¨æ–°æ¡†æž¶ï¼Œå®ƒå¯ä»¥è®©çŽ©å®¶æ›´ä¾¿æ·åœ°è®°å½•æ¸¸æˆæˆ–è€…åº”ç”¨çš„ç”»é¢ï¼Œå½•åˆ¶è‡ªå·±çš„å£°éŸ³ã€‚ReplayKitä¸ºç”¨æˆ·æˆ–è€…çŽ©å®¶æä¾›äº†ä¸€ä¸ªå…¨åŠŸèƒ½çš„äº¤äº’ç•Œé¢ï¼Œç”¨æˆ·å¯ç”¨å®ƒæ¥ç¼–è¾‘æˆ–åˆ¶ä½œè‡ªå·±çš„è§†é¢‘å‰ªè¾‘ã€‚ReplayKitä¸éœ€è¦å¤ªå¤§ç”µé‡æŸè€—å’Œæ€§èƒ½æŸè€—å°±å¯ä»¥äº§å‡ºé«˜æ¸…çš„è§†é¢‘è®°å½•ã€‚ å…³äºŽ ReplayKit 1.8 WatchConnectivityWatchConnectivity.frameworkæä¾›iPhoneå’Œä¸Žä¹‹é…å¯¹çš„Apple Watchä¹‹é—´è¿›è¡ŒåŒå‘çš„æ–‡ä»¶ã€æ•°æ®ä¼ è¾“ã€‚è¿™å¥—æ¡†æž¶èƒ½å¤Ÿè®©é…å¯¹çš„ä¸¤ä¸ªè®¾å¤‡ä¸ŠåŒæ—¶è¿è¡Œçš„Appè¿›è¡Œå³æ—¶é€šä¿¡ï¼Œä¹Ÿå¯ä»¥è¿›è¡ŒåŽå°é€šä¿¡ã€‚ 1.9 å…³äºŽUIKit1.9.1 æ–°æ·»åŠ  UIApplicationShortcutItem 3DTouchå¼€å‘ç›¸å…³çš„ç±»ï¼Œä»–æ˜¯ä¸€ä¸ªæ•°ç»„ç±»åž‹ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è¡¨ç¤ºä¸€ä¸ªå…¥å£æ ‡ç­¾ã€‚å¯åœ¨plistçš„æ–‡ä»¶ä¸­é…ç½®æ¯ä¸€ä¸ªitemç›¸å…³çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥åœ¨ä»£ç é‡Œé…ç½®ï¼Œä½†æ˜¯åœ¨ä»£ç é‡Œé…ç½®çš„è¯ï¼Œ3DTouchå¼¹å‡ºçš„æ ‡ç­¾ç”Ÿæ•ˆæ˜¯åœ¨ä¸€æ¬¡å¯åŠ¨ä¹‹åŽã€‚ NSDataAsset è®¿é—®ç”¨ç‰¹å®šæ ¼å¼å­˜å‚¨åœ¨asset catalogé‡Œé¢çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨äºŽæ“ä½œassets.xcassetsæ–‡ä»¶çš„ã€‚ NSLayoutAnchor appleçš„è§£é‡Šä¸ºï¼š The NSLayoutAnchor class is a factory class for creating NSLayoutConstraint objects using a fluent API. Use these constraints to programatically define your layout using Auto Layout NSLayoutAnchoræ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºŽåˆ›å»ºNSLayoutConstraintçš„å·¥åŽ‚ç±»ï¼Œå…¶APIç®€æ˜Žï¼Œæµç•…ã€‚åˆ©ç”¨æ‰€åˆ›å»ºçš„çº¦æŸï¼Œä»¥ä»£ç çš„å½¢å¼æ­å»ºä½¿ç”¨è‡ªåŠ¨å¸ƒå±€æŠ€æœ¯çš„ç•Œé¢ã€‚ å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è®¾ç½®çº¦æŸæ—¶æ˜¯æ“ä½œNSLayoutAnchorçš„å­ç±»ã€‚ NSLayoutYAxisAnchor: Yè½´çº¦æŸã€‚ NSLayoutXAxisAnchorï¼šXè½´çº¦æŸã€‚ NSLayoutDimensionï¼šç•Œé¢çº¦æŸï¼Œå¦‚å®½å’Œé«˜ã€‚ ä»£ç æ·»åŠ çº¦æŸåœ¨iOS9ä¹‹å‰ç›¸å½“ç¹çï¼Œä¹Ÿè®¸æ˜¯appleæ”¶åˆ°ç¬¬ä¸‰æ–¹æ¡†æž¶çš„é¼“èˆžï¼Œåœ¨iOS9ä¸­åŠ å…¥äº†NSLayoutAnchoræ¥ç®€åŒ–ä»£ç è‡ªåŠ¨å¸ƒå±€çš„æ–¹å¼ï¼Œä»¥ä¸‹ç¤ºä¾‹æ˜¯æ·»åŠ ç›¸åŒçš„çº¦æŸä½¿ç”¨NSLayoutConstraintå’ŒNSLayoutAnchorçš„å¯¹æ¯”ï¼š 12345678910111213141516171819202122232425&gt; // Creating constraints using NSLayoutConstraint&gt; [NSLayoutConstraint&gt; constraintWithItem:subview&gt; attribute:NSLayoutAttributeLeading&gt; relatedBy:NSLayoutRelationEqual&gt; toItem:self.view&gt; attribute:NSLayoutAttributeLeadingMargin&gt; multiplier:1.0&gt; constant:0.0].active = YES;&gt; &gt; [NSLayoutConstraint&gt; constraintWithItem:subview&gt; attribute:NSLayoutAttributeTrailing&gt; relatedBy:NSLayoutRelationEqual&gt; toItem:self.view&gt; attribute:NSLayoutAttributeTrailingMargin&gt; multiplier:1.0&gt; constant:0.0].active = YES;&gt; &gt; // Creating the same constraints using Layout Anchors&gt; UILayoutGuide *margin = self.view.layoutMarginsGuide;&gt; &gt; [subview.leadingAnchor constraintEqualToAnchor:margin.leadingAnchor].active = YES;&gt; [subview.trailingAnchor constraintEqualToAnchor:margin.trailingAnchor].active = YES;&gt; â€‹ UIBarButtonItemGroup iPadé”®ç›˜å¿«æ·æ ä¸Šçš„ä¸€ç»„æŒ‰é’®çš„é›†åˆ UIFieldBehavior ç‰©ç†æ•ˆæžœç›¸å…³çš„ç±»ï¼ŒiOS9ä¸­åŒ…å«ä»¥ä¸‹ç±»åž‹çš„behavioursï¼š Linear Gravity Radial Gravity Noise Custom UIFieldBehavior UILayoutGuide UILayoutGuideæ˜¯ iOS 9 ä¸­å¢žåŠ çš„å¸®åŠ©å¼€å‘è€…åœ¨ä½¿ç”¨auto layoutå¸ƒå±€æ—¶çš„ä¸€ä¸ªè™šæ‹Ÿå ä½å¯¹è±¡ã€‚å®ƒæ›´è½»é‡ã€æ›´å¿«é€Ÿã€æ›´é«˜æ•ˆã€‚UILayoutGuideå¹¶æ²¡æœ‰çœŸæ­£çš„åˆ›å»ºä¸€ä¸ªViewï¼Œåªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªçŸ©å½¢ç©ºé—´ï¼Œåªåœ¨è¿› autolayoutæ—¶å‚ä¸Žè¿›æ¥è®¡ç®—ã€‚ å‚è€ƒ æ˜¯æ—¶å€™äº†è§£ä¸€ä¸‹UILayoutGuideäº† UIRegion When creating animations, you use regions to define the effective area of a field behavior such as a magnetic or gravitational force. Most regions are rectangular or elliptical in shape, but you can use the methods of this class to create more complex shapes by adding, subtracting, and intersecting other regions. åœ¨åˆ›å»ºç£åŠ›æˆ–è€…å¼•åŠ›çš„æ•ˆæžœåŠ¨ç”»çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨regionsåŽ»å®šä¹‰å®ƒçš„æœ‰æ•ˆä½œç”¨èŒƒå›´ã€‚ä½†æ˜¯ï¼Œå¤§å¤šæ•°çš„regionsæ˜¯æ¤­åœ†æˆ–è€…çŸ©å½¢å½¢çŠ¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨UIRegionåŽ»è‡ªå®šä¹‰æ›´ä¸ºå¤æ‚çš„å½¢çŠ¶ï¼Œæ¯”å¦‚å¢žåŠ æˆ–è€…è£å‰ªå…¶ä¸­çš„éƒ¨åˆ†åŒºåŸŸã€‚ UIStackView UIStackViewç±»å¯ä»¥å¸®æˆ‘ä»¬å¸ƒå±€UIæŽ§ä»¶ï¼Œè€Œæˆ‘ä»¬ä¸éœ€è¦è®¾ç½®ä»»ä½•çº¦æŸæˆ–è®¾ç½®å¾ˆå°‘çš„çº¦æŸå°±å¯ä»¥ï¼Œå…¶ä»–éƒ½ç”±UIStackViewå¸®æˆ‘ä»¬è‡ªåŠ¨å®Œæˆäº† 1.9.2 å¸¸ç”¨UIæ”¹åŠ¨ UITabBarItem.h : åˆ é™¤äº† [UITabBarItem setTitlePositionAdjustment:]UITableView.h : æ–°å¢ž UITableView.cellLayoutMarginsFollowReadableWidthUITouch : æ–°å¢ž UITouch.force ã€ UITouch.maximumPossibleForceã€UIForceTouchCapabilityã€UIForceTouchCapabilityAvailableã€UIForceTouchCapabilityUnavailableã€UIForceTouchCapabilityUnknownUIView : åˆ é™¤ -[UIView setTranslatesAutoresizingMaskIntoConstraints:]UIViewController æ–°å¢žéƒ¨åˆ†æ–¹æ³•UIEvent.h : æ–°æ·»åŠ [UIEvent coalescedTouchesForTouch:]ã€ [UIEvent predictedTouchesForTouch:]UICollectionViewLayout ï¼šæ–°æ·»åŠ éƒ¨åˆ†æ–¹æ³•UICollectionView ï¼šæ–°æ·»åŠ éƒ¨åˆ†æ–¹æ³•NSAttributedString ï¼šæ–°æ·»åŠ éƒ¨åˆ†åˆ†ç±» 1.9.3 Foundation æ–°æ·»åŠ  NSPersonNameComponents.h NSPersonNameComponentsFormatter.hNString : æ·»åŠ äº†éƒ¨åˆ†æ–¹æ³•NSURL : æ·»åŠ äº†éƒ¨åˆ†æ–¹æ³•NSURLSession s 1.10 æ–°ç‰¹æ€§1.10.1 URL Scheme é€‚é…_å¼•å…¥ç™½åå•æ¦‚å¿µåœ¨iOS9ä¸­ï¼Œè‹¥è¦é€šè¿‡URL Schemeè®¿é—®å…¶ä»–APPï¼Œåˆ™éœ€è¦äº‹å…ˆå°†è¯¥URLåŠ å…¥ç¨‹åºçš„ç™½åå•ä¸­ã€‚ è¿™ä¸ªURL Schemeæœºåˆ¶çš„æ”¹å˜ä¸»è¦å½±å“äº†ä¸¤ä¸ªapiï¼šcanOpenURLå’ŒopenURLã€‚åœ¨iOS9ä»¥å‰ï¼Œå¦‚æžœè¦åˆ¤æ–­ç³»ç»Ÿä¸­æœ‰æ²¡æœ‰APPèƒ½å¤Ÿå¤„ç†ç›¸åº”çš„URLï¼Œç›´æŽ¥è°ƒç”¨canOpenURLå°±å¯ä»¥äº†ï¼ŒopenURLåŒç†ã€‚è€Œåœ¨iOS9ä¹‹åŽï¼Œè‹¥è¦è®¿é—®æŸä¸ªURLï¼Œåˆ™å¿…é¡»åœ¨ç¨‹åºçš„info.plistä¸­æŠŠè®¿é—®çš„URLæå‰è®¾ç½®å¥½ï¼Œå°†å…¶åŠ å…¥ç™½åå•ä¸­ï¼Œæ‰èƒ½å¤Ÿé¡ºåˆ©ä½¿ç”¨canOpenURLå’ŒopenURLï¼Œå¦åˆ™ï¼Œç³»ç»Ÿä¼šæ‹’ç»è®¿é—®ï¼Œç›´æŽ¥è¿”å›žNOã€‚ 1.10.2 ç½‘ç»œé€‚é…_ATSï¼šæ”¹ç”¨æ›´å®‰å…¨çš„HTTPSiOS9ä¸­å‘é€ä¸€ä¸ªhttpè¯·æ±‚ä¼šæŠ¥ä»¥ä¸‹é”™è¯¯ 12&gt; The resource could not be loaded because the App Transport Security policy requires the use of a secure connection.&gt; ATSå…¨ç§°ä¸ºApp Transport Securityã€‚ä¸ºäº†æé«˜iOSè®¾å¤‡ä¸ŽæœåŠ¡å™¨äº¤äº’çš„å®‰å…¨æ€§ï¼Œappleçš„ATSä¼šé˜»æ­¢æœªæ³¨å†Œçš„ç½‘ç»œè¯·æ±‚ï¼Œæ‰€ä»¥æœåŠ¡ç«¯éœ€è¦é€‚é…httpsã€‚å½“ç„¶APPå½“ä¸­å¯èƒ½å­˜åœ¨ä¸€äº›ç¬¬ä¸‰æ–¹åº“æœ‰httpè¯·æ±‚ï¼Œè¿™æ—¶å€™éœ€è¦å°†è¿™äº›è¯·æ±‚åŠ å…¥ç™½åå•ã€‚ 1.10.3 Bitcodebitcode æ˜¯è¢«ç¼–è¯‘ç¨‹åºçš„ä¸€ç§ä¸­é—´å½¢å¼çš„ä»£ç ã€‚åŒ…å« bitcode é…ç½®çš„ç¨‹åºå°†ä¼šåœ¨ App Store ä¸Šè¢«ç¼–è¯‘å’Œé“¾æŽ¥ã€‚ bitcode å…è®¸è‹¹æžœåœ¨åŽæœŸé‡æ–°ä¼˜åŒ–æˆ‘ä»¬ç¨‹åºçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦æˆ‘ä»¬é‡æ–°æäº¤ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬åˆ° App Store ä¸Šã€‚ ä½¿ç”¨bitcodeè¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ Xcode 7é»˜è®¤å¼€å¯ Bitcode ï¼Œå¦‚æžœåº”ç”¨å¼€å¯ Bitcodeï¼Œé‚£ä¹ˆå…¶é›†æˆçš„å…¶ä»–ç¬¬ä¸‰æ–¹åº“ä¹Ÿéœ€è¦æ˜¯ Bitcode ç¼–è¯‘çš„åŒ…æ‰èƒ½çœŸæ­£è¿›è¡Œ Bitcode ç¼–è¯‘ å¼€å¯ Bitcode ç¼–è¯‘åŽï¼Œç¼–è¯‘äº§ç”Ÿçš„ .app ä½“ç§¯ä¼šå˜å¤§(ä¸­é—´ä»£ç ï¼Œä¸æ˜¯ç”¨æˆ·ä¸‹è½½çš„åŒ…)ï¼Œä¸” .dSYMæ–‡ä»¶ä¸èƒ½ç”¨æ¥å´©æºƒæ—¥å¿—çš„ç¬¦å·åŒ–(ç”¨æˆ·ä¸‹è½½çš„åŒ…æ˜¯ Apple æœåŠ¡é‡æ–°ç¼–è¯‘äº§ç”Ÿçš„ï¼Œæœ‰äº§ç”Ÿæ–°çš„ç¬¦å·æ–‡ä»¶)ã€‚ é€šè¿‡ Archive æ–¹å¼ä¸Šä¼  AppStore çš„åŒ…ï¼Œå¯ä»¥åœ¨Xcodeçš„Organizerå·¥å…·ä¸­ä¸‹è½½å¯¹åº”å®‰è£…åŒ…çš„æ–°çš„ç¬¦å·æ–‡ä»¶ 2.iOS 10æ–°ç‰¹æ€§åŠç›¸å…³å˜åŒ–æ–°æ·»åŠ 2.1 CallKit ä¸ä»…è®©VoIPåº”ç”¨å…·æœ‰ç³»ç»Ÿç”µè¯ä¸€æ ·çš„åŠŸèƒ½ï¼Œè¿˜èƒ½å¸®åŠ©ç³»ç»Ÿå®žçŽ°æ¥ç”µè¯†åˆ«ç­‰åŠŸèƒ½ï¼›ä½†æœ¬èº«å¹¶ä¸å…·å¤‡voipåŠŸèƒ½ åŽå°æˆ–é”å±æ—¶ç›´æŽ¥é€šè¿‡ç³»ç»Ÿç”µè¯ç•Œé¢æŽ¥ç®¡VoIPè¯­éŸ³æ¥ç”µï¼Œå¹¶æ›´æ–°å›žè°ƒç”µè¯æ“ä½œåˆ°app å…³äºŽCallKit 2.2 Intents &amp; IntentsUIä¹‹æ‰€ä»¥æŠŠè¿™ä¸¤ä¸ªæ¡†æž¶æ”¾åˆ°ä¸€èµ·ï¼Œæ˜¯å› ä¸ºä»–ä»¬å’ŒSiriKitæœ‰å¾ˆå¤§çš„ç›¸å…³æ€§ã€‚ SiriKit ä¸ºæˆ‘ä»¬æä¾›ä¸€å…¨å¥—ä»Žè¯­éŸ³è¯†åˆ«åˆ°ä»£ç å¤„ç†ï¼Œæœ€åŽå‘ç”¨æˆ·å±•ç¤ºç»“æžœçš„æµç¨‹ã€‚Apple åŠ å…¥äº†ä¸€å¥—å…¨æ–°çš„æ¡†æž¶ Intents.framework æ¥è¡¨ç¤º Siri èŽ·å–å¹¶è§£æžçš„ç»“æžœã€‚ä½ çš„åº”ç”¨éœ€è¦æä¾›ä¸€äº›å…³é”®å­—è¡¨æ˜Žå¯ä»¥æŽ¥å—ç›¸å…³è¾“å…¥ï¼Œè€Œ Siri æ‰©å±•åªéœ€è¦ç›‘å¬ç³»ç»Ÿè¯†åˆ«çš„ç”¨æˆ·æ„å›¾ (intent)ï¼Œä½œå‡ºåˆé€‚çš„å“åº”ï¼Œä¿®æ”¹ä»¥åŠå®žé™…æ“ä½œï¼Œæœ€åŽé€šè¿‡ IntentsUI.framework æä¾›åé¦ˆã€‚æ•´ä¸ªè¿‡ç¨‹éžå¸¸æ¸…æ™°æ˜Žäº†ï¼Œä½†æ˜¯è¿™ä¹Ÿæ„å‘³ç€å¼€å‘è€…æ‰€èƒ½æ‹¥æœ‰çš„è‡ªç”±åº¦æœ‰é™ã€‚ 2.3 MetalKit ä¸€ä¸ªä¸ºè®¡ç®—æœºGPUç¼–ç¨‹çš„æŽ¥å£ æä¾›æœ€åº•å±‚çš„GPUè®¿é—®æŽ¥å…¥,å› æ­¤å®ƒå°†å‡å°‘å…¶ä»–æ¡†æž¶ä¸­ç”±äºŽåœ¨CPUå’ŒGPUä¹‹é—´ä¼ é€’æ•°æ®è€Œç»å¸¸å¼•èµ·çš„æ€§èƒ½ç“¶é¢ˆ. æä¾›ç›¸æ¯”OpenGLé«˜è¾¾10å€çš„ç»˜åˆ¶è°ƒç”¨.ç„¶è€Œ,Metalå¹¶ä¸èƒ½åƒOpenGLä¸€æ ·è·¨å¹³å°,æ‰€ä»¥å®ƒå¹¶ä¸èƒ½æ›¿ä»£OpenGL. å…³äºŽMetalKit 2.4 Messagesä¸€å¥—ç”¨æ¥å¼€å‘Message Appçš„æ¡†æž¶ï¼Œåˆ†ä¸ºç‹¬ç«‹åº”ç”¨å’Œæ‰©å±•ä¸¤ç§ã€‚å…·ä½“ä½¿ç”¨æ–¹æ³•å¯å‚è€ƒæ–‡ç«  iOS10ä¸­Messagesç‹¬ç«‹åº”ç”¨ä¸Žæ‰©å±•æ’ä»¶è¯¦æž 2.5 Speechè¯­éŸ³è¯†åˆ«æ¡†æž¶ï¼Œå¯ç”¨æ¥å®žçŽ°è¯­éŸ³ä¸Žæ–‡æœ¬çš„ç›¸äº’è½¬åŒ–ã€‚å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š å¯ä»¥å®žçŽ°è¿žç»­çš„è¯­éŸ³è¯†åˆ« å¯ä»¥å¯¹è¯­éŸ³æ–‡ä»¶æˆ–è€…è¯­éŸ³æµè¿›è¡Œè¯†åˆ« æœ€ä½³åŒ–è‡ªç”±æ ¼å¼çš„å¬å†™(å¯ç†è§£ä¸ºå¤šè¯­è¨€æ”¯æŒ)å’Œæœç´¢å¼çš„å­—ç¬¦ä¸² Speechå®˜æ–¹æ–‡æ¡£ 2.6 UserNotificationsiOS10ä¸­Appleå¯¹ä»¥å¾€Notificationçš„APIè¿›è¡Œäº†ä¸€æ¬¡å¤§çš„é‡æž„ï¼ŒçŽ°åœ¨å¯ä»¥ä½¿ç”¨ç‹¬ç«‹çš„ UserNotifications.framework æ¥é›†ä¸­ç®¡ç†å’Œä½¿ç”¨ iOS ç³»ç»Ÿä¸­é€šçŸ¥çš„åŠŸèƒ½ï¼Œè¿™å…¶ä¸­æ•´åˆäº†æœ¬åœ°é€šçŸ¥ä¸ªè¿œç¨‹é€šçŸ¥ï¼Œå¹¶å¢žåŠ äº†ä¸€ç³»åˆ—çš„åŠŸèƒ½ï¼š æ’¤å›žå•æ¡é€šçŸ¥ æ›´æ–°å·²å±•ç¤ºé€šçŸ¥ ä¸­é€”ä¿®æ”¹é€šçŸ¥å†…å®¹ åœ¨é€šçŸ¥ä¸­å±•ç¤ºå›¾ç‰‡è§†é¢‘ è‡ªå®šä¹‰é€šçŸ¥ UI è¯¦æƒ…å‚è€ƒå–µç¥žæ–‡ç«  æ´»ä¹…è§çš„é‡æž„ - iOS 10 UserNotifications æ¡†æž¶è§£æž 2.7 UserNotificationsUI Customize the interface used to display local and remote notifications. è‡ªå®šä¹‰æœ¬åœ°æˆ–è¿œç¨‹é€šçŸ¥UIå±•ç¤ºç•Œé¢ 2.8 å¢žåŠ ç›¸å…³ç³»ç»Ÿæƒé™å¼€å¯ï¼Œéœ€è¦info.plistä¸­é…ç½®ç›¸åº”çš„keyåœ¨iOS10ç³»ç»Ÿä¸­ï¼Œå¦‚æžœä¸åšé¢å¤–è®¾ç½®ï¼Œç›´æŽ¥è°ƒç”¨ç³»ç»Ÿç›¸å†Œç›¸æœºç­‰æƒé™ï¼Œä¼šå‡ºçŽ°ä»¥ä¸‹å´©æºƒ This app has crashed because it attempted to accessprivacy-sensitive data without a usage description. The appâ€™sInfo.plist must contain an NSPhotoLibraryUsageDescription key with astring value explaining to the user how the app uses this data. éœ€è¦åœ¨Plistæ–‡ä»¶ä¸­æ·»åŠ ç›¸å…³æƒé™æè¿°ï¼Œä¸ä½œèµ˜è¿°ã€‚ 2.9 UIKitç›¸å…³å˜åŒ–æ–°æ·»åŠ çš„UI UIAccessibilityCustomRotor ä¸€ç§ä¸Šä¸‹æ–‡ç›¸å…³åŠŸèƒ½ï¼Œå¯å¸®åŠ©Voice Overç”¨æˆ·æ‰¾åˆ°ç›¸å…³å…ƒç´ çš„ä¸‹ä¸€ä¸ªå®žä¾‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤ç±»çš„å®žä¾‹æ¥æŸ¥æ‰¾æ–‡ç« ä¸­çš„ä¸‹ä¸€ä¸ªé“¾æŽ¥æˆ–æ–‡æ¡£ä¸­çš„ä¸‹ä¸€ä¸ªæ‹¼å†™é”™è¯¯çš„å•è¯ UICloudSharingController iClouldç›¸å…³ï¼Œç”¨äºŽå¢žåŠ å’Œåˆ é™¤CloudKitå…±äº«è®°å½•ä¸­çš„æˆå‘˜ UIContentSizeCategory å®˜æ–¹æ–‡æ¡£ä»‹ç»ä¸ºâ€œConstants indicating the preferred size of your contentâ€ï¼Œç›¸å…³èµ„æ–™å¤ªå°‘ï¼Œæ²¡æ€Žä¹ˆå¼„æ˜Žç™½ã€‚ä¼°è®¡å’Œæ–‡æœ¬å­—ä½“è®¾ç½®æœ‰å…³ã€‚ UIContentSizeCategoryAdjusting å¯ä»¥ä½¿æŽ§ä»¶è½»æ¾å®žçŽ°å¯¹å†…å®¹ç±»åˆ«æ›´æ”¹çš„è‡ªåŠ¨è°ƒæ•´çš„æ–¹æ³•ç»„åˆã€‚é€‚ç”¨äºŽUILabelã€UITextFieldã€UITextView UIFeedbackGenerator å½“æˆ‘ä»¬ä½¿ç”¨iPhone 7ä»¥ä¸Šçš„è®¾å¤‡æ»šåŠ¨ä¸€ä¸ªUIPickerViewçš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šç»™æˆ‘ä»¬ä¸€ä¸ªéœ‡åŠ¨åé¦ˆç”¨æ¥å¢žå¼ºç”¨æˆ·ä½“éªŒã€‚UIFeedbackGeneratoræ˜¯æ‰€æœ‰åé¦ˆäº§ç”Ÿå™¨çš„æŠ½è±¡ç±»ã€‚ä¸è¦è‡ªå·±åˆ›å»ºè¯¥ç±»çš„å®žä¾‹æˆ–è€…å­ç±»ï¼Œåº”è¯¥ä½¿ç”¨å·²ç»æä¾›çš„å­ç±»ï¼š UIImpactFeedbackGenerator .ä½¿ç”¨ç¢°æ’žåé¦ˆå‘ç”Ÿå™¨æ¥è¡¨æ˜Žå‘ç”Ÿäº†ç¢°æ’žã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“ç”¨æˆ·ç•Œé¢ä¸Šçš„ä¸€ä¸ªå¯¹è±¡ç¢°åˆ°ä»€ä¹ˆä¸œè¥¿ã€æˆ–è€…å¡åˆ°æŸä¸ªåœ°æ–¹çš„æ—¶å€™ï¼Œè§¦å‘ç¢°æ’žåé¦ˆå‘ç”Ÿå™¨ã€‚ UISelectionFeedbackGenerator. ä½¿ç”¨é€‰æ‹©åé¦ˆå‘ç”Ÿå™¨æ¥è¡¨æ˜Žé€‰æ‹©çŠ¶æ€å‘ç”Ÿäº†æ”¹å˜ã€‚ UINotificationFeedbackGenerator. ä½¿ç”¨é€šçŸ¥åé¦ˆå‘ç”Ÿå™¨æ¥è¡¨æ˜ŽæˆåŠŸï¼Œå¤±è´¥ï¼Œè­¦å‘Šã€‚ UIFocusGuide UILayoutGuideçš„ä¸€ä¸ªå­ç±»,è¡¨ç¤ºä¸€ä¸ªä¸å¯è§çš„å¯èšç„¦åŒºåŸŸï¼Œå¯å°†ç„¦ç‚¹ç§»åŠ¨é‡å®šå‘åˆ°å…¶ä»–è§†å›¾. UIGraphicsRenderer åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯åˆ›å»ºä¸€ä¸ª image ä¸Šä¸‹æ–‡ï¼Œç„¶åŽåšä¸€äº›è‡ªå®šä¹‰çš„ç»˜å›¾æ“ä½œï¼ŒæŽ¥ç€èŽ·å–ä¸Šä¸‹æ–‡ä¸­çš„å›¾åƒå†…å®¹ï¼Œç„¶åŽç»“æŸè¿™ä¸ªä¸Šä¸‹æ–‡ï¼Œè¿™æ ·æ‰èƒ½èŽ·å–åˆ°å›¾ç‰‡ã€‚Apple æ–°å¢žäº†ç±» UIGraphicsRendererï¼Œå®ƒæ˜¯ block-basedã€full-color-managedï¼Œå¹¶ä¸”æ˜¯å¯ä»¥æ‹“å±•çš„æ–°çš„å›¾ç‰‡ç»˜åˆ¶ç±»ã€‚ä½¿ç”¨æ–¹æ³•æ›´ç®€å•ï¼š 123456UIImage *image = [renderer imageWithActions:^(UIGraphicsImageRendererContext * _Nonnull context) &#123; [[UIColor darkGrayColor] setStroke]; [context strokeRect:renderer.format.bounds]; [[UIColor colorWithRed:158/255.0 green:215/255.0 blue:245/255.0 alpha:1] setFill]; [context fillRect:CGRectMake(1, 1, 140, 140)]; &#125;]; UIPreviewInteraction æ³¨å†Œä¸€ä¸ªè§†å›¾æä¾›è‡ªå®šä¹‰ç”¨æˆ·ä½“ä»¥éªŒå“åº”3DTouchäº¤äº’çš„ç±»ã€‚å¸¸ç”¨æ–¹æ³•ï¼š 123- (instancetype)initWithView:(UIView *)view; //æ³¨å†Œè§†å›¾çš„åˆå§‹åŒ–æ–¹æ³•- (CGPoint)locationInCoordinateSpace:(id&lt;UICoordinateSpace&gt;)coordinateSpace; //è¿”å›žç”¨æˆ·å½“å‰æŒ‰åŽ‹å±å¹•çš„åæ ‡- (void)cancelInteraction; //åœæ­¢äº¤äº’ UITextInteraction æžšä¸¾ç±»åž‹ï¼Œç”¨æ¥è¯´æ˜Žç”¨æˆ·æœŸæœ›ä¸ŽURLæˆ–æ–‡æœ¬é™„ä»¶è¿›è¡Œäº¤äº’çš„ç±»åž‹çš„å¸¸é‡ 12345typedef enum UITextItemInteraction : NSInteger &#123; UITextItemInteractionInvokeDefaultAction, UITextItemInteractionPresentActions, UITextItemInteractionPreview&#125; UITextItemInteraction; â€‹ UIViewPropertyAnimator UIViewPropertyAnimator å¯ä»¥ç§°ä¸ºå±žæ€§åŠ¨ç”»å™¨ï¼Œæ˜¯iOS10ä¸­æ–°å¢žçš„ä¸€ä¸ªæ‰§è¡ŒViewåŠ¨ç”»çš„ç±»ï¼Œå®ƒä¸»è¦å…·æœ‰ä¸€ä¸‹çš„ç‰¹ç‚¹ï¼š å¯ä¸­æ–­æ€§ å¯æ“¦é™¤æ€§ å¯ç¿»è½¬æ€§ ä¸°å¯Œçš„æ—¶é—´åŠ¨ç”»æŽ§åˆ¶åŠŸèƒ½ UIViewAnimating å®žçŽ°è‡ªå®šä¹‰åŠ¨ç”»å¯¹è±¡çš„æŽ¥å£ç±» UITimingCurveProvider åè®®é‡æ–°å°è£…äº†æ—¶é—´å‡½æ•°ï¼Œæä¾›äº†åšåŠ¨ç”»æ‰€éœ€è¦çš„æ—¶é—´ä¿¡æ¯ UISpringTimingParameters å¼¹ç°§åŠ¨ç”»çš„æ—¶é—´ä¿¡æ¯ 2.10 Foundationç›¸å…³å˜åŒ–æ–°æ·»åŠ çš„API NSDateInterval è¡¨ç¤ºç‰¹å®šå¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸä¹‹é—´çš„æ—¶é—´èŒƒå›´çš„å¯¹è±¡ NSISO8601DateFormatter ä¸€ç§Formatterï¼Œç”¨ä»¥è½¬æ¢æ—¥æœŸå’Œä»–ä»¬çš„IOS 8601æ ‡å‡†å­—ç¬¦ä¸² NSMeasurement A numeric quantity labeled with a unit of measure, with support for unit conversion and unit-aware calculations å¤§æ¦‚æ„æ€æ˜¯ï¼šç”¨åº¦é‡å•ä½æ ‡è®°çš„æ•°å­—æ•°é‡ï¼Œæ”¯æŒå•ä½æ¢ç®—å’Œå•ä½æ„ŸçŸ¥è®¡ç®—ã€‚ç‰©ç†è®¡ç®—ç›¸å…³çš„ç±»ã€‚ NSMeasurementFormatter ä¸€ç§Formatterï¼Œæä¾›å•ä½å’Œåº¦é‡çš„æœ¬åœ°åŒ–è¡¨ç¤ºã€‚ NSUnit ä»£è¡¨åº¦é‡å•ä½çš„æŠ½è±¡ç±»ã€‚ 3. iOS 11æ–°ç‰¹æ€§åŠç›¸å…³å˜åŒ–æ–°æ·»åŠ çš„åº“3.1 Core MLiOSçš„æœºå™¨å­¦ä¹ æ¡†æž¶ï¼Œä¹Ÿå°±æ˜¯å½“ä»Šå¾ˆç«çš„AIçš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œé€šè¿‡å°†æœºå™¨æ¨¡åž‹è½¬ä¸ºCore ML å¯ä»¥ç†è§£çš„å½¢å¼ã€‚ 3.2 ARKitiOSè®¾å¤‡è™šæ‹ŸçŽ°å®žå¿…å¤‡æŠ€èƒ½ã€‚ 3.3 Core NFCiOS11ä¸­ï¼Œè‹¹æžœå¼€æ”¾äº†NFCæŽ¥å£ï¼Œä»€ä¹ˆæ˜¯NFCï¼Œè‡ªè¡ŒGoogle, å‰æ®µæ—¶é—´iPhoneå¯ä»¥åˆ·å…¬äº¤å¡å°±æ˜¯å€ŸåŠ©æ­¤æŠ€èƒ½ã€‚ ä¸»è¦å˜åŒ–3.4 UIViewControllertopLayoutGuide, bottomLayoutGuideè¿™2ä¸ªå±žæ€§è¢«æ ‡è®°ä¸ºè¿‡æœŸäº†ï¼Œä½†æ˜¯åœ¨Storyboardé‡Œè®¾ç½®çº¦æŸçš„æ—¶å€™ï¼Œè¿˜æ˜¯ä¼šå‡ºçŽ°è¿™2ä¸ªå±žæ€§ automaticallyAdjustsScrollViewInsetsè¿™ä¸ªå±žæ€§ä¹Ÿè¢«æ ‡è®°è¿‡æœŸäº†ï¼Œå¯ä»¥ä½¿ç”¨UIScrollViewçš„contentInsetAdjustmentBehavioræ›¿ä»£ 3.5 UIScrollViewæ–°å¢žcontentInsetAdjustmentBehaviorå±žæ€§æ›¿ä»£ä¹‹å‰UIViewControllerçš„automaticallyAdjustsScrollViewInsetsï¼Œä½œç”¨ç±»ä¼¼ï¼Œä¼šæ ¹æ®æŸäº›æƒ…å†µè‡ªåŠ¨è°ƒæ•´scrollviewçš„contentInsetï¼ˆå®žé™…æ”¹å˜çš„æ˜¯adjustedContentInsetå±žæ€§ï¼ŒcontentInsetå±žæ€§ä¸ä¼šå˜ï¼‰ æ–°å¢žsafeAreaInsets: UIEdgeInsetså±žæ€§åªè¯»å±žæ€§ï¼Œä¸ºäº†é…åˆcontentInsetAdjustmentBehaviorä½¿ç”¨ æ–°å¢žadjustedContentInset: UIEdgeInsetså±žæ€§åªè¯»å±žæ€§ï¼Œè¿™ä¸ªå±žæ€§ä¼šæ ¹æ®safeAreaInsetsçš„å˜åŒ–è€Œå˜åŒ–UIScrollViewDelegate æ–°å¢žscrollViewDidChangeAdjustedContentInsetï¼Œå½“adjustedContentInsetå˜åŒ–æ—¶ä¼šè°ƒç”¨UIScrollViewçš„è¿™å‡ ä¸ªInsetçš„æ”¹å˜éœ€è¦å¼•èµ·æ³¨æ„ï¼Œä»–æ”¹å˜äº†åŽŸæ¥çš„contentInsetçš„é€»è¾‘ï¼ˆæ¯”å¦‚çŽ°åœ¨contentInsetä¸ä¼šå—UINavigationBarçš„isTranslucentå½±å“äº†ï¼‰ï¼Œå¯èƒ½ä¼šå¯¹çŽ°æœ‰çš„é¡¹ç›®ä¸­çš„é¡µé¢å±•ç¤ºæœ‰å½±å“ï¼Œåœ¨é¡¹ç›®é€‚é…iOS11æ—¶éœ€è¦ç•™æ„ä¸‹ã€‚ 3.6 UINavigationBaræ–°å¢žprefersLargeTitles: Boolå±žæ€§å¤§æ ‡é¢˜ï¼Œé»˜è®¤ä¸ºfalseï¼Œå½“è®¾ç½®ä¸ºtrueæ—¶ï¼Œnavigation barä¼šæ˜¾ç¤ºå¤§æ ‡é¢˜ï¼Œå‘ä¸Šæ»‘åŠ¨é¡µé¢ï¼Œnavigation bar ä¼šå˜å°ç›´åˆ°æ˜¾ç¤ºæˆè·Ÿä¹‹å‰ä¸€æ ·ï¼ŒåŒæ—¶titleä½ç½®ä¼šå‘ç”Ÿå˜åŒ–navigationController?.navigationBar.prefersLargeTitles = true æ»šåŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æ‰“å°navigation bar çš„frameå‘çŽ°ï¼Œnavigation bar çš„é«˜åº¦ä¼šè·Ÿç€å˜åŒ–å¦‚æžœnavigation baræ˜¯é€æ˜Žçš„ï¼Œscrollviewçš„safeAreaInsetså±žæ€§ä¹Ÿä¼šè·Ÿç€å˜åŒ–å¤§æ¦‚å…³ç³»æ˜¯ï¼šsafeAreaInsets.top = navigationBar.frame.height+statusBar.height 3.7 UINavigationItemæ–°å¢žlargeTitleDisplayModeå±žæ€§è¿™ä¸ªå±žæ€§é…åˆnavigation barçš„å¤§æ ‡é¢˜ä½¿ç”¨çš„ã€‚å½“navigation barå¯ç”¨prefersLargeTitlesåŽï¼Œè¿™ä¸ªå±žæ€§æ‰ä¼šç”Ÿæ•ˆï¼Œå¯ä»¥æŽ§åˆ¶æŸä¸ªå•ç‹¬çš„ViewControllerä¸­çš„large titleæ˜¾ç¤ºæ¨¡å¼ 12345678typedef NS_ENUM(NSInteger, UINavigationItemLargeTitleDisplayMode) &#123; /// Automatically use the large out-of-line title based on the state of the previous item in the navigation bar. An item with largeTitleDisplayMode=Automatic will show or hide the large title based on the request of the previous navigation item. If the first item pushed is set to Automatic, then it will show the large title if the navigation bar has prefersLargeTitles=YES. UINavigationItemLargeTitleDisplayModeAutomatic, /// Always use a larger title when this item is top most. UINavigationItemLargeTitleDisplayModeAlways, /// Never use a larger title when this item is top most. UINavigationItemLargeTitleDisplayModeNever,&#125; NS_SWIFT_NAME(UINavigationItem.LargeTitleDisplayMode); automaticï¼šä¸Žä¸Šä¸€ä¸ªnavigation itemè®¾ç½®çš„largeTitleDisplayModeç›¸åŒ always: æ€»æ˜¯å¯ç”¨å¤§æ ‡é¢˜ã€‚åˆšå¼€å§‹æœ‰ä¸ªè¯¯è§£ï¼Œalwayså¹¶ä¸æ˜¯è¯´å½“scrollviewæ»šåŠ¨çš„æ—¶å€™ï¼Œnavigation barä¸€ç›´æ˜¯å¤§æ ‡é¢˜æ¨¡å¼ï¼Œè€Œæ˜¯æŒ‡ï¼Œä¸ç®¡ä¸Šä¸€ä¸ªviewcontrollerè®¾ç½®çš„æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸ªviewcontrolleréƒ½æ˜¯å¯ç”¨å¤§æ ‡é¢˜ neverï¼šæ€»æ˜¯æ˜¾ç¤ºå°æ ‡é¢˜æ¨¡å¼ï¼Œå°±æ˜¯æˆ‘ä»¬æ­£å¸¸çœ‹åˆ°çš„å¯¼èˆªæ æ ‡é¢˜æ ·å¼ æ–°å¢žsearchControllerå±žæ€§ æ–°å¢žhidesSearchBarWhenScrollingï¼šBoolå±žæ€§, é…åˆsearchControllerä½¿ç”¨çš„ï¼Œé»˜è®¤æ˜¯trueã€‚è¿™ä¸ªå±žæ€§æ˜¯æŽ§åˆ¶searchControlleré»˜è®¤æ˜¯å¦æ˜¾ç¤ºçš„ã€‚é€šè¿‡ä¸Šå›¾ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼ŒsearchBaré»˜è®¤æ˜¯éšè—çš„ï¼Œå½“ä¸‹æ‹‰çš„æ—¶å€™æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œå†ä¸Šæ‹‰åˆä¼šéšè—ã€‚å½“è®¾ç½®ä¸ºfalseæ—¶ï¼ŒsearchBarä¼šä¸€ç›´æ˜¾ç¤ºï¼Œå½“scrollviewä¸‹æ‹‰æ—¶ï¼ŒsearchBarä¼šéšç€scrollviewå¾€ä¸‹èµ°ï¼Œä¸Šæ‹‰æ—¶ï¼Œåˆ™å›ºå®šåœ¨é¡¶éƒ¨ä¸åŠ¨ã€‚ 3.8 UITableViewæ–°å¢žseparatorInsetReferenceå±žæ€§, åˆ†å‰²çº¿ç›¸å…³çš„ï¼Œæœ‰2ä¸ªå¯é€‰å€¼ï¼š 1234567typedef NS_ENUM(NSInteger, UITableViewSeparatorInsetReference) &#123; // The value set to the separatorInset property is interpreted as an offset from the edges of the cell. UITableViewSeparatorInsetFromCellEdges, // The value set to the separatorInset property is interpreted as an offset from the automatic separator insets. UITableViewSeparatorInsetFromAutomaticInsets&#125; API_AVAILABLE(ios(11.0), tvos(11.0)); TableViewçš„separatoré»˜è®¤å·¦è¾¹ä¼šç•™15ï¼Œå¦‚æžœè¦åŽ»æŽ‰è¿™ä¸ªç©ºéš™ï¼Œé¡¶å¤´æ˜¾ç¤ºiOS 11ä¹‹å‰çš„å†™æ³•ï¼š12_tableView.separatorInset = UIEdgeInsetsZero; _tableView.layoutMargins = UIEdgeInsetsZero; iOS 11ä¹‹åŽçš„å†™æ³•ï¼š 12_tableView.separatorInsetReference = UITableViewSeparatorInsetFromCellEdges; _tableView.separatorInset = UIEdgeInsetsZero; æ–°å¢žperformBatchUpdateså‡½æ•° TableViewCellçš„å·¦åˆ’å’Œå³åˆ’æ‰‹åŠ¿åŠŸèƒ½åœ¨UITableViewDelegateä¸­ï¼Œæ–°å¢žäº†ä¸¤ä¸ªdelegate 12345// Swipe actions// These methods supersede -editActionsForRowAtIndexPath: if implemented// return nil to get the default swipe actions- (nullable UISwipeActionsConfiguration *)tableView:(UITableView *)tableView leadingSwipeActionsConfigurationForRowAtIndexPath:(NSIndexPath *)indexPath API_AVAILABLE(ios(11.0)) API_UNAVAILABLE(tvos);- (nullable UISwipeActionsConfiguration *)tableView:(UITableView *)tableView trailingSwipeActionsConfigurationForRowAtIndexPath:(NSIndexPath *)indexPath API_AVAILABLE(ios(11.0)) API_UNAVAILABLE(tvos); æ–°å¢žä»£ç†æ–¹æ³• Spring Loading 123456// Spring Loading// Allows opting-out of spring loading for an particular row.// If you want the interaction effect on a different subview of the spring loaded cell, modify the context.targetView property. The default is the cell.// If this method is not implemented, the default is YES except when the row is part of a drag session.- (BOOL)tableView:(UITableView *)tableView shouldSpringLoadRowAtIndexPath:(NSIndexPath *)indexPath withContext:(id&lt;UISpringLoadedInteractionContext&gt;)context API_AVAILABLE(ios(11.0)) API_UNAVAILABLE(tvos, watchos); æ–°å¢žUITableViewDragDelegate å’Œ UITableViewDropDelegateä»£ç† 3.9 æŽ¨å‡ºäº†SafeArea(UIæ˜¾ç¤ºè¦åœ¨å®‰å…¨åŒºåŸŸå†…)iPhoneæ‰€æœ‰æœºåž‹çš„å°ºå¯¸è¡¨ï¼š iPhone XåŸºæœ¬å±žæ€§ å¯åŠ¨å›¾å°ºå¯¸ï¼š1125px Ã— 2436px(å³ 375pt Ã— 812pt @3x)) iphoneX å±å¹•é«˜ï¼š812.0ä¸ªç‚¹ å¯¼èˆªæ é«˜åº¦+çŠ¶æ€æ é«˜åº¦ï¼š88.0ä¸ªç‚¹(å¯¼èˆªæ é«˜åº¦ä»æ˜¯44ä¸ªç‚¹ï¼ŒçŠ¶æ€æ é«˜åº¦å¢žé«˜ä¸º44ä¸ªç‚¹ï¼Œæ‰€ä»¥åˆ˜æµ·çš„é«˜åº¦å¹¶ä¸æ˜¯çŠ¶æ€æ çš„é«˜åº¦ã€‚çŠ¶æ€æ å’Œå¯¼èˆªæ å¹³åˆ†äº†å¤´éƒ¨æ€»çš„é«˜åº¦ï¼‰ tabbaré«˜åº¦ï¼š83.0ä¸ªç‚¹ï¼ˆåŽŸæ˜¯å›ºå®š49ä¸ªç‚¹ï¼Œå¢žé«˜äº†34ä¸ªç‚¹). é¡¶éƒ¨é€‚é… iOS11automaticallyAdjustsScrollViewInsetså±žæ€§åºŸå¼ƒäº† ç³»ç»Ÿè‡ªå·±è®¡ç®—å†…è¾¹è· ä¼šå‡ºçŽ°ScorllViewä¸‹æ²‰20çš„çŽ°è±¡ å¯ä»¥è°ƒç”¨scrollviewæ–°çš„apicontentInsetAdjustmentBehavior1234self.automaticallyAdjustsScrollViewInsets = NO;if (@available(iOS 11.0, *)) &#123; self.tableView.contentInsetAdjustmentBehavior = UIScrollViewContentInsetAdjustmentNever;&#125; ä½†æ˜¯è¿™ä¹ˆå†™ä¼šå¯¼è‡´åœ¨iPhoneXä¸‹å‡ºçŽ°ï¼Œç”±äºŽåœ¨Xä¸‹å®‰å…¨åŒºåŸŸçš„å‡ºçŽ°ï¼Œé¡¶éƒ¨å¼‚å½¢åŒºåŸŸä¸å»ºè®®è¦†ç›–ï¼Œä¼šé€ æˆè§†è§‰çš„å·®å¼‚ åœ¨ä»£ç ä¸­æˆ‘ä»¬éœ€è¦æ¥æ ¹æ®è®¾å¤‡é«˜åº¦æ¥åˆ¤æ–­iPhoneXï¼Œä»Žè€Œæ¥é¿å…è¿™ç§æƒ…å†µ 1234567891011121314[tableview mas_makeConstraints:^(MASConstraintMaker *make) &#123; make.edges.equalTo(self.view); if (LL_iPhoneX) &#123; if (@available(iOS 11.0, *)) &#123; make.top.equalTo(self.view.mas_safeAreaLayoutGuideTop); &#125; &#125;else&#123; make.top.equalTo(self.view.mas_top).offset(0); &#125; make.left.equalTo(self.view).offset(0); make.right.equalTo(self.view).offset(0); make.bottom.equalTo(self.view).offset(0);&#125;]; ä¸Šé¢ä½¿ç”¨çš„Masonry,å¹¶ä¸”ç‰ˆæœ¬éœ€è¦åœ¨V1.1.0ç‰ˆæœ¬ è‹¹æžœè‡ªå·±çš„çº¦æŸä»£ç å¦‚ä¸‹12345678910111213if (@available(iOS 11.0, *)) &#123; NSLayoutConstraint *top = [contentView.topAnchor constraintEqualToAnchor:self.view.safeAreaLayoutGuide.top Anchor]; NSLayoutConstraint *bottom = [contentView.bottomAnchor constraintEqualToAnchor:self.view.safeAreaLayoutGuide.bottomAnchor]; NSLayoutConstraint *left = [contentView.leftAnchor constraintEqualToAnchor:self.view.safeAreaLayoutGuide.leftAnchor]; NSLayoutConstraint *right = [contentView.rightAnchor constraintEqualToAnchor:self.view.safeAreaLayoutGuide.rightAnchor]; [NSLayoutConstraint activateConstraints:@[top, bottom, left, right]];&#125; else &#123; NSLayoutConstraint *top = [contentView.topAnchor constraintEqualToAnchor:self.topLayoutGuide.bottomAnchor]; NSLayoutConstraint *bottom = [contentView.bottomAnchor constraintEqualToAnchor:self.bottomLayoutGuide.topAnchor]; NSLayoutConstraint *left = [contentView.leftAnchor constraintEqualToAnchor:self.view.leftAnchor]; NSLayoutConstraint *right = [contentView.rightAnchor constraintEqualToAnchor:self.view.rightAnchor]; [NSLayoutConstraint activateConstraints:@[top, bottom, left, right]];&#125; é€‚é…å® 1234567891011121314151617181920212223242526272829303132333435// UIScreen width.#define kScreenWidth [UIScreen mainScreen].bounds.size.width// UIScreen height.#define kScreenHeight [UIScreen mainScreen].bounds.size.height// iPhone X#define Is_iPhoneX (kScreenWidth == 375.f &amp;&amp; kScreenHeight == 812.f ? YES : NO)// Status bar height.#define kStatusBarHeight (Is_iPhoneX ? 44.f : 20.f)// Navigation bar height.#define kNavigationBarHeight 44.f// Tabbar height.#define kTabbarHeight (Is_iPhoneX ? (49.f + 34.f) : 49.f)// Tabbar safe bottom margin.#define kTabbarSafeBottomMargin (Is_iPhoneX ? 34.f : 0.f)// Status bar &amp; navigation bar height.#define kStatusBarAndNavigationBarHeight (Is_iPhoneX ? 88.f : 64.f)#define kViewSafeAreInsets(view) (\ &#123;\ UIEdgeInsets insets;\ if(@available(iOS 11.0, *)) &#123;\ insets = view.safeAreaInsets; \ &#125; else &#123;\ insets = UIEdgeInsetsZero;\ &#125; \ insets;\ &#125;\)]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>iOS9æ–°ç‰¹æ€§</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•°æ®åº“åŸºç¡€]]></title>
    <url>%2F2016%2F08%2F05%2F%E6%95%B0%E6%8D%AE%E5%BA%93%2F</url>
    <content type="text"><![CDATA[æ•°æ®åº“ æ•°æ®åº“åŸºç¡€ æ•°æ®åº“ï¼ˆDatabaseï¼‰æ˜¯æŒ‰ç…§æ•°æ®ç»“æž„æ¥ç»„ç»‡ã€å­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“ã€‚ æ•°æ®åº“çš„å­˜å‚¨ç»“æž„å’Œexcelå¾ˆåƒï¼Œä»¥è¡¨ï¼ˆtableï¼‰ä¸ºå•ä½ SQLite: SQLiteæ˜¯ä¸€æ¬¾è½»åž‹çš„åµŒå…¥å¼æ•°æ®åº“ã€‚ç‰¹ç‚¹ï¼šå ç”¨èµ„æºéžå¸¸çš„ä½Žï¼Œå¤„ç†é€Ÿåº¦å¿«ã€‚ SQLè¯­å¥ SQLï¼ˆstructured query languageï¼‰ï¼šç»“æž„åŒ–æŸ¥è¯¢è¯­è¨€ã€‚æ˜¯ä¸€ç§å¯¹å…³ç³»åž‹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œå®šä¹‰å’Œæ“ä½œçš„è¯­è¨€ã€‚ åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¦æƒ³æ“ä½œï¼ˆå¢žåˆ æ”¹æŸ¥ï¼ŒCRUDï¼‰æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¿…é¡»ä½¿ç”¨SQLè¯­å¥ã€‚ ç‰¹ç‚¹ï¼š ä¸åŒºåˆ†å¤§å°å†™ã€‚ æ¯æ¡è¯­å¥éƒ½å¿…é¡»ä»¥åˆ†å· ; ç»“å°¾ã€‚ æ•°æ®åº“ä¸­ä¸å¯ä»¥ä½¿ç”¨å…³é”®å­—æ¥å‘½åè¡¨ã€å­—æ®µ SQLä¸­çš„å¸¸ç”¨å…³é”®å­—æœ‰ï¼šselectã€insertã€updateã€deleteã€fromã€createã€whereã€descã€orderã€byã€groupã€tableã€alterã€viewã€indexã€havingç­‰ç­‰ã€‚ SQLè¯­å¥çš„ç§ç±» ï¼š æ•°æ®å®šä¹‰è¯­å¥ï¼ˆDDLï¼šData Definition Languageï¼‰ï¼šåŒ…æ‹¬createå’Œdropç­‰æ“ä½œï¼Œåœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°è¡¨æˆ–åˆ é™¤è¡¨ï¼ˆcreate tableæˆ– drop tableï¼‰ æ•°æ®æ“ä½œè¯­å¥ï¼ˆDMLï¼šData Manipulation Languageï¼‰ã€‚åŒ…æ‹¬insertã€updateã€deleteç­‰æ“ä½œã€‚ æ•°æ®æŸ¥è¯¢è¯­å¥ï¼ˆDQLï¼šData Query Languageï¼‰ï¼ŒDQLå¸¸ç”¨çš„å…³é”®å­—æœ‰selectï¼Œwhereï¼Œorder byï¼Œgroup byå’Œhavingã€‚ DDL create table if not exists è¡¨å (å­—æ®µå1 å­—æ®µç±»åž‹1, å­—æ®µå2 å­—æ®µç±»åž‹2, â€¦) ; ç¤ºä¾‹ ï¼š 1create table t_student (id integer, name text, age integer, score real) ; å­—æ®µç±»åž‹ : integer ã€real ã€textã€blobæ³¨æ„ï¼šå®žé™…ä¸ŠSQLiteæ˜¯æ— ç±»åž‹çš„ï¼šå°±ç®—å£°æ˜Žä¸ºintegerç±»åž‹ï¼Œè¿˜æ˜¯èƒ½å­˜å‚¨å­—ç¬¦ä¸²æ–‡æœ¬ï¼ˆä¸»é”®é™¤å¤–ï¼‰ã€‚ 1create table t_student(name, age); åˆ é™¤è¡¨ ï¼šdrop table if exists è¡¨å ; DML insert into è¡¨å (å­—æ®µ1, å­—æ®µ2, â€¦) values (å­—æ®µ1çš„å€¼, å­—æ®µ2çš„å€¼, â€¦) ; æ•°æ®åº“ä¸­çš„å­—ç¬¦ä¸²å†…å®¹åº”è¯¥ç”¨å•å¼•å·æ‹¬ä½ 1insert into t_student (name, age) values (â€˜QLâ€™, 10) ; update è¡¨å set å­—æ®µ1 = å­—æ®µ1çš„å€¼, å­—æ®µ2 = å­—æ®µ2çš„å€¼, â€¦ delete from è¡¨å DQL æ ¼å¼:select å­—æ®µ1, å­—æ®µ2, â€¦ from è¡¨å ; èµ·åˆ«å:æ ¼å¼(å­—æ®µå’Œè¡¨éƒ½å¯ä»¥èµ·åˆ«å) select å­—æ®µ1 åˆ«å , å­—æ®µ2 åˆ«å , â€¦ from è¡¨å åˆ«å ; select å­—æ®µ1 åˆ«å, å­—æ®µ2 as åˆ«å, â€¦ from è¡¨å as åˆ«å ; select åˆ«å.å­—æ®µ1, åˆ«å.å­—æ®µ2, â€¦ from è¡¨å åˆ«å ;ç¤ºä¾‹ï¼š 1select s.name, s.age from t_students as &#123;[s ; è®¡ç®—è®°å½•çš„æ•°é‡ 123select count (å­—æ®µ) from è¡¨å ;select count ( * ) from è¡¨å ;sqlString = [NSString stringWithFormat:@"select max(t1.id),sum (t1.readStatus) as count,t1.readStatus,t1.userid,t2.headerImage,t1.message,t1.createTime,t2.name,t2.gender,t2.status from %@ as t1,%@ as t2 where t1.userid = t2.userid and t1.userid != %@ group by t1.userid order by t1.id desc",self.chatList,self.userList,@"10086"]; limitä½¿ç”¨limitå¯ä»¥ç²¾ç¡®åœ°æŽ§åˆ¶æŸ¥è¯¢ç»“æžœçš„æ•°é‡ï¼Œæ¯”å¦‚æ¯æ¬¡åªæŸ¥è¯¢10æ¡æ•°æ® 1select * from t_student limit 4, 8 ; å¯ä»¥ç†è§£ä¸ºï¼šè·³è¿‡æœ€å‰é¢4æ¡è¯­å¥ï¼Œç„¶åŽå–8æ¡è®°å½• limitå¸¸ç”¨æ¥åšåˆ†é¡µæŸ¥è¯¢ï¼Œæ¯”å¦‚æ¯é¡µå›ºå®šæ˜¾ç¤º5æ¡æ•°æ®ï¼Œé‚£ä¹ˆåº”è¯¥è¿™æ ·å–æ•°æ®ç¬¬1é¡µï¼šlimit 0, 5ç¬¬2é¡µï¼šlimit 5, 5ç¬¬3é¡µï¼šlimit 10, 5â€¦ç¬¬né¡µï¼šlimit 5*(n-1), 5å¯åšæœ¬åœ°èŠå¤©è®°å½•æ¯æ¬¡åˆ·æ–°çš„åŠ è½½ çº¦æŸå¯¹å­—æ®µå¸¸è§çš„çº¦æŸï¼šnot null ã€unique ã€default ï¼ˆå»ºè®®ï¼šå°½é‡ç»™å­—æ®µè®¾å®šä¸¥æ ¼çš„çº¦æŸï¼Œä»¥ä¿è¯æ•°æ®çš„è§„èŒƒæ€§ï¼‰ç¤ºä¾‹ï¼š 1create table t_student (id integer, name text not null unique, age integer not null default 1) ; nameå­—æ®µä¸èƒ½ä¸ºnullï¼Œå¹¶ä¸”å”¯ä¸€,ageå­—æ®µä¸èƒ½ä¸ºnullï¼Œå¹¶ä¸”é»˜è®¤ä¸º1 ä¸»é”®çº¦æŸ ä¸»é”®ï¼ˆPrimary Keyï¼Œç®€ç§°PKï¼‰ç”¨æ¥å”¯ä¸€åœ°æ ‡è¯†æŸä¸€æ¡è®°å½• ä¾‹å¦‚t_studentå¯ä»¥å¢žåŠ ä¸€ä¸ªidå­—æ®µä½œä¸ºä¸»é”®ï¼Œç›¸å½“äºŽäººçš„èº«ä»½è¯ ä¸»é”®å¯ä»¥æ˜¯ä¸€ä¸ªå­—æ®µæˆ–å¤šä¸ªå­—æ®µ æ¯å¼ è¡¨éƒ½å¿…é¡»æœ‰ä¸€ä¸ªä¸»é”®ï¼Œç”¨æ¥æ ‡è¯†è®°å½•çš„å”¯ä¸€æ€§ ä¸»é”®å­—æ®µé»˜è®¤å°±åŒ…å«äº†not null å’Œ unique ä¸¤ä¸ªçº¦æŸ è®¾è®¡åŽŸåˆ™: ä¸»é”®åº”å½“æ˜¯å¯¹ç”¨æˆ·æ²¡æœ‰æ„ä¹‰çš„ æ°¸è¿œä¹Ÿä¸è¦æ›´æ–°ä¸»é”® ä¸»é”®ä¸åº”åŒ…å«åŠ¨æ€å˜åŒ–çš„æ•°æ® ä¸»é”®åº”å½“ç”±è®¡ç®—æœºè‡ªåŠ¨ç”Ÿæˆ å¤–é”®çº¦æŸå¤–é”®çš„ä¸€èˆ¬æƒ…å†µæ˜¯ï¼šä¸€å¼ è¡¨çš„æŸä¸ªå­—æ®µï¼Œå¼•ç”¨ç€å¦ä¸€å¼ è¡¨çš„ä¸»é”®å­—æ®µ 1create table t_student (id integer primary key autoincrement, name text, age integer, class_id integer, constraint fk_t_student_class_id_t_class_id foreign key (class_id) (id)) ; references t_class t_studentè¡¨ä¸­æœ‰ä¸€ä¸ªå«åšfk_t_student_class_id_t_class_idçš„å¤–é”®è¿™ä¸ªå¤–é”®çš„ä½œç”¨æ˜¯ç”¨t_studentè¡¨ä¸­çš„class_idå­—æ®µå¼•ç”¨t_classè¡¨çš„idå­—æ®µ è¡¨è¿žæŽ¥æŸ¥è¯¢ å†…è¿žæŽ¥ï¼šinner join æˆ–è€… join ï¼ˆæ˜¾ç¤ºçš„æ˜¯å·¦å³è¡¨éƒ½æœ‰å®Œæ•´å­—æ®µå€¼çš„è®°å½•ï¼‰ å·¦å¤–è¿žæŽ¥ï¼šleft outer join ï¼ˆä¿è¯å·¦è¡¨æ•°æ®çš„å®Œæ•´æ€§ï¼‰ æŸ¥è¯¢0316iOSç­çš„æ‰€æœ‰å­¦ç”Ÿ 1select s.name from t_student s, t_class c where s.class_id = c.id and c.name = â€˜0316iOSâ€™; SQLiteç¼–ç åœ¨iOSä¸­ä½¿ç”¨SQLite3ï¼Œé¦–å…ˆè¦æ·»åŠ åº“æ–‡ä»¶libsqlite3.dylibå’Œå¯¼å…¥ä¸»å¤´æ–‡ä»¶ åˆ›å»ºã€æ‰“å¼€ã€å…³é—­æ•°æ®åº“12sqlite3 *db = NULL;int result = sqlite3_open([path UTF8String], &amp;db); sqlite3_open()å°†æ ¹æ®æ–‡ä»¶è·¯å¾„æ‰“å¼€æ•°æ®åº“ï¼Œå¦‚æžœä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ã€‚å¦‚æžœresultç­‰äºŽå¸¸é‡SQLITE_OKï¼Œåˆ™è¡¨ç¤ºæˆåŠŸæ‰“å¼€æ•°æ®åº“ sqlite3 *dbï¼šä¸€ä¸ªæ‰“å¼€çš„æ•°æ®åº“å®žä¾‹ æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„å¿…é¡»ä»¥Cå­—ç¬¦ä¸²(è€ŒéžNSString)ä¼ å…¥ å…³é—­æ•°æ®åº“ï¼šsqlite3_close(db); æ‰§è¡Œä¸è¿”å›žæ•°æ®çš„SQLè¯­å¥1234567891011char *errorMsg = NULL; // ç”¨æ¥å­˜å‚¨é”™è¯¯ä¿¡æ¯char *sql = &quot;create table if not exists t_person(id integer primary key autoincrement, name text, age integer);&quot;;int result = sqlite3_exec(db, sql, NULL, NULL, &amp;errorMsg);int sqlite3_exec( sqlite3*, // ä¸€ä¸ªæ‰“å¼€çš„æ•°æ®åº“å®žä¾‹ const char *sql, // éœ€è¦æ‰§è¡Œçš„SQLè¯­å¥ int (*callback)(void*,int,char**,char**), // SQLè¯­å¥æ‰§è¡Œå®Œæ¯•åŽçš„å›žè°ƒ void *, // å›žè°ƒå‡½æ•°çš„ç¬¬1ä¸ªå‚æ•° char **errmsg // é”™è¯¯ä¿¡æ¯); sqlite3_exec()å¯ä»¥æ‰§è¡Œä»»ä½•SQLè¯­å¥ï¼Œæ¯”å¦‚åˆ›è¡¨ã€æ›´æ–°ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚ä½†æ˜¯ä¸€èˆ¬ä¸ç”¨å®ƒæ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œå› ä¸ºå®ƒä¸ä¼šè¿”å›žæŸ¥è¯¢åˆ°çš„æ•°æ® å¸¦å ä½ç¬¦æ’å…¥æ•°æ®12345678910char *sql = &quot;insert into t_person(name, age) values(?, ?);&quot;;sqlite3_stmt *stmt;if (sqlite3_prepare_v2(db, sql, -1, &amp;stmt, NULL) == SQLITE_OK) &#123; sqlite3_bind_text(stmt, 1, &quot;æ¯é¸¡&quot;, -1, NULL); sqlite3_bind_int(stmt, 2, 27);&#125;if (sqlite3_step(stmt) != SQLITE_DONE) &#123; NSLog(@&quot;æ’å…¥æ•°æ®é”™è¯¯&quot;);&#125;sqlite3_finalize(stmt); sqlite3_prepare_v2()è¿”å›žå€¼ç­‰äºŽSQLITE_OKï¼Œè¯´æ˜ŽSQLè¯­å¥å·²ç»å‡†å¤‡æˆåŠŸï¼Œæ²¡æœ‰è¯­æ³•é—®é¢˜ sqlite3_bind_text()ï¼šå¤§éƒ¨åˆ†ç»‘å®šå‡½æ•°éƒ½åªæœ‰3ä¸ªå‚æ•°: ç¬¬1ä¸ªå‚æ•°æ˜¯sqlite3_stmt *ç±»åž‹,å­˜æ”¾ç»“æžœé›† ç¬¬2ä¸ªå‚æ•°æŒ‡å ä½ç¬¦çš„ä½ç½®ï¼Œç¬¬ä¸€ä¸ªå ä½ç¬¦çš„ä½ç½®æ˜¯1ï¼Œä¸æ˜¯0 ç¬¬3ä¸ªå‚æ•°æŒ‡å ä½ç¬¦è¦ç»‘å®šçš„å€¼ ç¬¬4ä¸ªå‚æ•°æŒ‡åœ¨ç¬¬3ä¸ªå‚æ•°ä¸­æ‰€ä¼ é€’æ•°æ®çš„é•¿åº¦ï¼Œå¯¹äºŽCå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä¼ é€’-1ä»£æ›¿å­—ç¬¦ä¸²çš„é•¿åº¦ ç¬¬5ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰çš„å‡½æ•°å›žè°ƒï¼Œä¸€èˆ¬ç”¨äºŽåœ¨è¯­å¥æ‰§è¡ŒåŽå®Œæˆå†…å­˜æ¸…ç†å·¥ä½œ sqlite_step()ï¼šæ‰§è¡ŒSQLè¯­å¥ï¼Œè¿”å›žSQLITE_DONEä»£è¡¨æˆåŠŸæ‰§è¡Œå®Œæ¯• sqlite_finalize()ï¼šé”€æ¯sqlite3_stmt *å¯¹è±¡ æŸ¥è¯¢æ•°æ®123456789101112char *sql = &quot;select id,name,age from t_person;&quot;;sqlite3_stmt *stmt;if (sqlite3_prepare_v2(db, sql, -1, &amp;stmt, NULL) == SQLITE_OK) &#123; while (sqlite3_step(stmt) == SQLITE_ROW) &#123; int _id = sqlite3_column_int(stmt, 0); char *_name = (char *)sqlite3_column_text(stmt, 1); NSString *name = [NSString stringWithUTF8String:_name]; int _age = sqlite3_column_int(stmt, 2); NSLog(@&quot;id=%i, name=%@, age=%i&quot;, _id, name, _age); &#125;&#125;sqlite3_finalize(stmt); sqlite3_step()è¿”å›žSQLITE_ROWä»£è¡¨éåŽ†åˆ°ä¸€æ¡æ–°è®°å½• sqlite3_column_*()ç”¨äºŽèŽ·å–æ¯ä¸ªå­—æ®µå¯¹åº”çš„å€¼ï¼Œç¬¬2ä¸ªå‚æ•°æ˜¯å­—æ®µçš„ç´¢å¼•ï¼Œä»Ž0å¼€å§‹ è¿”å›žSQLITE_BUSYä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š1ã€‚å½“æœ‰å†™æ“ä½œæ—¶ï¼Œå…¶ä»–è¯»æ“ä½œä¼šè¢«é©³å›ž2ã€‚å½“æœ‰å†™æ“ä½œæ—¶ï¼Œå…¶ä»–å†™æ“ä½œä¼šè¢«é©³å›ž3ã€‚å½“å¼€å¯äº‹åŠ¡æ—¶ï¼Œåœ¨æäº¤äº‹åŠ¡ä¹‹å‰ï¼Œå…¶ä»–å†™æ“ä½œä¼šè¢«é©³å›ž4ã€‚å½“å¼€å¯äº‹åŠ¡æ—¶ï¼Œåœ¨æäº¤äº‹åŠ¡ä¹‹å‰ï¼Œå…¶ä»–äº‹åŠ¡è¯·æ±‚ä¼šè¢«é©³å›ž5ã€‚å½“æœ‰è¯»æ“ä½œæ—¶ï¼Œå…¶ä»–å†™æ“ä½œä¼šè¢«é©³å›ž6ã€‚è¯»æ“ä½œä¹‹é—´èƒ½å¤Ÿå¹¶å‘æ‰§è¡Œ 1234567891011121314151617181920212223242526272829303132@try&#123; char *errorMsg; if (sqlite3_exec(_database, &quot;BEGIN&quot;, NULL, NULL, &amp;errorMsg)==SQLITE_OK) &#123; NSLog(@â€å¯åŠ¨äº‹åŠ¡æˆåŠŸâ€); sqlite3_free(errorMsg); sqlite3_stmt *statement; if (sqlite3_prepare_v2(_database, [@&quot;insert into persons(name) values(?);&quot; UTF8String], -1, &amp;statement, NULL)==SQLITE_OK) &#123; //ç»‘å®šå‚æ•° const char *text=[@â€å¼ ä¸‰â€ cStringUsingEncoding:NSUTF8StringEncoding]; sqlite3_bind_text(statement, index, text, strlen(text), SQLITE_STATIC); if (sqlite3_step(statement)!=SQLITE_DONE) &#123; sqlite3_finalize(statement); &#125; &#125; if (sqlite3_exec(_database, &quot;COMMIT&quot;, NULL, NULL, &amp;errorMsg)==SQLITE_OK) &#123; NSLog(@â€æäº¤äº‹åŠ¡æˆåŠŸâ€); &#125; sqlite3_free(errorMsg); &#125; else&#123; sqlite3_free(errorMsg); &#125; &#125; @catch(NSException *e)&#123; char *errorMsg; if (sqlite3_exec(_database, &quot;ROLLBACK&quot;, NULL, NULL, &amp;errorMsg)==SQLITE_OK) &#123; NSLog(@â€å›žæ»šäº‹åŠ¡æˆåŠŸâ€); &#125; sqlite3_free(errorMsg); &#125; @finally&#123; &#125;]]></content>
      <categories>
        <category>Objective-C</category>
      </categories>
      <tags>
        <tag>SQLite3</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
</search>
